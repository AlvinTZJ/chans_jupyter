<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://goodboychan.github.io/chans_jupyter/feed.xml" rel="self" type="application/atom+xml" /><link href="https://goodboychan.github.io/chans_jupyter/" rel="alternate" type="text/html" /><updated>2020-08-12T00:01:29-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/feed.xml</id><title type="html">Chan`s Jupyter</title><subtitle>An easy to use blogging platform with support for Jupyter Notebooks.</subtitle><entry><title type="html">Dive into the Competition</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/02-Dive-into-the-Competition.html" rel="alternate" type="text/html" title="Dive into the Competition" /><published>2020-08-12T00:00:00-05:00</published><updated>2020-08-12T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/02-Dive-into-the-Competition</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/02-Dive-into-the-Competition.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-12-02-Dive-into-the-Competition.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ggplot&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;figure.figsize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Understand-the-problem&quot;&gt;Understand the problem&lt;a class=&quot;anchor-link&quot; href=&quot;#Understand-the-problem&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Solution workflow
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/solution_workflow.png&quot; alt=&quot;sw&quot; /&gt;&lt;/li&gt;
&lt;li&gt;Custom Metric (Root Mean Squared Error in a Logarithmic scale)

$$ RMSLE = \sqrt{\frac{1}{N}\sum_{i=1}^N (\log(y_i + 1) - \log(\hat{y_i} + 1))^2} $$
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Define-a-competition-metric&quot;&gt;Define a competition metric&lt;a class=&quot;anchor-link&quot; href=&quot;#Define-a-competition-metric&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Competition metric is used by Kaggle to evaluate your submissions. Moreover, you also need to measure the performance of different models on a local validation set.&lt;/p&gt;
&lt;p&gt;For now, your goal is to manually develop a couple of competition metrics in case if they are not available in &lt;code&gt;sklearn.metrics&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In particular, you will define:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mean Squared Error (MSE) for the regression problem:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
$$ MSE = \frac{1}{N} \sum_{i=1}^{N}(y_i - \hat{y_i})^2 $$
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Logarithmic Loss (LogLoss) for the binary classification problem:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
$$ LogLoss = -\frac{1}{N} \sum_{i = 1}^N (y_i \ln p_i + (1 - y_i) \ln (1 - p_i)) $$
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/sample_reg_true_pred.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_regression_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_regression_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;true&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;pred&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mean_squared_error&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define your own MSE function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;own_mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Raise differences to the power of 2&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;squares&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Find mean over all observations&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squares&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Sklearn MSE: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.5f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;. &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean_squared_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_regression_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_regression_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Your MSE: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.5f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;. &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;own_mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_regression_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_regression_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Sklearn MSE: 0.15418. 
Your MSE: 0.15418. 
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample_class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/sample_class_true_pred.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_classification_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_classification_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;true&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;pred&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log_loss&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define your own LogLoss function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;own_logloss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Find loss for each observation&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;terms&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prob_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Find mean over all observations&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;err&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Sklearn LogLoss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.5f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_classification_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_classification_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Your LogLoss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.5f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;own_logloss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_classification_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_classification_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Sklearn LogLoss: 1.10801
Your LogLoss: 1.10801
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Initial-EDA&quot;&gt;Initial EDA&lt;a class=&quot;anchor-link&quot; href=&quot;#Initial-EDA&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Goal of EDA&lt;ul&gt;
&lt;li&gt;Size of the data&lt;/li&gt;
&lt;li&gt;Properties of the target variable&lt;/li&gt;
&lt;li&gt;Properties of the features&lt;/li&gt;
&lt;li&gt;Generate ideas for feature engineering&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;EDA-statistics&quot;&gt;EDA statistics&lt;a class=&quot;anchor-link&quot; href=&quot;#EDA-statistics&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;As mentioned in the slides, you'll work with New York City taxi fare prediction data. You'll start with finding some basic statistics about the data. Then you'll move forward to plot some dependencies and generate hypotheses on them.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/taxi_train_chapter_4.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/taxi_test_chapter_4.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Shapes of train and test data&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Train shape:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Test shape:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# train head()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Train shape: (20000, 8)
Test shape: (9914, 7)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;id&lt;/th&gt;
      &lt;th&gt;fare_amount&lt;/th&gt;
      &lt;th&gt;pickup_datetime&lt;/th&gt;
      &lt;th&gt;pickup_longitude&lt;/th&gt;
      &lt;th&gt;pickup_latitude&lt;/th&gt;
      &lt;th&gt;dropoff_longitude&lt;/th&gt;
      &lt;th&gt;dropoff_latitude&lt;/th&gt;
      &lt;th&gt;passenger_count&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;4.5&lt;/td&gt;
      &lt;td&gt;2009-06-15 17:26:21 UTC&lt;/td&gt;
      &lt;td&gt;-73.844311&lt;/td&gt;
      &lt;td&gt;40.721319&lt;/td&gt;
      &lt;td&gt;-73.841610&lt;/td&gt;
      &lt;td&gt;40.712278&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;16.9&lt;/td&gt;
      &lt;td&gt;2010-01-05 16:52:16 UTC&lt;/td&gt;
      &lt;td&gt;-74.016048&lt;/td&gt;
      &lt;td&gt;40.711303&lt;/td&gt;
      &lt;td&gt;-73.979268&lt;/td&gt;
      &lt;td&gt;40.782004&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;5.7&lt;/td&gt;
      &lt;td&gt;2011-08-18 00:35:00 UTC&lt;/td&gt;
      &lt;td&gt;-73.982738&lt;/td&gt;
      &lt;td&gt;40.761270&lt;/td&gt;
      &lt;td&gt;-73.991242&lt;/td&gt;
      &lt;td&gt;40.750562&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;7.7&lt;/td&gt;
      &lt;td&gt;2012-04-21 04:30:42 UTC&lt;/td&gt;
      &lt;td&gt;-73.987130&lt;/td&gt;
      &lt;td&gt;40.733143&lt;/td&gt;
      &lt;td&gt;-73.991567&lt;/td&gt;
      &lt;td&gt;40.758092&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5.3&lt;/td&gt;
      &lt;td&gt;2010-03-09 07:51:00 UTC&lt;/td&gt;
      &lt;td&gt;-73.968095&lt;/td&gt;
      &lt;td&gt;40.768008&lt;/td&gt;
      &lt;td&gt;-73.956655&lt;/td&gt;
      &lt;td&gt;40.783762&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Describe the target variable&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fare_amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;count    20000.000000
mean        11.303321
std          9.541637
min         -3.000000
25%          6.000000
50%          8.500000
75%         12.500000
max        180.000000
Name: fare_amount, dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Train distribution of passengers within rides&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passenger_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value_counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;1    13999
2     2912
5     1327
3      860
4      420
6      407
0       75
Name: passenger_count, dtype: int64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;EDA-plots-I&quot;&gt;EDA plots I&lt;a class=&quot;anchor-link&quot; href=&quot;#EDA-plots-I&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;After generating a couple of basic statistics, it's time to come up with and validate some ideas about the data dependencies. Again, the train DataFrame from the taxi competition is already available in your workspace.&lt;/p&gt;
&lt;p&gt;To begin with, let's make a scatterplot plotting the relationship between the fare amount and the distance of the ride. Intuitively, the longer the ride, the higher its price.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;haversine_distance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lat1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;long1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lat2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;long2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;pickup_latitude&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;pickup_longitude&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dropoff_latitude&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dropoff_longitude&amp;#39;&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6371&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#radius of earth in kilometers&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#R = 3959 #radius of earth in miles&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;phi1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;radians&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lat1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;phi2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;radians&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lat2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
        &lt;span class=&quot;n&quot;&gt;delta_phi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;radians&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lat2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lat1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;delta_lambda&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;radians&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
        &lt;span class=&quot;c1&quot;&gt;#a = sin²((φB - φA)/2) + cos φA . cos φB . sin²((λB - λA)/2)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delta_phi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phi1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phi2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delta_lambda&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    
        &lt;span class=&quot;c1&quot;&gt;#c = 2 * atan2( √a, √(1−a) )&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arctan2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
        &lt;span class=&quot;c1&quot;&gt;#d = R*c&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#in kilometers&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Calculate the ride distance&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;distance_km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haversine_distance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Draw a scatterplot&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fare_amount&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;distance_km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fare amount&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Distance, km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fare amount based on the distance&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Limit on the distance&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmEAAAH0CAYAAAB1tvomAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nOzdeXhU9b0/8Pc5M5ksk8lGQoCEJexLjVQiOyIaEKRWobVVgaL+rvdqKT6Vp71uLViV1g3BheIVtVrtRe1TLmq1iIiyKEqC2khAIMhOyE6WyTrnfH9/fGcmmWRmmEBmzkzyfj0PT8iZ7TvnJMyb7/L5KkIIASIiIiIKKdXoBhARERH1RAxhRERERAZgCCMiIiIyAEMYERERkQEYwoiIiIgMwBBGREREZACGMCIKGwsXLsTs2bONboZXRUVFUBQFX3zxhdFNcfvd736HkSNHhuz12l+fcL5eRJGAIYyojVtvvRWKonT48+abbxrdtIg2aNAgPProo0Y3I2IdO3YMiqJg165dRjfFw9q1a7Fhw4aA768oCt54440gtogospiNbgBRuJk2bRrefvttj2NJSUkX/HzNzc2wWCwX2yyisJOYmGh0E4giGnvCiNqxWCzo06ePx5+YmBgAQF5eHq655hqkpaXBZrNh/Pjx2LJli8fjMzMzsWLFCtx5553o1asXpk+fDgCora3F0qVL0a9fP8TFxWHcuHF45513/LblyJEjmDdvHvr27Yu4uDhkZ2fjf//3fz3uM3XqVPzXf/0XHnjgAaSlpSEpKQnLly+HrutYsWIF0tPT0bt3byxfvtzjcdXV1bjjjjuQlpaGmJgYjB8/Hh9//LH7dl/Db217tRwOBxRFwQsvvIAFCxYgPj4e/fv3x6pVqzzad/z4cfz+97939yyeOnXK7/t+8skn3efpxhtvRGVlpfu2QK7Bxo0bMXbsWMTFxSEpKQkTJ05EQUGB+/ZDhw5h3rx5SEpKQnJyMq655hoUFhZ6PMeGDRswZMgQxMTEYMqUKdi3b5/fNgOAEAKPP/44srKyYLFYMGTIEDz33HMe98nMzMTDDz+MpUuXIjk5Genp6fjv//5v6Lru9TkdDgeysrIAyP8gKIqCoUOHdni/I0aMQHx8PK666iocPXrU4/a8vDzMnDkT8fHx6N27N37605/i5MmTft9LRUUFbrzxRlitVqSnp2PFihUd7tN+OPLbb7/FzJkzkZSUBKvVilGjRrl/XjMzMwEAixYtgqIoMJtlH0BlZSUWLFiA/v37IzY2FiNHjsSaNWvQdjMX1+u88MILGDhwIBITEzFv3jyUl5d7tGfLli2YOnWq+7pfeeWVHufib3/7Gy699FLExMQgKysLv/nNb1BfX+/3PBAFlSAit8WLF4urr77a5+0ff/yxeO2110RhYaE4ePCguO+++4TFYhGHDx923ycjI0PYbDbx8MMPi4MHD4r9+/cLXdfFtGnTxIwZM8SuXbvEkSNHxLp160RUVJT49NNPfb7eN998I/785z+Lf//736KoqEisXr1aqKoqtm/f7r7PlClTREJCgrj//vvFwYMHxYsvvigAiDlz5oj77rtPHDx4ULz88ssCgNiyZYv7cTfccIPIysoSH374odi/f79YsmSJsFgs4tChQ0IIIQ4fPiwAiN27d3u0aeDAgeKRRx4RQgjR0tIiAIg+ffqIl156SRw+fFisWrVKABA7duwQQghRUVEhMjMzxb333iuKi4tFcXGx0DTN6/tdsGCBsNls4oYbbhAFBQVi27ZtYvDgwWLevHkBX4NTp04Js9ksVq1aJb7//nuxf/9+8cYbb4h9+/YJIYQ4c+aMSEtLE0uWLBEFBQXiwIED4s477xSpqamivLxcCCHEnj17hKIo4sEHHxTfffed+Pvf/y4GDBjg9Xy0tWbNGhEbGyvWr18vDh06JNauXSssFot49dVXPX4+kpKSxBNPPCEOHTok/va3vwmTyST++te/+nzePXv2CADinXfeEcXFxaKsrEwIIcSDDz4orFarmD17tti7d6/46quvRHZ2trjqqqvcjy0oKBBxcXHiD3/4gzhw4ID497//LebPny9GjBghmpqafL7mj370IzFs2DCxbds28e2334qbbrpJ2Gw2cc0113hcr7bfjxo1SixcuFDs379fHDlyRLz//vvi/fffF0IIUVpaKgCI559/XhQXF4uzZ8+6r9fjjz8u9u7dK77//nvx17/+VcTGxnqcjwULFojExESxYMECsW/fPrFz506RmZkpbr/9dvd9Nm/eLFRVFffcc4/45ptvxP79+8WLL77o/nlev369SElJEa+//ro4cuSI+PTTT8WYMWPErbfe6vMcEAUbQxhRG4sXLxYmk0lYrVb3n8GDB/t9zOjRo8Vjjz3m/j4jI0PMmjXL4z4fffSRiImJETU1NR7HFy1aJH7yk590qo3XXnutuPPOO93fT5kyRYwbN87jPsOHDxdjx47t0M57771XCCHEd999JwCIDz/80H27rusiOztb3HHHHUKIzoWwe+65x+M+Q4YMEb/73e+8PsYfVwhre57ef/99AUB8//33Ph/X9hq4AsvJkye93vfBBx8UU6ZM8Tim67oYOHCgeO6554QQQvz85z8XV1xxhcd9Vq9efd4Q1qdPH3H//fd7HPvVr34lhg0b5v4+IyPDI1QKIcTVV18tFi5c6PN5jx49KgCInTt3dngvZrPZHR6FEOL1118XqqqK5uZmIYQ8pwsWLPB4XH19vbBYLOK9997z+noHDhwQAMS2bdvcxxoaGkR6errfEBYXFydef/11n+8DgN/bXX75y1+K2bNne7xOenq6R2h85JFHRGZmpvv7iRMniuuvv97nc2ZkZIj169d7HPv444+Foigdfi+JQoXDkUTtTJgwAd988437T9shutLSUtx1110YMWIEkpKSEB8fj++++w7Hjx/3eI7x48d7fJ+Xl4empib07dsX8fHx7j9vvvkmDh8+7LMtdrsd9957L8aMGYOUlBTEx8djy5YtHV7v0ksv9fi+T58+yM7O7nCstLQUANxDb9OmTXPfrigKpk2b1mFYLhBjx471+D4jIwMlJSWdfh4A+MEPfgCbzeb+fsqUKQCAAwcOADj/NfjhD3+I3NxcjBo1CvPnz8ezzz7rMfyZl5eHL7/80uM62Gw2nDx50n0t9u/fj8mTJ3u0a+rUqX7bXVVVhbNnz+KKK67wOD59+nQcOXIETU1N7mNdeb769++PXr16eTyXrusoKysDIN/v3//+d4/3m5aWhpaWFp8/e/v374eiKJg0aZL7WExMDHJycvy25be//S1uu+02zJgxA3/4wx/wzTffnLf9mqbhj3/8Iy699FKkpqYiPj4e69ev7/AzPnr0aI+5le3P2VdffYVZs2Z5fY3i4mKcPn0ad999t8d5uO666yCEQFFR0XnbSRQMnJhP1E5sbGyHOTcuixYtwtmzZ/Hkk08iKysLsbGx+OlPf4rm5maP+1mtVo/vdV1Hr169sHv37g7P6W/S/rJly/Cvf/0Lq1atwvDhw2G1WvHrX/8ajY2NHveLiory+F5RFK/H2s47UhSlw+sJIdzHVVV1H2urpaXlvO+h/Wt1pfNdA7PZjC1btmDPnj3YunUr3n77bdx7773YuHEj5syZA13Xcc0112DNmjUdnts10bzteQiU6zy1f1z78wd07fny9lwA3M+n6zpuvfVW/Pa3v+3w2NTUVK/P6a3NgXjooYewaNEibN68Gdu2bcPKlSvxwAMP4KGHHvL5mCeeeAJPPPEEVq9ejbFjx8Jms+HJJ5/0+M8PcP5z5u+aue73/PPPdwjJgAyyREZgCCPqhB07duDZZ5/Fj3/8YwBysv2xY8fO20OQk5OD8vJyOByOTtV12rFjBxYtWoQbb7wRgOw1OHToEAYMGHDhbwLAmDFjIITAzp073b0HQgjs2rULEydOBAD07t0bAHDmzBn3486ePYvi4uJOv57FYoGmaQHdt7CwEHV1dYiPjwcAfP755wDgPm+BXANFUTBhwgRMmDABDz74IHJzc/Hqq69izpw5yMnJwYYNG9C/f39ER0d7bcOYMWPw2WefeRxr/317KSkp6NOnD7Zv345rrrnGfXzHjh0YOnSoz9cKhCuABHoO28rJyUFBQQGGDBkScLB0/Xzs3r0bM2bMAAA0NTVh7969HXpd2xsyZAiWLFmCJUuW4NFHH8Vzzz3nDmFRUVEd3sOOHTswd+5c3Hbbbe5j/nqHfRk3bhw+/PBD3HXXXR1u69evH/r27YtDhw7h9ttv7/RzEwULhyOJOmHEiBF44403sG/fPnz99de46aabAurBmDVrFq688kpcf/312LRpE44ePYq9e/fi2WefxSuvvOL39TZt2oS8vDwUFhbiP/7jPy542Kr9886bNw933nknPvroIxw4cABLly7Fd999h9/85jcAgPj4eEyYMAGPP/44CgoKkJ+fj1/84hfulaKdkZWVhV27duHkyZMoLy/3e86EEFi8eDH27duHTz/9FEuXLsX111+PwYMHu9vu7xrs3LkTK1euxJ49e3DixAl89NFH2LdvH0aPHg0AuPvuu9HY2IgbbrgBu3btwrFjx7Br1y488MAD+PLLLwEA99xzD3bu3Inly5fj0KFD+Mc//uG156y9+++/H2vWrMHLL7+Mw4cPY926dXjxxRfxwAMPdPqctZWeno64uDhs2bIFJSUlqKqqCvixDz74IL799lssXrwYeXl5OHr0KLZt24alS5d2GPJzGTlyJK699lrcdddd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kt9++y0yMjIwZswYfPHFFwCATz/9FDk5OaFoDlFE0O21EJs3QpScAurtECWnIDZvlMGMiIgiXkh6wqqqqrB27Vroug4hBCZNmoRx48YhMzMTa9aswZtvvomsrCxcddVVoWgOUWQoyAdMKhRVzptUVBOE6/ikGYY2jYiILl5IQtjAgQPxxBNPdDienp6OP/3pT6FoAlHksde4A5iLoprk0CQREUW8ToWw+vp6NDY2ehzzNY+LiC6SNQGizjOICV2DYk0wsFFERNRVAgphBQUFePHFF1FWVtbhtrfeeqvLG0VEALJzgM0nIOAcitQ1QNPlcSIiingBhbAXXngBP/nJTzBlyhRYLJZgt4mIAKhWG/TZ892rI5VusjqSiIikgEJYS0sLZsyYAVXlft9EoaRabZyET0TUTQWUqubOnYt33nkHQohgt4eIiIioRwioJ2zChAlYuXIlNm3aBJvNcyjk+eefD0rDiIiIiLqzgELY008/jZEjR2LSpEmcE0ZERETUBQIKYaWlpXj88cc5J4yIiIioiwSUqnJycrBv375gt4WIiIioxwh4deQTTzyBUaNGITEx0eO2X/3qV0FpGBEREVF3FlAI69+/P/r37x/sthARERH1GAGFsPnz58NkMnU4brfbu7xBRERERD1BQHPCnnnmmQ41wmpra/Hwww8HpVFERERE3V1AIUxVVbzwwgvu76urq/HQQw/hhz/8YdAaRkRERNSdBRTCli5diurqarz66qs4d+4cHnroIUyePBk33XRTsNtHRERE1C0FFMJMJhOWLVuGY8eOYdmyZZgxYwZ+8pOfBLttRERERN2Wz4n5zz33HBRF8TgWFxcHk8mEEydOuLcrYokKIiIios7zGcL69Onj9XhWVlbQGkNERETUU/gMYTfeeGMo20FERETUo3AzSCIiIiIDMIQRERERGYAhjIiIiMgADGFEREREBgho70hvtm/fjmHDhqFfv35d2R6iiKfba4GCfMBeg4Y+GdCzRkC12oxuFhERhZkLDmFvv/026urqMG7cONx9991d2SaiiKXbayE2bwRMKhTVBMfp4xAHC6HPns8gRkREHi44hK1duxYOhwNFRUVd2R6iyFaQ7w5gAKCYTIBJlccnzTC4cUREFE46NSdM13VUVVW5vzebzRg5cmSXN4ooYtlr3AHMRVFNgL3GoAYREVG4CqgnzG63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/3y1D2vNaWlpKfzLvK6ujq1bt1Zx0sH65/nnn+emm24C4KabbtqU7xmAV199la6uLjo6Oqp9KGvO/v3751Q/53tfHDp0iPe9731YlsXll19OMplkbGxszY95LSh3Xd7xjncQCEia+eWXX77p/t9S7prMx/PPP8/1119PKBRiy5YtdHV1cfz48VU+wrVnoWtijOHgwYO8973vXeOjqgzajlwG5cYsHTt2rIpHVH0GBwc5deoUe/bs4ciRI/zwhz/kySefZNeuXXz84x/fNG23Ur7whS8A8Mu//MvccsstTExMFEKIW1pamJycrObhVY2nnnpqxv8oN/t7Zb73xejoKO3t7YXt/HFu5YKsNzqPPfYY119/feH7wcFB/uN//I/U1dXxa7/2a4vOGd5IlPt7GR0dZe/evYVtWltbN51ofeONN2hqaqK7u7vwWC29T1SELQNTZiGptdB8xA1OOp3mvvvu46677iIWi3Hrrbfy7/7dvwPgb//2b/mrv/or7r777iof5dryX/7Lf6G1tZWJiQn+63/9rwVfwmYnn8/zwgsv8Ou//usA+l5ZAP3/jPDQQw8RCAS48cYbARGqX//612loaODkyZN88Ytf5L777iMWi1X5SFef+f5eyr1XNhuz/3FXa+8TbUcug6WOWdoM5PN57rvvPm688Ube8573ANDc3Ixt29i2zS/90i9x4sSJKh/l2tPa2gpAU1MT1157LcePH6epqanQThobGyuYazcTL730Ejt37qS5uRnQ9wow7/uira2N4eHhwnab8f8zP/nJT3jhhRf43d/93YIADYVCNDQ0ALBr1y46Ozvp7++v5mGuGfP9vcy+J42Ojhb+H7QZcByH5557bka1tNbeJyrCloGOWRKMMfzP//k/2bp1K7/yK79SeLzUt/Lcc89tuukH6XSa6enpwteHDx9m+/bt9PX18cQTTwDwxBNPcO2111bzMKvC7H+tbvb3CjDv+6Kvr48nn3wSYwxvvvkmsVhsU4mwl19+mUceeYQ//MM/JBKJFB6fnJzEdV0ABgYG6O/vp7Ozs1qHuabM9/fS19fH008/TS6XY3BwkP7+fvbs2VOtw1xzXn31VXp6embYhGrtfaJhrcvkxRdf5Dvf+U5hzNLtt99e7UNac44cOcI999zD9u3bC/9KvfPOO3nqqac4ffo0lmXR0dHBb/3Wb22qm8fA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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;EDA-plots-II&quot;&gt;EDA plots II&lt;a class=&quot;anchor-link&quot; href=&quot;#EDA-plots-II&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Another idea that comes to mind is that the price of a ride could change during the day.&lt;/p&gt;
&lt;p&gt;Your goal is to plot the median fare amount for each hour of the day as a simple line plot. The hour feature is calculated for you. Don't worry if you do not know how to work with the date features. We will explore them in the chapter on Feature Engineering.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create hour feature&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;pickup_datetime&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickup_datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hour&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickup_datetime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hour&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Find median fare_amount for each hour&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hour_price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hour&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;as_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fare_amount&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot the line plot&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hour_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hour&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hour_price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fare_amount&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;marker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Hour of the day&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Median fare amount&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fare amount based on day time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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OkaPHo2nn376kjNJALBw4UIsXrwYjz32GEaNGoWnn34aTz31FObNm9ft1+xCkZGR+PDDD1FaWopx48bhRz/6EX7961/DarU6njNmzBg8++yzWLlyJUaNGoXly5d3GiJ//OMfo6WlBbfddhvCw8O7PHdQUBBWrFiBN954A/369cOVV17Zqz/LxbKzs7FhwwZs374dV199NdLT0/HLX/4SZrPZ6VInka9T0tECBSIiok7s2LED6enpKCgoaHdDCBH1DAMZERG5pKGhAcePH8fPf/5z1NfXY8OGDVqXRBQweMmSiIhcsmbNGqSkpODo0aNYtWqV1uUQBRTOkBERERFpjDNkRERERBpjICMiIiLSGAMZERERkcb8vlN/V/2I3CU2NhZlZWUcl+NyXI7LcQNkXE+OzXE5bmf69u3b6WOcISMiIiLSGAMZERERkcYYyIiIiIg0xkBGREREpDEGMiIiIiKNMZARERERaYyBjIiIiEhjDGREREREGmMgIyIiItIYAxkRERGRxhjIiIiIiDTGQEZERESkMQYyIiIiIo0xkBERERFpjIGMiIiISGNGrQsg/bJtyYG8vwanKsuAmFio2XNhmJCldVlERERex0BGmrBtyYGsWQk0NtgPVJyBrFkJG8BQRkREusNLlqQJeX/NN2GsTWOD/TgREZHOMJCRNirKuneciIgogDGQkTYssd07TkREFMAYyEgbs+e2P2YKgeroOBERUYDjon7ShCF5MGwAoBQgAljieJclERHpFmfISBNSkAsAUFnXAwAMj77AMEZERLrFQEaakMI8YHAKMHCY/UBVpbYFERERaYiBjLxOzpYDh4qh0sdDRVvsB89WaFsUERGRhriGjLxOCrcCAFRGpn39GAA5WwGlZVFEREQaYiAjr5PCPCAuEeg7ADhfaz9YVa5tUURERBriJUvyKqmvA/YUQqVnQikFhEcCwSagkpcsiYhIvxjIyLuK8oHmJqiM8QAApRSCLLFcQ0ZERLrGQEZeJQW59lmxYaMcxwwxsZAqBjIiItIvBjLyGmlpgezcBjV6HFRQkOO4gTNkRESkcwxk5D0H9gC1Nfa7Ky8QZI1jICMiIl1jICOvkcI8wGgEUsc4HTfExAINdZD68xpVRkREpC0GMvIKEbGvH7tsNFRouNNjBkus/QPeaUlERDrFQEbeUXocOH0SKn18u4eC2gLZ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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We see that prices are a bit higher during the night. It is a good indicator that we should include the &lt;code&gt;&quot;hour&quot;&lt;/code&gt; feature in the final model, or at least add a binary feature &lt;code&gt;&quot;is_night&quot;&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Local-Validation&quot;&gt;Local Validation&lt;a class=&quot;anchor-link&quot; href=&quot;#Local-Validation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Holdout set
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/holdout_set.png&quot; alt=&quot;holdout&quot; /&gt;&lt;/li&gt;
&lt;li&gt;K-fold cross-validation
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/kfold_cv.png&quot; alt=&quot;kfold_cv&quot; /&gt;&lt;/li&gt;
&lt;li&gt;Stratified K-fold
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/stratified_kfold.png&quot; alt=&quot;stratified&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;K-fold-cross-validation&quot;&gt;K-fold cross-validation&lt;a class=&quot;anchor-link&quot; href=&quot;#K-fold-cross-validation&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You will start by getting hands-on experience in the most commonly used K-fold cross-validation.&lt;/p&gt;
&lt;p&gt;The data you'll be working with is from the &quot;Two sigma connect: rental listing inquiries&quot; Kaggle competition. The competition problem is a multi-class classification of the rental listings into 3 classes: low interest, medium interest and high interest. For faster performance, you will work with a subsample consisting of 1,000 observations.&lt;/p&gt;
&lt;p&gt;You need to implement a K-fold validation strategy and look at the sizes of each fold obtained.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/twosigma_rental_train.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KFold&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a KFold object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KFold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_splits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Loop through each split&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Obtain training and test folds&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Fold: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;CV train shape: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Medium interest listings in CV train: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interest_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;medium&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Fold: 0
CV train shape: (666, 9)
Medium interest listings in CV train: 175

Fold: 1
CV train shape: (667, 9)
Medium interest listings in CV train: 165

Fold: 2
CV train shape: (667, 9)
Medium interest listings in CV train: 162

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Stratified-K-fold&quot;&gt;Stratified K-fold&lt;a class=&quot;anchor-link&quot; href=&quot;#Stratified-K-fold&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;As you've just noticed, you have a pretty different target variable distribution among the folds due to the random splits. It's not crucial for this particular competition, but could be an issue for the classification competitions with the highly imbalanced target variable.&lt;/p&gt;
&lt;p&gt;To overcome this, let's implement the stratified K-fold strategy with the stratification on the target variable.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StratifiedKFold&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a StratifiedKFold object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;str_kf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StratifiedKFold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_splits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Loop through each split&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str_kf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;interest_level&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Obtain training and test folds&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fold: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;CV train shape: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Medium interest listings in CV train: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interest_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;medium&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Fold: 0
CV train shape: (666, 9)
Medium interest listings in CV train: 167

Fold: 1
CV train shape: (667, 9)
Medium interest listings in CV train: 167

Fold: 2
CV train shape: (667, 9)
Medium interest listings in CV train: 168

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Validation-usage&quot;&gt;Validation usage&lt;a class=&quot;anchor-link&quot; href=&quot;#Validation-usage&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Data Leakage&lt;ul&gt;
&lt;li&gt;Leak in &lt;strong&gt;features&lt;/strong&gt; - using data that will not be available in the real setting&lt;/li&gt;
&lt;li&gt;Leak in &lt;strong&gt;validation strategy&lt;/strong&gt; - validation strategy differs from the real-world situation&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Time K-fold cross-validation&lt;ul&gt;
&lt;li&gt;Time-series data cannot use with KFold Cross validation
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/time_kfold.png&quot; alt=&quot;time kfold&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Time-K-fold&quot;&gt;Time K-fold&lt;a class=&quot;anchor-link&quot; href=&quot;#Time-K-fold&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Remember the &quot;Store Item Demand Forecasting Challenge&quot; where you are given store-item sales data, and have to predict future sales?&lt;/p&gt;
&lt;p&gt;It's a competition with time series data. So, time K-fold cross-validation should be applied. Your goal is to create this cross-validation strategy and make sure that it works as expected.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/demand_forecasting_train_1_month.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeSeriesSplit&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create TimeSeriesSplit object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_kfold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeSeriesSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_splits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# sort train data by date&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;date&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Iterate through each split&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_kfold&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fold :&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Train date range: from &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; to &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Test date range: from &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; to &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cv_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Fold : 0
Train date range: from 2017-12-01 to 2017-12-08
Test date range: from 2017-12-08 to 2017-12-16

Fold : 1
Train date range: from 2017-12-01 to 2017-12-16
Test date range: from 2017-12-16 to 2017-12-24

Fold : 2
Train date range: from 2017-12-01 to 2017-12-24
Test date range: from 2017-12-24 to 2017-12-31

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Overall-validation-score&quot;&gt;Overall validation score&lt;a class=&quot;anchor-link&quot; href=&quot;#Overall-validation-score&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now it's time to get the actual model performance using cross-validation! How does our store item demand prediction model perform?&lt;/p&gt;
&lt;p&gt;Your task is to take the Mean Squared Error (MSE) for each fold separately, and then combine these results into a single number.&lt;/p&gt;
&lt;p&gt;For simplicity, you're given &lt;code&gt;get_fold_mse()&lt;/code&gt; function that for each cross-validation split fits a Random Forest model and returns a list of MSE scores by fold.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.ensemble&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestRegressor&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_fold_mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mse_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fold_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Fit the data and make predictions&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Create a Random Forest object&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestRegressor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_estimators&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Train a model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;store&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Get predictions for the test set&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;store&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
    
        &lt;span class=&quot;n&quot;&gt;fold_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean_squared_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mse_scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mse_scores&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Initialize 3-fold time cross-validation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeSeriesSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_splits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get MSE scores for each cross-validation split&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mse_scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_fold_mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Mean validation MSE: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.5f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mse_scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;MSE by fold: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mse_scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Overall Validation MSE: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.5f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mse_scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mse_scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Mean validation MSE: 955.49186
MSE by fold: [890.30336, 961.65797, 1014.51424]
Overall Validation MSE: 1006.38784
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/Kaggle_logo.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/Kaggle_logo.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Kaggle competitions process</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/01-Kaggle-competitions-process.html" rel="alternate" type="text/html" title="Kaggle competitions process" /><published>2020-08-12T00:00:00-05:00</published><updated>2020-08-12T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/01-Kaggle-competitions-process</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/kaggle/machine_learning/2020/08/12/01-Kaggle-competitions-process.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-12-01-Kaggle-competitions-process.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Competitions-overview&quot;&gt;Competitions overview&lt;a class=&quot;anchor-link&quot; href=&quot;#Competitions-overview&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Kaggle benefits&lt;ul&gt;
&lt;li&gt;Get practical experience on the real-world data&lt;/li&gt;
&lt;li&gt;Develop portfolio projects&lt;/li&gt;
&lt;li&gt;Meet a great Data Science community&lt;/li&gt;
&lt;li&gt;Try new domain or model type&lt;/li&gt;
&lt;li&gt;Keep up-to-date with the best performing methods&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Process
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/competition_process.png&quot; alt=&quot;process&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Explore-train-data&quot;&gt;Explore train data&lt;a class=&quot;anchor-link&quot; href=&quot;#Explore-train-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You will work with another Kaggle competition called &quot;Store Item Demand Forecasting Challenge&quot;. In this competition, you are given 5 years of store-item sales data, and asked to predict 3 months of sales for 50 different items in 10 different stores.&lt;/p&gt;
&lt;p&gt;To begin, let's explore the train data for this competition. For the faster performance, you will work with a subset of the train data containing only a single month history.&lt;/p&gt;
&lt;p&gt;Your initial goal is to read the input data and take the first look at it.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Read train data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/demand_forecasting_train_1_month.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Look at the shape of the data&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Train shape:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Look at the head() of the data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Train shape: (15500, 5)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;id&lt;/th&gt;
      &lt;th&gt;date&lt;/th&gt;
      &lt;th&gt;store&lt;/th&gt;
      &lt;th&gt;item&lt;/th&gt;
      &lt;th&gt;sales&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;100000&lt;/td&gt;
      &lt;td&gt;2017-12-01&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;19&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;100001&lt;/td&gt;
      &lt;td&gt;2017-12-02&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;16&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;100002&lt;/td&gt;
      &lt;td&gt;2017-12-03&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;31&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;100003&lt;/td&gt;
      &lt;td&gt;2017-12-04&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;100004&lt;/td&gt;
      &lt;td&gt;2017-12-05&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Explore-test-data&quot;&gt;Explore test data&lt;a class=&quot;anchor-link&quot; href=&quot;#Explore-test-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Having looked at the train data, let's explore the test data in the &quot;Store Item Demand Forecasting Challenge&quot;. Remember, that the test dataset generally contains one column less than the train one.&lt;/p&gt;
&lt;p&gt;This column, together with the output format, is presented in the sample submission file. Before making any progress in the competition, you should get familiar with the expected output.&lt;/p&gt;
&lt;p&gt;That is why, let's look at the columns of the test dataset and compare it to the train columns. Additionally, let's explore the format of the sample submission.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Read the test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/demand_forecasting_test.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Print train and test columns&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Train columns:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Test columns:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Train columns: [&amp;#39;id&amp;#39;, &amp;#39;date&amp;#39;, &amp;#39;store&amp;#39;, &amp;#39;item&amp;#39;, &amp;#39;sales&amp;#39;]
Test columns: [&amp;#39;id&amp;#39;, &amp;#39;date&amp;#39;, &amp;#39;store&amp;#39;, &amp;#39;item&amp;#39;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Read the sample submission file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample_submission&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/sample_submission.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Look at the head() of the sample submission&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample_submission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;id&lt;/th&gt;
      &lt;th&gt;sales&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The sample submission file consists of two columns: &lt;code&gt;id&lt;/code&gt; of the observation and &lt;code&gt;sales&lt;/code&gt; column for your predictions. Kaggle will evaluate your predictions on the true &lt;code&gt;sales&lt;/code&gt; data for the corresponding &lt;code&gt;id&lt;/code&gt;. So, it’s important to keep track of the predictions by &lt;code&gt;id&lt;/code&gt; before submitting them.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Prepare-your-first-submission&quot;&gt;Prepare your first submission&lt;a class=&quot;anchor-link&quot; href=&quot;#Prepare-your-first-submission&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Determine-a-problem-type&quot;&gt;Determine a problem type&lt;a class=&quot;anchor-link&quot; href=&quot;#Determine-a-problem-type&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You will keep working on the Store Item Demand Forecasting Challenge. Recall that you are given a history of store-item sales data, and asked to predict 3 months of the future sales.&lt;/p&gt;
&lt;p&gt;Before building a model, you should determine the problem type you are addressing. The goal of this exercise is to look at the distribution of the target variable, and select the correct problem type you will be building a model for.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sales&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;histogram of sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Train-a-simple-model&quot;&gt;Train a simple model&lt;a class=&quot;anchor-link&quot; href=&quot;#Train-a-simple-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;As you determined, you are dealing with a regression problem. So, now you're ready to build a model for a subsequent submission. But now, instead of building the simplest Linear Regression model as in the slides, let's build an out-of-box Random Forest model.&lt;/p&gt;
&lt;p&gt;You will use the &lt;code&gt;RandomForestRegressor&lt;/code&gt; class from the scikit-learn library.&lt;/p&gt;
&lt;p&gt;Your objective is to train a Random Forest model with default parameters on the &quot;store&quot; and &quot;item&quot; features.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.ensemble&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestRegressor&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a Random Forest object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestRegressor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train a model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;store&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;RandomForestRegressor()&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Prepare-a-submission&quot;&gt;Prepare a submission&lt;a class=&quot;anchor-link&quot; href=&quot;#Prepare-a-submission&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You've already built a model on the training data from the Kaggle Store Item Demand Forecasting Challenge. Now, it's time to make predictions on the test data and create a submission file in the specified format.&lt;/p&gt;
&lt;p&gt;Your goal is to read the test data, make predictions, and save these in the format specified in the &quot;sample_submission.csv&quot; file.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Show the head() of the sample_submission&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample_submission&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;id&lt;/th&gt;
      &lt;th&gt;sales&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Get predictions for the test set&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;store&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Write test predictions using the sample_submission format&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;kaggle_submission.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;head kaggle_submission.csv
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;id,sales
0,17.143270686120914
1,17.143270686120914
2,17.143270686120914
3,17.143270686120914
4,17.143270686120914
5,17.143270686120914
6,17.143270686120914
7,17.143270686120914
8,17.143270686120914
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Public-vs-Private-leaderboard&quot;&gt;Public vs Private leaderboard&lt;a class=&quot;anchor-link&quot; href=&quot;#Public-vs-Private-leaderboard&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Competition metric&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th&gt;Evaluation metric&lt;/th&gt;
&lt;th&gt;Type of problem&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Area Under the ROC (AUC)&lt;/td&gt;
&lt;td&gt;Classification&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;F1 score (F1)&lt;/td&gt;
&lt;td&gt;Classification&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Mean Log Loss (LogLoss)&lt;/td&gt;
&lt;td&gt;Classification&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Mean Absolute Error (MAE)&lt;/td&gt;
&lt;td&gt;Regression&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Mean Squared Erro (MSE)&lt;/td&gt;
&lt;td&gt;Regression&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Mean Average Precision at K (MAPK, MAP@K)&lt;/td&gt;
&lt;td&gt;Ranking&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;Overfitting in kaggle
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/overfitting_kaggle.png&quot; alt=&quot;of&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Train-XGBoost-models&quot;&gt;Train XGBoost models&lt;a class=&quot;anchor-link&quot; href=&quot;#Train-XGBoost-models&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Every Machine Learning method could potentially overfit. You will see it on this example with XGBoost. Again, you are working with the Store Item Demand Forecasting Challenge.&lt;/p&gt;
&lt;p&gt;Firstly, let's train multiple XGBoost models with different sets of hyperparameters using XGBoost's learning API. The single hyperparameter you will change is:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;max_depth&lt;/code&gt; - maximum depth of a tree. Increasing this value will make the model more complex and more likely to overfit.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;xgboost&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;xgb&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create DMatrix on train data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DMatrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;store&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define xgboost parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;objective&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;reg:squarederror&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s1&quot;&gt;&amp;#39;verbosity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train xgboost model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;xg_depth_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define xgboost parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;objective&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;reg:squarederror&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s1&quot;&gt;&amp;#39;verbosity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train xgboost model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;xg_depth_8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define xgboost parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;objective&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;reg:squarederror&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s1&quot;&gt;&amp;#39;verbosity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train xgboost model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;xg_depth_15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Explore-overfitting-XGBoost&quot;&gt;Explore overfitting XGBoost&lt;a class=&quot;anchor-link&quot; href=&quot;#Explore-overfitting-XGBoost&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Having trained 3 XGBoost models with different maximum depths, you will now evaluate their quality. For this purpose, you will measure the quality of each model on both the train data and the test data. As you know by now, the train data is the data models have been trained on. The test data is the next month sales data that models have never seen before.&lt;/p&gt;
&lt;p&gt;The goal of this exercise is to determine whether any of the models trained is overfitting. To measure the quality of the models you will use Mean Squared Error (MSE). It's available in &lt;code&gt;sklearn.metrics&lt;/code&gt; as &lt;code&gt;mean_squared_error()&lt;/code&gt; function that takes two arguments: true values and predicted values.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mean_squared_error&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DMatrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;store&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DMatrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;store&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# For each of 3 trained models&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xg_depth_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xg_depth_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xg_depth_15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Make predictions&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;train_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;test_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Calculate metrics&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mse_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mean_squared_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mse_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mean_squared_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;MSE Train: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.3f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;. MSE Test: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.3f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mse_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mse_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;MSE Train: 331.064. MSE Test: 249.849
MSE Train: 112.057. MSE Test: 30.751
MSE Train: 84.952. MSE Test: 3.536
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/Kaggle_logo.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/Kaggle_logo.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Object Recognition with ALL-CNN</title><link href="https://goodboychan.github.io/chans_jupyter/python/deep_learning/vision/2020/08/11/03-Object-Recognition-with-ALLCNN.html" rel="alternate" type="text/html" title="Object Recognition with ALL-CNN" /><published>2020-08-11T00:00:00-05:00</published><updated>2020-08-11T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/deep_learning/vision/2020/08/11/03-Object-Recognition-with-ALLCNN</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/deep_learning/vision/2020/08/11/03-Object-Recognition-with-ALLCNN.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-11-03-Object-Recognition-with-ALLCNN.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://arxiv.org/abs/1412.6806&quot;&gt;This paper&lt;/a&gt; introduced the convolutional neural network obtained state-of-the-art performance at object recognition on the CIFAR-10 image datasaet in 2015.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Required-Packages&quot;&gt;Required Packages&lt;a class=&quot;anchor-link&quot; href=&quot;#Required-Packages&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;mpl&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;figure.figsize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Version-check&quot;&gt;Version check&lt;a class=&quot;anchor-link&quot; href=&quot;#Version-check&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Python: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Numpy: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__version__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Pandas: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__version__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Tensorflow: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__version__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Python: 3.7.6 (default, Jan  8 2020, 20:23:39) [MSC v.1916 64 bit (AMD64)]
Numpy: 1.18.1
Pandas: 1.0.1
Tensorflow: 2.1.0
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Prepare-dataset&quot;&gt;Prepare dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Prepare-dataset&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The original data is from &lt;a href=&quot;https://www.cs.toronto.edu/~kriz/cifar.html&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Load the data&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;airplane&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;automobile&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;bird&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;deer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dog&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;frog&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;horse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ship&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;truck&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Determine the dataset characteristics&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Training Images: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Test images: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Training Images: (50000, 32, 32, 3)
Test images: (10000, 32, 32, 3)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# A single image&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(32, 32, 3)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create a grid of 3x3 images&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;330&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Preprocess-Data&quot;&gt;Preprocess Data&lt;a class=&quot;anchor-link&quot; href=&quot;#Preprocess-Data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# fix random seed for reproducibiliy&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Normalize the inputs from 0-255 to 0.0-1.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Class labels shape&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(50000, 1)
[6]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Convert the label with Onehot Encoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(50000, 10)
[0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Building-the-All-CNN-model&quot;&gt;Building the All-CNN model&lt;a class=&quot;anchor-link&quot; href=&quot;#Building-the-All-CNN-model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this project, we`ll implement ALL-CNN-C model&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Input - 32 x 32 RGB image&lt;/li&gt;
&lt;li&gt;Layer Architecture&lt;ul&gt;
&lt;li&gt;3x3 conv. 96 ReLU&lt;/li&gt;
&lt;li&gt;3x3 conv. 96 ReLU&lt;/li&gt;
&lt;li&gt;3x3 max-pooling stride 2&lt;/li&gt;
&lt;li&gt;3x3 conv. 192 ReLU&lt;/li&gt;
&lt;li&gt;3x3 conv. 192 ReLU&lt;/li&gt;
&lt;li&gt;3x3 max-pooling stride 2&lt;/li&gt;
&lt;li&gt;3x3 conv. 192 ReLU&lt;/li&gt;
&lt;li&gt;1x1 conv. 192 ReLU&lt;/li&gt;
&lt;li&gt;1x1 conv. 10 ReLU&lt;/li&gt;
&lt;li&gt;global averaging over 6x6 spatial dimensions&lt;/li&gt;
&lt;li&gt;10-way softmax&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# import necessary layers&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GlobalAvgPool2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPool2D&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.optimizers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define the model function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;allcnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# define model type = Sequential&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Add model layer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPool2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;192&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;192&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPool2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;192&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;192&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GlobalAvgPool2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;softmax&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Load the weights&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define hyperparamters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;weight_decay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;momentum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Parameter Grid Search&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allcnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define optimizer and compile model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sgd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_decay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;momentum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;momentum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nesterov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;categorical_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sgd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Model: &amp;#34;sequential_8&amp;#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_39 (Conv2D)           (None, 32, 32, 96)        2688      
_________________________________________________________________
conv2d_40 (Conv2D)           (None, 32, 32, 96)        83040     
_________________________________________________________________
max_pooling2d_10 (MaxPooling (None, 16, 16, 96)        0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 16, 16, 96)        0         
_________________________________________________________________
conv2d_41 (Conv2D)           (None, 16, 16, 192)       166080    
_________________________________________________________________
conv2d_42 (Conv2D)           (None, 16, 16, 192)       331968    
_________________________________________________________________
max_pooling2d_11 (MaxPooling (None, 8, 8, 192)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 8, 8, 192)         0         
_________________________________________________________________
conv2d_43 (Conv2D)           (None, 8, 8, 192)         331968    
_________________________________________________________________
conv2d_44 (Conv2D)           (None, 8, 8, 192)         37056     
_________________________________________________________________
conv2d_45 (Conv2D)           (None, 8, 8, 10)          1930      
_________________________________________________________________
global_average_pooling2d_4 ( (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 10)                110       
=================================================================
Total params: 954,840
Trainable params: 954,840
Non-trainable params: 0
_________________________________________________________________
None
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.callbacks&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ModelCheckpoint&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ModelCheckpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;best_weights.hdf5&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monitor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;save_best_only&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define additional training parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fit the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
          &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Train on 50000 samples, validate on 10000 samples
Epoch 1/100
50000/50000 [==============================] - 11s 218us/sample - loss: 1.9512 - accuracy: 0.2375 - val_loss: 1.7935 - val_accuracy: 0.3067
Epoch 2/100
50000/50000 [==============================] - 11s 211us/sample - loss: 1.5540 - accuracy: 0.4074 - val_loss: 1.3599 - val_accuracy: 0.4934
Epoch 3/100
50000/50000 [==============================] - 11s 216us/sample - loss: 1.2937 - accuracy: 0.5223 - val_loss: 1.1712 - val_accuracy: 0.5708
Epoch 4/100
50000/50000 [==============================] - 11s 217us/sample - loss: 1.1107 - accuracy: 0.5983 - val_loss: 1.0279 - val_accuracy: 0.6302
Epoch 5/100
50000/50000 [==============================] - 11s 213us/sample - loss: 0.9708 - accuracy: 0.6483 - val_loss: 0.8836 - val_accuracy: 0.6837
Epoch 6/100
50000/50000 [==============================] - 11s 213us/sample - loss: 0.8706 - accuracy: 0.6919 - val_loss: 0.8344 - val_accuracy: 0.7038
Epoch 7/100
50000/50000 [==============================] - 11s 214us/sample - loss: 0.7842 - accuracy: 0.7222 - val_loss: 0.8831 - val_accuracy: 0.6912
Epoch 8/100
50000/50000 [==============================] - 11s 218us/sample - loss: 0.7187 - accuracy: 0.7469 - val_loss: 0.7148 - val_accuracy: 0.7493
Epoch 9/100
50000/50000 [==============================] - 11s 212us/sample - loss: 0.6577 - accuracy: 0.7688 - val_loss: 0.6144 - val_accuracy: 0.7871
Epoch 10/100
50000/50000 [==============================] - 11s 212us/sample - loss: 0.6105 - accuracy: 0.7864 - val_loss: 0.6142 - val_accuracy: 0.7877
Epoch 11/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.5741 - accuracy: 0.7990 - val_loss: 0.5857 - val_accuracy: 0.8023
Epoch 12/100
50000/50000 [==============================] - 11s 211us/sample - loss: 0.5434 - accuracy: 0.8094 - val_loss: 0.5582 - val_accuracy: 0.8128
Epoch 13/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.5121 - accuracy: 0.8215 - val_loss: 0.5465 - val_accuracy: 0.8111
Epoch 14/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.4844 - accuracy: 0.8303 - val_loss: 0.5103 - val_accuracy: 0.8259
Epoch 15/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.4639 - accuracy: 0.8381 - val_loss: 0.5382 - val_accuracy: 0.8232
Epoch 16/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.4445 - accuracy: 0.8436 - val_loss: 0.5216 - val_accuracy: 0.8292
Epoch 17/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.4258 - accuracy: 0.8507 - val_loss: 0.4929 - val_accuracy: 0.8363
Epoch 18/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.4068 - accuracy: 0.8563 - val_loss: 0.5049 - val_accuracy: 0.8325
Epoch 19/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.3917 - accuracy: 0.8616 - val_loss: 0.5115 - val_accuracy: 0.8349
Epoch 20/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.3772 - accuracy: 0.8677 - val_loss: 0.4758 - val_accuracy: 0.8449
Epoch 21/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.3665 - accuracy: 0.8701 - val_loss: 0.4788 - val_accuracy: 0.8431
Epoch 22/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.3534 - accuracy: 0.8752 - val_loss: 0.4976 - val_accuracy: 0.8393
Epoch 23/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.3461 - accuracy: 0.8770 - val_loss: 0.4735 - val_accuracy: 0.8452
Epoch 24/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.3298 - accuracy: 0.8828 - val_loss: 0.4889 - val_accuracy: 0.8456
Epoch 25/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.3220 - accuracy: 0.8862 - val_loss: 0.4937 - val_accuracy: 0.8445
Epoch 26/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.3155 - accuracy: 0.8882 - val_loss: 0.4512 - val_accuracy: 0.8530
Epoch 27/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.3057 - accuracy: 0.8913 - val_loss: 0.5041 - val_accuracy: 0.8447
Epoch 28/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2955 - accuracy: 0.8951 - val_loss: 0.5083 - val_accuracy: 0.8474
Epoch 29/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2910 - accuracy: 0.8964 - val_loss: 0.5262 - val_accuracy: 0.8432
Epoch 30/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2867 - accuracy: 0.8974 - val_loss: 0.4747 - val_accuracy: 0.8564
Epoch 31/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2738 - accuracy: 0.9029 - val_loss: 0.4954 - val_accuracy: 0.8509
Epoch 32/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2679 - accuracy: 0.9047 - val_loss: 0.4716 - val_accuracy: 0.8597
Epoch 33/100
50000/50000 [==============================] - 10s 209us/sample - loss: 0.2643 - accuracy: 0.9060 - val_loss: 0.5434 - val_accuracy: 0.8457
Epoch 34/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2567 - accuracy: 0.9099 - val_loss: 0.5056 - val_accuracy: 0.8520
Epoch 35/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2556 - accuracy: 0.9080 - val_loss: 0.5048 - val_accuracy: 0.8489
Epoch 36/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.2483 - accuracy: 0.9117 - val_loss: 0.4827 - val_accuracy: 0.8579
Epoch 37/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2428 - accuracy: 0.9151 - val_loss: 0.5077 - val_accuracy: 0.8509
Epoch 38/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2391 - accuracy: 0.9150 - val_loss: 0.5151 - val_accuracy: 0.8542
Epoch 39/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2393 - accuracy: 0.9155 - val_loss: 0.4748 - val_accuracy: 0.8594
Epoch 40/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2329 - accuracy: 0.9171 - val_loss: 0.4654 - val_accuracy: 0.8653
Epoch 41/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2255 - accuracy: 0.9191 - val_loss: 0.5062 - val_accuracy: 0.8573
Epoch 42/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2266 - accuracy: 0.9201 - val_loss: 0.5217 - val_accuracy: 0.8610
Epoch 43/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2242 - accuracy: 0.9207 - val_loss: 0.4751 - val_accuracy: 0.8644
Epoch 44/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2152 - accuracy: 0.9235 - val_loss: 0.5211 - val_accuracy: 0.8579
Epoch 45/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2166 - accuracy: 0.9231 - val_loss: 0.4649 - val_accuracy: 0.8697
Epoch 46/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2114 - accuracy: 0.9246 - val_loss: 0.5254 - val_accuracy: 0.8570
Epoch 47/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.2087 - accuracy: 0.9247 - val_loss: 0.4847 - val_accuracy: 0.8628
Epoch 48/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.2086 - accuracy: 0.9267 - val_loss: 0.5284 - val_accuracy: 0.8564
Epoch 49/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.2013 - accuracy: 0.9284 - val_loss: 0.5377 - val_accuracy: 0.8554
Epoch 50/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.2010 - accuracy: 0.9288 - val_loss: 0.4966 - val_accuracy: 0.8664
Epoch 51/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1942 - accuracy: 0.9299 - val_loss: 0.5608 - val_accuracy: 0.8558
Epoch 52/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1926 - accuracy: 0.9318 - val_loss: 0.5056 - val_accuracy: 0.8673
Epoch 53/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1949 - accuracy: 0.9311 - val_loss: 0.4883 - val_accuracy: 0.8635
Epoch 54/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1888 - accuracy: 0.9332 - val_loss: 0.5422 - val_accuracy: 0.8574
Epoch 55/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1885 - accuracy: 0.9330 - val_loss: 0.5360 - val_accuracy: 0.8629
Epoch 56/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1882 - accuracy: 0.9325 - val_loss: 0.5075 - val_accuracy: 0.8679
Epoch 57/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1834 - accuracy: 0.9348 - val_loss: 0.5165 - val_accuracy: 0.8645
Epoch 58/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1809 - accuracy: 0.9354 - val_loss: 0.5259 - val_accuracy: 0.8639
Epoch 59/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1738 - accuracy: 0.9384 - val_loss: 0.5745 - val_accuracy: 0.8530
Epoch 60/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1698 - accuracy: 0.9405 - val_loss: 0.5370 - val_accuracy: 0.8645
Epoch 61/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1744 - accuracy: 0.9381 - val_loss: 0.5868 - val_accuracy: 0.8539
Epoch 62/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1748 - accuracy: 0.9380 - val_loss: 0.5534 - val_accuracy: 0.8665
Epoch 63/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1669 - accuracy: 0.9408 - val_loss: 0.5320 - val_accuracy: 0.8667
Epoch 64/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1634 - accuracy: 0.9422 - val_loss: 0.5764 - val_accuracy: 0.8621
Epoch 65/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1639 - accuracy: 0.9415 - val_loss: 0.5295 - val_accuracy: 0.8664
Epoch 66/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1604 - accuracy: 0.9435 - val_loss: 0.5840 - val_accuracy: 0.8638
Epoch 67/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1633 - accuracy: 0.9422 - val_loss: 0.5513 - val_accuracy: 0.8629
Epoch 68/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1592 - accuracy: 0.9442 - val_loss: 0.5619 - val_accuracy: 0.8599
Epoch 69/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1652 - accuracy: 0.9417 - val_loss: 0.5597 - val_accuracy: 0.8650
Epoch 70/100
50000/50000 [==============================] - 10s 205us/sample - loss: 0.1598 - accuracy: 0.9435 - val_loss: 0.5407 - val_accuracy: 0.8673
Epoch 71/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1539 - accuracy: 0.9450 - val_loss: 0.5509 - val_accuracy: 0.8651
Epoch 72/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1525 - accuracy: 0.9454 - val_loss: 0.5781 - val_accuracy: 0.8675
Epoch 73/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1584 - accuracy: 0.9447 - val_loss: 0.5658 - val_accuracy: 0.8579
Epoch 74/100
50000/50000 [==============================] - 10s 206us/sample - loss: 0.1502 - accuracy: 0.9473 - val_loss: 0.6248 - val_accuracy: 0.8586
Epoch 75/100
50000/50000 [==============================] - 10s 209us/sample - loss: 0.1522 - accuracy: 0.9452 - val_loss: 0.5733 - val_accuracy: 0.8632
Epoch 76/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1500 - accuracy: 0.9459 - val_loss: 0.5960 - val_accuracy: 0.8628
Epoch 77/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1447 - accuracy: 0.9492 - val_loss: 0.5895 - val_accuracy: 0.8644
Epoch 78/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1437 - accuracy: 0.9499 - val_loss: 0.5247 - val_accuracy: 0.8641
Epoch 79/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1454 - accuracy: 0.9480 - val_loss: 0.5667 - val_accuracy: 0.8658
Epoch 80/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1432 - accuracy: 0.9497 - val_loss: 0.5354 - val_accuracy: 0.8723
Epoch 81/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1437 - accuracy: 0.9505 - val_loss: 0.5759 - val_accuracy: 0.8647
Epoch 82/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1418 - accuracy: 0.9500 - val_loss: 0.5877 - val_accuracy: 0.8703
Epoch 83/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1387 - accuracy: 0.9505 - val_loss: 0.5735 - val_accuracy: 0.8690
Epoch 84/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1407 - accuracy: 0.9510 - val_loss: 0.5740 - val_accuracy: 0.8737
Epoch 85/100
50000/50000 [==============================] - 10s 209us/sample - loss: 0.1334 - accuracy: 0.9532 - val_loss: 0.5730 - val_accuracy: 0.8710
Epoch 86/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1342 - accuracy: 0.9532 - val_loss: 0.5903 - val_accuracy: 0.8663
Epoch 87/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1328 - accuracy: 0.9540 - val_loss: 0.5985 - val_accuracy: 0.8659
Epoch 88/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1376 - accuracy: 0.9514 - val_loss: 0.5755 - val_accuracy: 0.8648
Epoch 89/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1319 - accuracy: 0.9536 - val_loss: 0.5957 - val_accuracy: 0.8661
Epoch 90/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1333 - accuracy: 0.9530 - val_loss: 0.5988 - val_accuracy: 0.8633
Epoch 91/100
50000/50000 [==============================] - 10s 209us/sample - loss: 0.1282 - accuracy: 0.9554 - val_loss: 0.6002 - val_accuracy: 0.8674
Epoch 92/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1333 - accuracy: 0.9531 - val_loss: 0.5531 - val_accuracy: 0.8706
Epoch 93/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1310 - accuracy: 0.9544 - val_loss: 0.5540 - val_accuracy: 0.8720
Epoch 94/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1241 - accuracy: 0.9567 - val_loss: 0.6359 - val_accuracy: 0.8632
Epoch 95/100
50000/50000 [==============================] - 10s 207us/sample - loss: 0.1281 - accuracy: 0.9551 - val_loss: 0.6134 - val_accuracy: 0.8645
Epoch 96/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1275 - accuracy: 0.9557 - val_loss: 0.5925 - val_accuracy: 0.8708
Epoch 97/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1226 - accuracy: 0.9574 - val_loss: 0.6412 - val_accuracy: 0.8678
Epoch 98/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1239 - accuracy: 0.9570 - val_loss: 0.6448 - val_accuracy: 0.8597
Epoch 99/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1227 - accuracy: 0.9574 - val_loss: 0.5598 - val_accuracy: 0.8750
Epoch 100/100
50000/50000 [==============================] - 10s 208us/sample - loss: 0.1250 - accuracy: 0.9565 - val_loss: 0.6793 - val_accuracy: 0.8644
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Uh oh. It's apparent that training this deep convolutional neural network is going to take a long time, which is not surprising considering the network has about almost 1 million parameters. Updating this many parameters takes a considerable amount of time; unless, of course, you are using a Graphics Processing Unit (GPU). This is a good time for a quick lesson on the differences between CPUs and GPUs.&lt;/p&gt;
&lt;p&gt;The &lt;strong&gt;central processing unit (CPU)&lt;/strong&gt; is often called the brains of the PC because it handles the majority of necessary computations. All computers have a CPU and this is what Keras and Theano automatically utilize.&lt;/p&gt;
&lt;p&gt;The &lt;strong&gt;graphics processing unit (GPU)&lt;/strong&gt; is in charge of image rendering. The most advanced GPUs were originally designed for gamers; however, GPU-accelerated computing, the use of a GPU together with a CPU to accelarate deep learing, analytics, and engineering applications, has become increasingly common. In fact, the training of deep neural networks is not realistic without them.&lt;/p&gt;
&lt;p&gt;The most common GPUs for deep learning are produced by NVIDIA. Furthermore, the NVIDIA Deep Learning SDK provides high-performance tools and libraries to power GPU-accelerated machine learning applications. An alternative would be an AMD GPU in combination with the OpenCL libraries; however, these libraries have fewer active users and less support than the NVIDIA libraries.&lt;/p&gt;
&lt;p&gt;If your computer has an NVIDIA GPU, installing the CUDA Drivers and CUDA Tookit from NVIDIA will allow tensorflow to utilize GPU-accelerated computing. The original paper mentions that it took approximately 10 hours to train the All-CNN network for 350 epochs using a modern GPU, which is considerably faster (several orders of magnitude) than it would take to train on CPU.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Plot the training loss&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;train loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Plot the validation loss&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;validation loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;train_loss vs. validation loss on CIFAR-10&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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CgrYeyM1iSXOObZs2UJRURGDBg0K+3GtNn0759bX1Y6Dbf6Wsve+ruC357vfee/h97vtDZwMvOSc2xqE80vAKWGXTkREWrVr1y66du2qkI5xZkbXrl33ueVjn/qozawAGAO83+BUX/zuLHWKgmPNHRcRkQhSSMeH/fk9hR3UZpaN31Lw+865HQ1PN/EQ18Lxpu5/hZnNNbO5xcXF4RZLRESirKSkhDvuuGO/HnvqqadSUlLS+oWBG2+8kVtvvbX1CzuQsILazFLxIf2gc+7JJi4pAvqH/NwPWNfC8Uacc3c558Y558Z1797sHukiIhJjWgrqmpqaFh87e/Zs8vLyDkSxOoxWgzoY0f03YGmwgXpTngEuNm8CsN05tx54ATjJzPLNLB84KTgmIiIdxLXXXsuKFSsYPXo0V199Na+//jpTpkzhggsuYOTIkQCceeaZHH744QwfPpy77rprz2MLCgrYvHkzq1atYujQoXz9619n+PDhnHTSSVRUVLT4vB9//DETJkygsLCQs846i23b/Djl2267jWHDhlFYWMj06dMBeOONNxg9ejSjR49mzJgx7Ny58wC9G5EXzqjvicBFwEIz+zg4dh0wAMA5dycwGz81azl+etZlwbmtZnYT8GHwuF8657ZGrvgiIhLqF88uZsm6hr2TbTOsTw43nDa82fM333wzixYt4uOPfUS8/vrrfPDBByxatGjP6OZ77rmHLl26UFFRwRFHHME555xD165d97rPsmXLePjhh7n77rs5//zzeeKJJ7jwwgubfd6LL76YP/7xj0yaNImf//zn/OIXv2DWrFncfPPNrFy5kvT09D3N6rfeeiu33347EydOpLS0lIyMjLa+Le2m1aB2zr1F033Nodc44FvNnLsHuGe/SiciInFp/Pjxe01Buu2223jqqacAWLt2LcuWLWsU1IMGDWL06NEAHH744axatarZ+2/fvp2SkhImTZoEwCWXXMJ5550HQGFhITNnzuTMM8/kzDPPBGDixIn88Ic/ZObMmZx99tn069cvYq/1QIvJTTlERGT/tFTzbU9ZWVl7vn/99dd5+eWXeffdd8nMzGTy5MlNTlFKT0/f831ycnKrTd/Nee6555gzZw7PPPMMN910E4sXL+baa69l2rRpzJ49mwkTJvDyyy8zZMiQ/bp/e9MSoiIi0iadO3dusc93+/bt5Ofnk5mZySeffMJ7773X5ufMzc0lPz+fN998E4AHHniASZMmUVtby9q1a5kyZQq33HILJSUllJaWsmLFCkaOHMk111zDuHHj+OSTT9pchvaiGrWIiLRJ165dmThxIiNGjGDq1KlMmzZtr/OnnHIKd955J4WFhRx22GFMmDAhIs/797//nSuvvJLy8nIOOugg7r33XmpqarjwwgvZvn07zjl+8IMfkJeXx/XXX89rr71GcnIyw4YNY+rUqREpQ3sw370cW8aNG+e0H7WISHiWLl3K0KFDo10MCVNTvy8zm+ecG9fU9R2+6btsdzWlu6ujXQwREZH90uGD+rjfvs6v/r2k9QtFRERiUIcP6qy0FMoqW14ZR0REJFZ1+KDOTE+mXE3fIiISpzp+UKelqI9aRETiVocP6uz0FMrV9C0iInGqwwd1ZloyZZWqUYuIxJLs7GwA1q1bx7nnntvkNZMnT6a1qbqzZs2ivLx8z8/7um1mc2JpO80OH9RZaSmU71aNWkQkFvXp04fHH398vx/fMKg74raZHT6oM9OTKVMftYjIAXPNNdfstR/1jTfeyG9/+1tKS0s5/vjjGTt2LCNHjuRf//pXo8euWrWKESNGAFBRUcH06dMpLCzkK1/5yl5rfV911VWMGzeO4cOHc8MNNwB+o49169YxZcoUpkyZAtRvmwnwu9/9jhEjRjBixAhmzZq15/nibTvNDr+EaHZ6CmWV1Tjn8Ftri4h0YP+5FjYsjOw9e42EqTc3e3r69Ol8//vf55vf/CYAjz32GM8//zwZGRk89dRT5OTksHnzZiZMmMDpp5/e7N/iP//5z2RmZrJgwQIWLFjA2LFj95z79a9/TZcuXaipqeH4449nwYIFfPe73+V3v/sdr732Gt26ddvrXvPmzePee+/l/fffxznHkUceyaRJk8jPz4+77TQ7fo06LYVaB7ura6NdFBGRDmnMmDFs2rSJdevWMX/+fPLz8xkwYADOOa677joKCws54YQT+OKLL9i4cWOz95kzZ86ewCwsLKSwsHDPuccee4yxY8cyZswYFi9ezJIlLS9k9dZbb3HWWWeRlZVFdnY2Z5999p4NPNq6neacOXP2lHHmzJn84x//ICXF13vrttO87bbbKCkp2XO8LTp8jTorPRnwS4lmpCZHuTQiIgdYCzXfA+ncc8/l8ccfZ8OGDXuagR988EGKi4uZN28eqampFBQUNLm9ZaimatsrV67k1ltv5cMPPyQ/P59LL7201fu0tI9FvG2nmRA1akBTtEREDqDp06fzyCOP8Pjjj+8Zxb19+3Z69OhBamoqr732GqtXr27xHsceeywPPvggAIsWLWLBggUA7Nixg6ysLHJzc9m4cSP/+c9/9jymuS02jz32WJ5++mnKy8spKyvjqaee4phjjtnn1xUL22l2/Bp1mq9Fa9ETEZEDZ/jw4ezcuZO+ffvSu3dvAGbOnMlpp53GuHHjGD16dKs1y6uuuorLLruMwsJCRo8ezfjx4wEYNWoUY8aMYfjw4Rx00EFMnDhxz2OuuOIKpk6dSu/evXnttdf2HB87diyXXnrpnntcfvnljBkzpsVm7uZEezvNDr/N5ZzPirn4ng944qqjOHxgl4jcU0Qklmiby/iibS4bqO+jVtO3iIjEnw4f1PV91Gr6FhGR+NPhgzorCOpS1ahFRCQOdfigzgyavlWjFpGOLBbHG0lj+/N76vBBnZ3ua9TqoxaRjiojI4MtW7YorGOcc44tW7bs82plHX56VnpKEkmmGrWIdFz9+vWjqKiI4uLiaBdFWpGRkUG/fv326TEdPqjNjKy0FNWoRaTDSk1NZdCgQdEuhhwgHb7pG7SDloiIxK+ECOqsYActERGReJMYQZ2WorW+RUQkLiVEUGemqelbRETiU0IEtZq+RUQkXiVEUGemJVOuUd8iIhKHEiKos1WjFhGROJUQQZ2ZlqIatYiIxKWECOqs9GTKKqu1vJ6IiMSdhAjqzLQUah3sqqqNdlFERET2SUIEdVawg5b6qUVEJN4kRlAHe1Krn1pEROJNggS1f5mqUYuISLzp8LtnMauQUV0nAGdodTIREYk7Hb9GbUmkuwoAyrTet4iIxJmOH9RpWaTW+qAuV41aRETiTGIEdc0uQDVqERGJPx0/qFMzSa4uB1AftYiIxJ2OH9RpWfVBrVHfIiISZ1od9W1m9wBfBjY550Y0cf5qYGbI/YYC3Z1zW81sFbATqAGqnXPjIlXwsKVmYlXlJJnmUYuISPwJp0Z9H3BKcyedc//nnBvtnBsN/AR4wzm3NeSSKcH59g9pgDQf1NqTWkRE4lGrQe2cmwNsbe26wAzg4TaVKNLSsqGynCztoCUiInEoYn3UZpaJr3k/EXLYAS+a2TwzuyJSz7VPUjOhqpysNKNUNWoREYkzkVyZ7DTg7QbN3hOdc+vMrAfwkpl9EtTQGwmC/AqAAQMGRK5UaZmAIz+tVvOoRUQk7kRy1Pd0GjR7O+fWBV83AU8B45t7sHPuLufcOOfcuO7du0euVKlZAOSnVGketYiIxJ2IBLWZ5QKTgH+FHMsys8513wMnAYsi8Xz7JC0TgC6pVZSr6VtEROJMONOzHgYmA93MrAi4AUgFcM7dGVx2FvCic64s5KE9gafMrO55HnLOPR+5oocpzdeoc1OrKNuuGrWIiMSXVoPaOTcjjGvuw0/jCj32OTBqfwsWMUHTd25ypVYmExGRuJMAK5P5pu+cpErK1UctIiJxpuMHdaoP6s7JlZRVVuOci3KBREREwtfxgzroo85OqsQ5qKhSrVpEROJHwgR1lu0GoEyrk4mISBzp+EEdNH1n4oNaU7RERCSedPygDmrUndgFqEYtIiLxpeMHdXIaWDIZQVCrRi0iIvGk4we1GaRlkV7rg7pUc6lFRCSOdPygBkjNJN3V1ajV9C0iIvEjMYI6LYvU2ro+atWoRUQkfiRIUGeSWl0OqEYtIiLxJTGCOjWL5JoKQH3UIiISXxIjqNMySaouJznJNOpbRETiSmIEdWomVllOZlqy5lGLiEhcSYygTsuGqjKy0lJUoxYRkbiSIEGdCZVlZKWrRi0iIvElMYI6NRMqy8lKT6FMNWoREYkjiRHUaVlQXUFWqlGuGrWIiMSRxAjqYAet/NQa1ahFRCSuJEZQBzto5aVWacETERGJKwkV1PkplVrwRERE4kpKtAvQLoKm75zkKsp3W5QLIyIiEr6EqlHnJO+mvKqG2loX5QKJiIiEJzGCOqhRZydV4RzsqlY/tYiIxIfECOqgRp2dtBvQxhwiIhI/EiuozQe15lKLiEi8SIygDpq+O+GDWnOpRUQkXiRGUKfVBfUuAM2lFhGRuJEYQZ3qm74zXFCjVh+1iIjEicQI6pQ0SEolI6hRawctERGJF4kR1ABpmaTVVADqoxYRkfiROEGdmkVarQ/qcjV9i4hInEicoE7LJGVPjVpN3yIiEh8SJ6hTM0mqriA5yTSYTERE4kbiBHVaNlZVTlZasqZniYhI3EigoM6EyjKy0lNUoxYRkbiROEGd6oM6UzVqERGJI4kT1GlZUFVOdnoKO1WjFhGROJE4QR3UqHM6pbK9oirapREREQlL4gR1WiZUlZOfmUZJeWW0SyMiIhKWBArqbKjeRX6nJLaVKahFRCQ+JE5QB1tddk+vYceuampqXZQLJCIi0rrECepgq8tu6X4gmfqpRUQkHiROUAdbXXZJ9QG9Tf3UIiISBxInqIMadV6qr1GXlKtGLSIisS+BgtrXqPNSfEBr5LeIiMSDVoPazO4xs01mtqiZ85PNbLuZfRz8+3nIuVPM7FMzW25m10ay4PssaPrOSdoNqEYtIiLxIZwa9X3AKa1c86ZzbnTw75cAZpYM3A5MBYYBM8xsWFsK2yZB03fnJPVRi4hI/Gg1qJ1zc4Ct+3Hv8cBy59znzrlK4BHgjP24T2QENepO7CLJVKMWEZH4EKk+6qPMbL6Z/cfMhgfH+gJrQ64pCo41ycyuMLO5Zja3uLg4QsUKEdSok6rLye2USkmFatQiIhL7IhHUHwEDnXOjgD8CTwfHrYlrm11lxDl3l3NunHNuXPfu3SNQrAaCwWRU+mVEt6lGLSIicaDNQe2c2+GcKw2+nw2kmlk3fA26f8il/YB1bX2+/ZZaF9Rl5GamatS3iIjEhTYHtZn1MjMLvh8f3HML8CFwqJkNMrM0YDrwTFufb78lp0ByGlSVBRtzqEYtIiKxL6W1C8zsYWAy0M3MioAbgFQA59ydwLnAVWZWDVQA051zDqg2s28DLwDJwD3OucUH5FWEKzUTKsvJy0zl0w07o1oUERGRcLQa1M65Ga2c/xPwp2bOzQZm71/RDoC0LKgqJ69TmqZniYhIXEiclcnAB3VlGfmZqZRX1rC7uibaJRIREWlRYgV1aiZUlpGXlQbAdvVTi4hIjEusoN7T9J0KoClaIiIS8xIrqIMadX6mr1FripaIiMS6xArqtExfo85UjVpEROJDggV19p7pWQDbtYyoiIjEuMQK6tRMqCzd0/StGrWIiMS6xArqoOk7My2ZtOQkzaUWEZGYl1hBnZoFNZVYbQ25mamaniUiIjEvsYI62OrSr/edqhq1iIjEvAQL6vqtLv0yoqpRi4hIbEusoA7Z6jJPTd8iIhIHEiuo92r61sYcIiIS+xIrqFODoA7mUpeUV+F35BQREYlNiRXUdX3UVWXkZaZRWVNLRZV20BIRkdiVWEEdUqPO1zKiIiISBxIrqNP2HkwGsK1M/dQiIhK7EjOog6ZvgO0VqlGLiEjsSqyg3qvpu269b9WoRUQkdiVWUO+pUdfvoFWiPmoREYlhiRXUScmQnL5XH3WJatQiIhLDEiuowdeqK8tIT0kmMy1Zo75FRCSmJWZQV5UDkNcpVU3fIiIS0xIvqFMzobIMgLzMNDV9i4hITEu8oE7Pht07AcjP0laXIiIS2xIvqLN6QFkxAHmd0ijRPGoREYlhiRfUnXvBzvUAezbmEBERiVUJGNS9oXwLVFcGQV1Jba120BIRkdiUgEHd038t3Uh+Zhq1Dnburo5umURERJqRgEHd23/duWHPet8a+S0iIrEqAYO6l/+6cz15nbTVpYiIxLYEDOqgRl26kfwsLSMqIiKxLfGCOrMbWLKvUe9p+laNWkREYlPiBXVSEmT39H3UnVSjFhGR2JZ4QQ3BXOoN5KqPWkREYlyCBnVv2LmBlOQkcjJSVKMWEZGYlaBB3TNkdTItIyoiIrErQYO6N1Rsherd5GemqulbRERiVoIGdTCXunSjtroUEZGYlphBnV236MkGumWnU7xzd3TLIyIi0ozEDOqQ1cl65aazaedubcwhIiIxKUGDum697430zMmgptaxuUy1ahERiT2JGdSZXSEpBXaup2dOBgAbtyuoRUQk9iRmUIesTrYnqHfsinKhREREGkvMoIZgdbL19AqCeoOCWkREYlCrQW1m95jZJjNb1Mz5mWa2IPj3jpmNCjm3yswWmtnHZjY3kgVvs869oXQj3bLTSDLYpKAWEZEYFE6N+j7glBbOrwQmOecKgZuAuxqcn+KcG+2cG7d/RTxAghp1SnIS3bLTVaMWEZGYlNLaBc65OWZW0ML5d0J+fA/o1/ZitYPsXlCxDap20TMng407NJhMRERiT6T7qL8G/CfkZwe8aGbzzOyKlh5oZleY2Vwzm1tcXBzhYjUhZHUyH9SqUYuISOyJWFCb2RR8UF8Tcniic24sMBX4lpkd29zjnXN3OefGOefGde/ePVLFat6eudQb6JmTrqAWEZGYFJGgNrNC4K/AGc65LXXHnXPrgq+bgKeA8ZF4vogIXZ0sJ4Nt5VXsqqqJbplEREQaaHNQm9kA4EngIufcZyHHs8ysc933wElAkyPHo6Jz/XrfdXOptea3iIjEmlYHk5nZw8BkoJuZFQE3AKkAzrk7gZ8DXYE7zAygOhjh3RN4KjiWAjzknHv+ALyG/dOpCySlQukGeg6on0vdv0tmlAsmIiJSL5xR3zNaOX85cHkTxz8HRjV+RIxISgqmaPk+atDqZCIiEnsSd2UyaLw62XYFtYiIxJbEDursnrBzI7mdUklLSVKNWkREYk5iB3Xn3rBzPWZGLy16IiIiMSjBg7oX7CqBqgp65WRoGVEREYk5CR7U9Yue9MhJ18YcIiIScxI8qHv6r6Ub99SonXPRLZOIiEiIBA/quhr1enrmZLCrqpYdu6qjWyYREZEQCmrwc6lz/RQtjfwWEZFYkthB3SkfktN8UHfWoiciIhJ7Ejuozfy+1Ds30CtXi56IiEjsSeyghj2rk9VtzLFJG3OIiEgMUQX38W0AACAASURBVFDn9IYdX5CRmkxup1TVqEVEJKYoqPMGQskaqK2lZ066+qhFRCSmKKjzC6Cm0m93mZOhoBYRkZiioM4v8F+3raKnlhEVEZEYo6AOCepeORkU79xNTa1WJxMRkdigoM7tD5YU1KjTqXWwuVQjv0VEJDYoqFPSIKffnqZv0KInIiISOxTUAPkD9wpqTdESEZFYoaCGPUFdtzrZRi16IiIiMUJBDX5AWelGuqXXkGSwUTVqERGJEQpqgPxBACRvX0v3zlr0REREYoeCGhpN0dJcahERiRUKatgrqHvkZLBph/qoRUQkNiioATK7QmoWbFtF79wM1m2vwDkteiIiItGnoAa/L3V+AWxbRf/8THbuqmZ7RVW0SyUiIqKg3iMI6gFdMwFYvaU8uuURERFBQV0vvwBKVjOwSycAVm9VUIuISPQpqOvkF0BVOf3TywBYq6AWEZEYoKCuE4z8ziorolt2Oqu3lEW3PCIiIiio6+UP9F+3rWJg10z1UYuISExQUNfJG+C/blvFwC6ZavoWEZGYoKCuk9oJOvf2U7S6ZLJ+xy52V9dEu1QiIpLgFNShgilaA7tm4hys3VoR7RKJiEiCU1CHyi+AbasZGMylVvO3iIhEm4I6VH4B7PiC/jnJABr5LSIiUaegDpU3EHB0r9lEZlqyFj0REZGoU1CHCuZS27bVDNDIbxERiQEK6lB7trtcSf8umkstIiLRp6AOld0TUjL2zKVes7Wc2lptdykiItGjoA6VlOT7qYMpWrurayku3R3tUomISAJTUDcU7KI1oGsWoO0uRUQkuhTUDeUPhK2rGJAfbHepKVoiIhJFCuqG8gugcid903eRZFr0REREoktB3VAw8jtt52r65HXSXGoREYmqsILazO4xs01mtqiZ82Zmt5nZcjNbYGZjQ85dYmbLgn+XRKrgB0xe3XaXfi61+qhFRCSawq1R3wec0sL5qcChwb8rgD8DmFkX4AbgSGA8cIOZ5e9vYdtFg32p1fQtIiLRFFZQO+fmAFtbuOQM4H7nvQfkmVlv4GTgJefcVufcNuAlWg786EvvDJndYNsqBnTJYktZJaW7q6NdKhERSVCR6qPuC6wN+bkoONbc8UbM7Aozm2tmc4uLiyNUrP2UP9BP0erid9HSyG8REYmWSAW1NXHMtXC88UHn7nLOjXPOjevevXuEirWfQvalBo38FhGR6IlUUBcB/UN+7gesa+F4bMsvgJK1DMhPA7ToiYiIRE+kgvoZ4OJg9PcEYLtzbj3wAnCSmeUHg8hOCo7FtryB4GrI2b2JvMxU1qhGLSIiUZISzkVm9jAwGehmZkX4kdypAM65O4HZwKnAcqAcuCw4t9XMbgI+DG71S+dcS4PSYsOeXbTqN+cQERGJhrCC2jk3o5XzDvhWM+fuAe7Z96JFUUhQD+hayPy1JVEtjoiIJC6tTNaUnL5gyVCymoFdMvmipILK6tpol0pERBKQgropySmQ1x+2rWJwr87U1DqWbyqNdqlERCQBKaibE0zRGt4nB4DF67ZHtzwiIpKQFNTNyRsI21ZT0DWLTqnJLFm/I9olEhGRBKSgbk5+AZRvJrmqjCG9O7N4nYJaRETan4K6OXUjv0tWM7xPDkvX7cAPbhcREWk/CurmhOyiNax3Ljt3V1O0rSK6ZRIRkYSjoG5O/iD/VQPKREQkihTUzemUD+k5sG01h/XqTJLBEvVTi4hIO1NQN8csGPm9iozUZA7unq0BZSIi0u4U1C3J90ENMLxPjqZoiYhIu1NQtyS/AEpWg3MM65PD+u272FpWGe1SiYhIAlFQtyS/AKp3QelGhvfJBdRPLSIi7UtB3ZKQXbSG9tbIbxERaX8K6pbk1c2lXk2XrDR652aon1pERNqVgroleQP815ABZRr5LSIi7UlB3ZLUDOjcZ09QD+udw+fFpVRU1kS3XCIikjAU1K3JH+hHfgPD+uRS6+DTjTujXCgREUkUCurWBPtSA80vJbpbwS0iIgeGgro1XQ6GHeugdBP98jvROSNl7ylay1+GmwfC5uXRK6OIiHRYCurWDD0NcLDgUcyMYb0bDCj74K/gaqB4adSKKCIiHZeCujU9hkC/I+CjB/asUPbJhh3U1DrYsR6WveCv2/5FdMspIiIdkoI6HGMugs2fQtFcRvTJZVdVLcs3lcL8h8DVgiXDjqJol1JERDogBXU4RpwNqZnw3/sZPSAPgI/XbPG17IJj/Hxr1ahFROQAUFCHI70zDD8LFj3JoM6O3E6pbF/6Omxb6Wvbuf38gDMREZEIU1CHa8xFUFlK0tJnGDMgj0OKnoT0XBh2OuT0hR2qUYuISOQpqMM1YAJ0PQT++wATeiczsfIdKoefA6mdIKePr1HXasUyERGJLAV1uMxgzIWw5l1O23ov6VbF4p5n+nO5ff0UrdKN0S2jiIh0OArqfTHqArBk+n72AAtrC3irtI8/ntPPf9WAMhERiTAF9b7o3BMGnwzAa5mn8NGabf54bl//VVO0REQkwlKiXYC4M/F7ULGNzVmn8d9PS3DOYTl1Qa2R3yIiElmqUe+rARPgq88zdNAASsqrWLWlHDrl+3nWavoWEZEIU1Dvp7ED8gH475ptfqBZTh81fYuISMQpqPfTIT2yyU5P4b9rSvyBnL6qUYuISMQpqPdTcpIxqn9uyICyflr0REREIk5B3QZj+ufzyYadlFdW+xr1zg1QUxXtYomISAeioG6DsQPzqKl1LCzaHkzRcj6sRUREIkRB3Qaj+wcDytaW1C96ouZvERGJIAV1G3TJSqOga6Yf+Z0TrFK2XSO/RUQkchTUbTR2QD4frSnB1QW1atQiIhJBCuo2GjMgj+KduymqSIO0zpqiJSIiEaWgbqPxg7oC8PbyzX5AmWrUIiISQQrqNhrcM5s+uRm89ukmP0VLQS0iIhGkoG4jM2PykB68tWwzNZ21OpmIiESWgjoCphzWg7LKGr6ozYeyTVC9O9pFEhGRDiKsoDazU8zsUzNbbmbXNnH+92b2cfDvMzMrCTlXE3LumUgWPlZ86eCupCUnsWBHlj+g7S5FRCRCWt2P2sySgduBE4Ei4EMze8Y5t6TuGufcD0Ku/w4wJuQWFc650ZErcuzJSk/hyIO6MGdTOl8GH9RdBkW7WCIi0gGEU6MeDyx3zn3unKsEHgHOaOH6GcDDkShcPJl8WA/mbcv0P2hAmYiIREg4Qd0XWBvyc1FwrBEzGwgMAl4NOZxhZnPN7D0zO7O5JzGzK4Lr5hYXF4dRrNgy5bDurHN+qpZWJxMRkUgJJ6itiWOumWunA48752pCjg1wzo0DLgBmmdnBTT3QOXeXc26cc25c9+7dwyhWbBnULYseXbtQmtRZNWoREYmYcIK6COgf8nM/oLnRUtNp0OztnFsXfP0ceJ29+687DDNjymE9+KImn5oS1ahFRCQywgnqD4FDzWyQmaXhw7jR6G0zOwzIB94NOZZvZunB992AicCSho/tKCYf1p0vartQXrw62kUREZEOotWgds5VA98GXgCWAo855xab2S/N7PSQS2cAjzjnQpvFhwJzzWw+8Bpwc+ho8Y5mwkFd2WTdSCpdH+2iiIhIB9Hq9CwA59xsYHaDYz9v8PONTTzuHWBkG8oXVzJSk0nr0p+skpdxleVYWma0iyQiInFOK5NFWI9+fqzc2tXLo1wSERHpCBTUETb40CEALFzcYVv4RUSkHSmoI6xHwVAA1q+YH+WSiIhIR6CgjrScvlSk5JJdspTNpdqcQ0RE2kZBHWlm1PQYwVBbzatLN0W7NCIiEucU1AdA1sAxDElayyuLtUKZiIi0jYL6ALDeo0inii+WL6C8sjraxRERkTimoD4Qevmp44fUrmTOZ5ujXBgREYlnCuoDoeuhuJQMxqat4aUlG6NdGhERiaQd68A1tzdV5CmoD4TkFKzHMCZkruOVTzZSXVMb7RKJiEgk7N4JvxsKb89qt6dUUB8ovUZSUL2CkvJKPly1LdqlERGRSNj8mf/a9dB2e0oF9YHSayRpldsZmLJNzd8iIh1FcRDU3Q9rt6dUUB8ovUcBcE6frby4ZAOuHfszRETkANn8GSSlQH5Buz2lgvpA6TEMMKbkbqBoWwVL1++MdolERKStNn8GXQ6G5NR2e0oF9YGSng1dD2awW0lykvHM/HXRLpGIiLRV8afQfXC7PqWC+kDqVUj65sUcP6QHj89bS2W1Rn+LiMStmirYthK6Kag7jl4joWQNF4/JY3NpJS8u2RDtEomISFPKt8LKOfDu7fDi9VBZ1viarZ9DbTV0a7+BZAAp7fpsiaZ3IQBHZa2jb14nHnp/DV8u7BPlQomIyB4bFsKjF/macqg+Y2DE2XsfK/7Uf+3WflOzQDXqA6uXD+rkjYuYMb4/76zYwsrNTXxKExGRyPhkNrw1K/yVw976PVRshRN+ARc+CT9YAikZUPRh42vr5lCr6bsDye4B2T1hw0LOH9eflCTj4Q/WRLtUIiId15u3wss3wHt3tH5t+VZY+iwUToejvw+HHA+5fX1teu0Hja/f/Bnk9PODhduRgvpA61UIGxbQIyeDE4b25PF5Reyurol2qUQk1pRvhRJ9kG+TynJYPx/SsuGFn8Kn/2n5+gWPQU0ljL147+P9jvD3qdq19/HNn7V7szcoqA+8XiOh+BOo3s0FRw5ga1klLyzWSmUi0sC/vg1/OwlqtDXuflv3kR/sdcaf/Bihx7/m+6Cb4hx8dL+vPfcasfe5/uOhtsqHdej1m5e164pkdRTUB1qvkf4/nPULOLqgMwPz03jovVXRLpWIxJJdO2D5S7BzPax4NdqliV9r3vVfB02CGY9ARg48NB12NlE5WvcRbFrcuDYN0G+8/1oU0vy94wuoLG33/mlQUB94wVKi/O0Ekn7TkzcqzuUf66ax+eXfR7dcIhI7lr3om2CTUmD+w9EuTfxa8z50HwqZXSCnjw/riq3w8PTG060+uh9SOsGIcxrfp3NPyBsIa9+vPxalgWSgoD7wuh4MZ98NJ9wIx11P2Zeu4UM3hLy3fwUbFkW7dCISC5Y+6weeHn4pfPIcVJREu0Txp7bWDwAbcGT9sT6j4Zy/wvqP4bFL/IIl4EN74RMw/CzIyG36fv3Hw9oP60ePR2EzjjoK6vZQeD4c/QM49sdknXQdr468hZLaTCqfuLL+PxwRSUxVFbDsJRgyDUZfADW7YcnT0S5V/CleCru3Q/8Jex8fMg2m/c53LTzzHR+8i5+Gyp0w9qLm79dvPJRugO1r/c+bP4WMPMjqfuBeQzO04EkUfO2kI7hxweX8qfh3fr7fpKujXSQRiZYVr0FVGQw9DfqM9U2r8x/xteuGqishJa3di7hfamth+cu+n/foH0JaZtPX1VT5Fb+KP4FNn/hALCuG8m1QsQ12bYfjfw5HXtHy8615z38dMKHxuXGX+Xu+9ms/bXbN+9D1EBhwVPP363+E/7r2A8gb4AeSdRsMZq2/9ghTUEdBr9wMeh15Hs++/y5ffuN/sSGnQs/h0S6WiETD0md9Ta3gGB8Co6bDK7/04dXloPrrXvklvP0HOPg4GHEuDDkV0jtHr9zN2bXD97O//xfYusIf27ICzr2nccitfsf3H+/aHhwwH4qde0Nefz9yu2iuf91HfA2Skpt/3rXv++6D5rafPPZqKN3o7wV+gZOWQrfnCN+HXfQhjDzXr0o2+KRw3oGIU1BHyVWTD+b0D77KJPuEnKevgstfaddt00TiWm0NWFJUajcRVVMFn86Gw06t//+/8Cvwyk0w/1GY8hN/7OOH4M3fwsCjYdNSeOoKv3rW8LPhtFmQkh6Z8mxb7cM/s8v+Pf6/D8J/rvHNyv2OgCnX+aU5X/2V3/o3tPVw3X/hwfMhpzdMvQW6D/E11oY178VPwz8v8bXzwSc3/9xr3oX+Rzb/34SZf56yzf5eo2a0/FqSU6HvWF+jrtgGZZvafY3vOuqjjpKu2emcffQorq64xM/Ve2tWtIskEh9qquGPh8OLP4vcPcs2w6Inwl92MlJWvQm7Snyzd53cfjDoWF8rdc436T77PX/s4qfhewvgqy/60crzH4rMdK7KcnjpBvjjWLj9SN8cvy+c80tx/uubfgDX5a/C5S/7mugxP/YfPl77lW89AN/E/cDZ0CkfLnratyL0Gd108/iQaZDVA+be2/zz71jvF4tpqSkbfI38vPvg+wv9yO7W9DsCNiyA9Qv8z1EY8Q0K6qi6/JiDeDftS7yXNQXeuHnvyfUi0rTlL/la2nt/9n/wI2HOrfD4V1tfyaotKrY1niK09FlIzYKDp+x9fNQMKFntV856ZKYP7/P+7mt5SUl+ZPOXZ0FaZ/jshbaV67MX4Y4j4e1Zvkk9sws8cJavBYez+Eptrf/Q9PKN/vEXPgn9Dq8/bwan3QZ9D4cnv+FHtT9wpn8tFz/tl+xsSXIqjLkQlr0A24uavmZtXf/0kU2fD2UWfotB/yP9OhgLH/M/t/M+1HUU1FGU2ymVb0w6mG9smUFlRld48orGS9aJJBrnfGBWljd9/r//gMxufpnIcGvVc++F2c0M2qytgcVP+u9fuA6qd+97mVtTvhXu+BLcNtYHVd3zLv03HHoipHba+/qhp/kAf+oK3zx+wWONwyUlDQ6e7Odg709LgHPw9LfgofN8X+yls+Hsv8DXX/Wjz+f8H9x/Oqx6G1a95Wvunz7vg331O37Fr60r4emr4N0/wfhv+KmoTQ12S82A6Q/5BUgeucCPdL/oKT99NRyHXxKsJPZA0+fXvAepmXs2QoqYfsGAskVPQXK6n1sdBQrqKLtsYgGp2V35Teq3/ajHV2+KdpFEomvVm36A0eu/aXyutBg+ex5Gz/D9nctfgmUvt3y/qgo/EOuDu5quga96yw8yOvzSoKYexmYO+8I533RdVuybeh+5AP55qQ/ssk17N3vXSc+G4WeCJcP59zW/vvShJ/sVszYu3vdyrXoLPv4HHHkVXPkWFEz0x9Oy4Mw74Mw7fT/yfafCfdN8Lfvhr/hgv3cq3Hk03DYaFjwCU34GU//X1/ab07kXzHgYBk70te59GUCbX+AH0X10f9O1/DXv+Rp7pMf5ZHeH/EF+VH7XQ1oezHYAaTBZlGWmpXDdqUP44WO7mTH4Kxz27u0w+BQYdEy0iyYSHR/d779+8Ff40nf9dJo6Cx/zTZGjL/QjoufeAy/+FA6aDMnN/Dlb9IRfnQpg3n0w9eYG5x/3tfNTbvYfBObc6pueO/eKzOtZ8CgsfcYvenTUt30T8xu3wOKnIDmt+QFSp/6ff/09hjR/70NP9F+XvdB4verdO+G5H8ExP2p6kY63fu/7fk+4sela8OgZ/u/QpqW+nCnpPgid8/eu+5fb17//4egzBi6bHd61DY27DB690LcgDDm1/vjuUl+7P+aH+3ff1vQf7z/ARanZG1SjjglnjenLUQd15aI106jOH+SbknbtiHaxJFGteM2P/o2G8q2w5Bk45ES/pGboIEvnfLN333E+vFLS4MSbfEvUvGYGGjnnpwn1GOZHSM9/yNew61Tv9s83ZJpvfj7pJv+8L/9i7/usfsd3TT33Y1+mhY9D0bzWm5xL1vgm9wFf8qGbnOqnCV35lh8cNvbi5qdYpWW1HNLgP0z0HuWboxua93f/IeGZ7/h+5FDr58OKV2DCVb5Zujm5/fyHgYMm+fnJfQ+HfuN8n/qw02HMzPBDuq0GnwLZvRr/rr+YC66m8UInkVLX/B2lgWSgoI4JZsavzhpBSVUaf8z5kW/KevRCbXkn7W/3TnjofHj+2ug8/8J/+pW5jv+5Hyk892+wc4M/t+6/sGmJD4c6Q6b5+cev/cYP1mpozXt+1O74K2DcV/183cVP1Z9f/oofdT3iXP9z14Nhwjd9oBfN8/N/H73QN/V+9oKv0b98AzzxNfjrcfD0N31fc1Nqa+CpK32Yn3Xn3s2m3Q+DS56Fab9t2/sFvvm76AP/IadOTRW8f6dval/7Pnz84N6PeWsWpOf4ucnxIjnVryS27KW9/zaueR+w+gVKIq3gaH//3qMPzP3DoKCOEQd3z+bKSQfxh0/zWT7+V36S/e1Hwtu3aZlRaT+fv+5rlMteav/1pp3ztcDeo/1CF5Ou9v/t19Wq//sPP3c4dBMFMzg5COmXbmhcw/3gL34t58Lz/R/crof65vI6ix6HTl32HnV97I/9whmPXuj/H1z+qu+D/eFSuHYN/KQIvvm+b1Ke/5DfnrKpsH77D7D6bTj1Fsg/gIOQBp8MrtZ/6Kiz5F9+6csz7vA1zZdvqA/yLSv8EqXjvtr8Otexqm6nq3tOgVmFcMtB8Mb/+haTA/VaegyF78yDw6YemPuHQUEdQ7455RAGds3k64uHs+sb7/kmpZeuh79Mgi8+inbxJBF89rwfwFRbVT86ub003Hawy0G+r3juPX6VrkWPw9DTG/9B7l0IE78LH/3djz6us2Odb9Yec5FvRjbz4VT0oe/TrCzzo8uHnbH3IKT0znDSr/0As9EXwHf/6z801M3xTe/sm6SP/zlMvq5xWK+f7+cIv/ILX97WFtZoqz5j/Sj4ZcE0Lefgndv8h5LBp/hae0WJH1AH8M4fISnVN3vHm7wBcNxPfXN//yP97+6ob8G0Ww/s83Y9OKqL62gwWQzJSE3ml2eM4JJ7PuDOj3fz/RkP+z+Ws6+GB8+D7833o0Fl/yx83DdzHnF5tEsSm2prfV/nsNP9B8NFT+zdzNycrZ/7cDr4uLbVauq2HRx5bv2xY3/sRxU/eJ5vtm6uPMff6JtDX/yZX35y5Lk+4F3t3r/vUdP9fN+598LAL0FVOYw8r/H9Cs8Lpki10H8LMPka//X13/iWCPAfKDLyfP/5+CsO/B/4pCTfj/zZ8/7Dwup3/O/jy7P8uV4j4Mhv+Hnnh57km8FHz4zcYLn2dmzi7Y2goI4xkwZ358uFvbnj9RWcNaYvA4dM881wfz0e3v9z0/+Rbl7mm72OuLz5ka/iF3DYvhYOOaH59YA7ul3b/Ye/IV/2c1pDrf/YTxcafIqfkvL2H/yKXVndWr7nM9/1U6qS03xYDzvTNxN2ygu/XLtL/QephtsOdhnka7Uf3Q+5A6Dg2KYfn5TkpxOVbvKDMTvl+zA+bKq/R53MLjDibL+QyJZlkNO3+dWsWgvpOqFhndLJb0Ax8Xv79vrb6tCT/EpmRR/6VoXMbv5DyZ4y/gQWPemb83Hwpe+0X9mkzdT0HYN+Nm0YqUnGjc8sxjnnR1keNg3e/uPeA0bAj2B95AJ4/hp4ZIb/gyeNbVvtp1jUVvvpN4mmfKsfcPX7kT7I3vjfxtd89gJgfsT1iHP8SNol/2r5vjvW+fm4o2f62uPGxfD0lfCnI3xohmvJ01BZWt/sHeqYH/u+6cMvaXmebmoGTH/Qf8h48Fwo3+zL1NDhl/m1qFfO8R8MWrpnuCZf45fC/O5/4YQb2jekwX9AsmTfrP3Z8zD+63svopKRAyf/2v9Oh50Z/kIjEhMU1DGoV24GPzhxMK99WsyLSzb6g8f9DHbvqN/5pc6rv4LNn/na9PJX/OIEdaNkpd7KN/zXg6b4msfWldEtT3upqfb/jcwq9OF80LH+j/q8+xoPFlv2gp+KktXVL0bRbbCvhbVk0ZOA87XIk3/t11C+5Flfc//3D8JfMeuj+32falNbFOYP9Pc9+get36dTPlz4uJ8f3GNY01OH+o+HHsFiG6HN7G118BS/wUQ0dMrzLQOf/Nt/qGmqe2fEOX7lsKm3tH/5pE0U1DHqki8VMKRXZ37xzGLKK6uh5zA/cvX9v9QH8aq34d3bYdzX/ICRGY/A5uXw1xMjtwZyrFjzvt+IYX83IPj8dT8H88w7fM3jzQhMi4kFX3zkV7kKnRscasEjfinIg6fAVe/AV/7ht/erLN179PPODX76U93iG2b+D/vqt/2GB81Z+E+/iEW3Q+ofN+hYP+Dnk3/7fu6WVGyDV3/tpxCNvbj5/tzsHuGvCpU3AL75rv/A0NT9zPxAsDEXRXXKTcTVLX4yakbT3RVm/m9Idvf2LZe0mYI6RqUmJ3HTmSNYt30Xf3x1uT84+Vo/GnfOrb6J++mrfG3jxGA05+CT4LLn/DzUe06O3qIVkbbiVb+I/5bl8O5+LO9YWwufv+EXbcjp45eK/Pih6Neqt66Eu4+D/7QwZ/mDu+GpFkbnfnCXnxf88UONzzkH793pa5bn31+/ZGPvQl+rfv/O+rXll73kv4aukjX8bMD5ZummbF7m+7WbGox11Lf9wiSzr266Cbx8a31Nf84tfuDW4Zc2/zr3VWaXlvvWDzsFzvhT/G+TGWrkuX5O+dHfj3ZJJMIU1DHsiIIunDO2H39983OWbyr101XGXuybLZ/6hh/leuade48E7zMGvvq874t99nvtv21fpC19Fh76Sv1rX/EK7Ny4b/fYtMT3Vw6a5H8++geQlAJvtqGv2jlY+6FfCnLPpvf7YOUcuHsKfDHPL+pRtqXxNdW74fX/8dN/tn7e+HxNVf1uT+/c1ngN5NVvw8aFcOSVjQNp4vf89KMFj/qfP3veD6zqGbIMZffB0Gtk87Xihf8ELAj0BpKSfetFZdneTeClm/x851mF9TX9K9/yNf2Gg9tk3+T2g0v/nbgDJTuwsILazE4xs0/NbLmZNfr4b2aXmlmxmX0c/Ls85NwlZrYs+HdJJAufCH5y6hA6pSbz06cWUlvr/KjvpGTfrPilb8PAJkasdjkITvwFfP5a/brJzdmx3jefP3CWX4kpVjgH8x+Bxy7xO+Jc+m846jt+us3Cf+7bvfb0TwdBndPbrxv88cNNB2BLyrb4Wv0dR8HfToDXfu0XpQmXc76WfP+ZfjT/9If9tJ6GK0eBH8hVHgT44iZqtavf8dPNCqfDtlWwtMHAr/f+7BfzKDy/8WMHTfJzUd+5zTebr3jNjxxuGOgjzvEjjC2DrgAAIABJREFUibetavw6Fv7TrwXdXL9s98NgynX+v9X3/uxr17NG+uc89ES46l1f0+81sunHiwgQRlCbWTJwOzAVGAbMMLNhTVz6qHNudPDvr8FjuwA3AEcC44EbzCw/YqVPAN2y0/nptKG8v3Irf393lW+6Pe5nvh9wSgtb/B3+Vd8M9uLPYPsXe5+rqfIBft+X4XdD/dZ+K9+E2T+Obg28aK5fheqRmfDbIb7VoGCi37O2U76v4fU93Af4vvj8dT9QKbdf/bGjf+AXufjXd3xXwnt3+vdk7YfN3+ezF4L36yd+AY3TboPBU+HDu8Nfm/2F6/z7fOiJ8LWX/OYCA77k1y9uuB7zh3/zH7r6jqvfhjHUJ8/56UDTfutf31u/r//9bVvlzx9+aeMtFMEH8sTv+e6EF37qdwcafErj6+pqyw0/HK37yH/IaarZO9RR3/a/sxd+4qdLjTwPvj0XzrvXj7sQkVaFU6MeDyx3zn3unKsEHgHOCPP+JwMvOee2Oue2AS8BTfw1kJacP64/xw3pwc3/+YQVxaV+DuQlz7Y8zzMpCU7/Y+Mm8KK5fqWzZ74DO9fDpGv8H84v/97/8V36bPu8qIY+ec7PFX/5Bj/FZ9CxMO13cME/9960YNQM35y7YWF4962p8oPu6mrTdTr38n3+a9/zW4s+f41/T/52ol/NqqFtq/2mDN0H+0FZX3/FTxeadLVv+m5uU4hQ6xf4LRQPv6x+b17wq2Vt/by+5g+wYZEv27iv+lrthoV+oGAd5/x7dvBxvutj4vf8NXWD7T64Gyyp5cVdhp7h99ed+zc/UnhQE3OU8wf6kfKv3+znHtdZ+LifNz309JZfc3IKnHuv/3D5vY99v7CmBonsk3CCui+wNuTnouBYQ+eY2QIze9zM+u/jYzGzK8xsrpnNLS4uDqNYicPMuPnskXRKS+aHj82nuqa29QeBX+jhhBv9nr0f/hVm/z/46wl+pO30h3xAT/mJ3+t21Aw/HefVm5re7zVUTbUfABW6s1FbffQAdO4DP17u/6Cfc7ffMKDhh5ER5/jlD5uqVW9Z0bi/uGiury0eNLnx9Uf/AK7fDD/bBP9vpV/5rd84H8ih3QDVu/3Iale796As8LXFQZN890HdwKzmvP0Hv53iCTfsPYJ52OmQ2XXvUdh14Tl6pl8mEWBJyGYS6z+GHUV+Uwrwzdude/stFHeX+vdz2Bl+C8LmJKfUL3wx6Nj6JTIbOv/vfurPk1/3r7O2xvdbH3pSePOF8wf6LpvQFg0RCVs4Qd3UsMiG7aPPAgXOuULgZeDv+/BYf9C5u5xz45xz47p31/SBhnrkZHDTGSOYv7aEO99YEf4Dj/i6b1qd/WM/Qnj81+Fb7/s/8KH9kckpcNz1fk72ghaalmuq4cnL/SppL9/Q8vSb3Tv9aOKXfu5HN9812YdeQ2Vb/IeJkee2PnUks4sfmbzgsb0/UHz+OtwxwW9wX1lef3zlG75mWXB00/cz8/vsZnbxg3CmP+zL8PD0+h16Xrzetzaccbtvim7omB/6gVnzH26+3NtW+ebrwy/1zfihUtJ9IH/ynB8zsGuHf33Dz/blyg1Wz1oUEtSfPOdfV91GASnpfs3jlXN8X/Du7eGt5Tx6JvQb3/RCI3UycmFmsM72C9f596Z0Y+vN3iISEeEEdRHQP+TnfsC60Aucc1ucc3V/ge8GDg/3sRK+00b1YVphb/7wyjIWrwtzpHFSkh99W/gV3yd66v81P7p26Gl+gf//396dx9dVFvgf/zx3y81+szZtuoaWpgulKxQoq6UsQqEKAoojoi9FcNBRx8GZl79R1JFxGUFBBIUBlxFlR1FAllJAKN2gC93TNUmbNPt6c5fn98dzW9M2bdM27b1Jvu/XK6/mnHty7pPDCd/7rOe17/dcO4xF3OP91jwNH/pPtyj+s1+E3R/sf1w07Jrb7xrlVoh6++fuZ6tWuCbTA615yjXR9zToqSen3+CWuqx4zW1XLnf92tklrsn4T7f/o6m/YqGbK3tgOB5KVpFrbo+G4Xcfc09zevcBmH2bq/n2ZMz57rq9dc+hWyP+fq+bv33WbT2/PuMmt2rUit+6kdhdrfs/gnDSAvfAitr1bnvtn2HUOS7Iu58jmOtGiZfO+MdzdA8nkAGf/Zv7b384/iBc+4hrit/4EgSy95/KJSInTG+CegkwzhgzxhgTAK4H9uvEM8Z0H/Y5H1ib+P5FYJ4xJi8xiGxeYp8co+9eNZlQRoAvPfYeTe29fPxl/hj4yINHfl6rMa6pvHmna3rtLhaBJ252c2rnfc/VIq991PUf/+HGfzQ5t+xytdplj7iR1f/0rHs04OcXudWg3r7v4AFrqx53c327Tw06nHHzXPC+/3uo3eA+DGTkw80vub7QVY+79wm3uhHLZRf07rx7FZfDdb92a0H/6XYXeHO/dejjjXHN6A1bep5z3LbHBfCU69xgwJ4UnOL6gpc94gaRDT3dhe1eE+YDxn1IqtsMtWv/0ey9V1q2a0EBOPMLfT9H2ON14wYu/xFcdlfPg9REpM8d8QkO1tqoMeaLuID1Ag9ba9cYY+4EllprnwNuN8bMB6JAPXBT4mfrjTHfwYU9wJ3W2vqD3kR6LS8zwD3XT+Wmh5dw86NL+O1nziQ90MsVm3qj7HwXGIt+5GqJDVtcc/jWN13oXfJ9OOtWd2zOUFfLevRKePoW93zevaF97aMw6er9z33WbfDsra4mfMpFbl/9Frcq1dxv9T5YfAGYfA2s+I1bscx43DrLOUNdGarfc48Hbal2NfUDB5L16jpcAPPvdU381z7i3vNwyq9wffxv3u360bv/Lu8+CNEO9yjGw5l5M/zxk+77K3+6/zlyhroa9JqnwZ/oSx5/+cHnmPMvbmWuSQuO8AseI2Nc94mInDTGpuCCGDNnzrRLly5NdjFS2l9WVfPF/1vOeacW8eAnZxLw9eHaNZXL3WIce3l8kH+K6/Oc+emDj3/nF27UNAZCI1w/b0kPteNoGH4y2a2MdWOib/v1H7i5yF9e7X6212Vc5vq903LgpufdOfcKt7hBc7Xr3ICsf9vW+ychHY8Vv3MfRGbf6h4kkVngFvz4ySQ3TuCGHlYP6y4Wcdcn0gFfXeumgHX37i/dWIOcUjf47JY3TtzvIiInlTFmmbV2Zk+v6ZmI/dTlpw3lewtO4xtPreJrj7/P3ddNxePpo6bO0ulu8FCsy9US80a7OceHcubnoX6zm689/2cuoHriS3NPM3rtu1CzForK3aCpUXOOLqTB1fbnftvNFe8e0uCagK//P3jwQhg+4+SENLg+9q1vuMU9lj3qap6+oBtl35tlHb1+WPAL94HmwJAGN4r7r1+H5kqYrrWDRAYL1aj7ufsXbua/X1jHJ2eP4s6rJmFSfe3itjpXw5xyrZtP/MsLXTPvjBMQPHWbXTPxyX6iUe1611Kw+knAutr0zX/tm3M/eqUb2X3LWz23WohIv6Qa9QB2y/llNLZ38cCiCoJ+D/9++YTUDuvMAph6g2sm7mp3i2ZM7O36OUcpWQtrFI2Hax6C87/uBoZN+0Tfnfvcr7pVyLrP5RaRAU1B3c8ZY7jjsnI6IzF++cYWfF4PX79kfGqH9exb3eIeq59w04J6s2hGf1Q0Hi7v42f/ll1w9KPYRaRfU1APAMYYvjV/EpG45f6Fm/F7PXzl4lOTXaxDKxzn1pXe8IKbsiQiIoekoB4gjDF896rJxGKWn76yEb/H8M8fGpfsYh3ah/4fZBS6OdEiInJICuoBxOMxfP8jpxGJx/nx3zYApG5YD5kEV9+X7FKIiKQ8BfUA4/EYfnjN6QD8+G8biMYtX547LrX7rEVE5JAU1AOQNxHWPo/hnlc2EotbvjrvVIW1iEg/pKAeoLwew10fmYLXY7j3tU1E45Z/uzTFR4OLiMhBFNQDmMdj+N7Vp+H1GH7x+mYsljsuLVdYi4j0IwrqAc7jMXznKreC1QOvV2AwqlmLiPQjCupBwBjDnfMnYy384vXNeAz8a6oviiIiIoCCetDYW7O2wM8XbsYY+No8hbWISKpTUA8iHo9bFMVay32vbaa2JcydV00m6O/D51mLiEifUlAPMnsHmBVmpfGzVzexflcL9984g2Gh9GQXTUREeuBJdgHk5PN4DF+dN54HPjmDzbVtXPmzN3l7c12yiyUiIj1QUA9il0wq4ZnbziGU4efGhxbz4KLNpOLzyUVEBjMF9SA3tjiLZ247h3kTh/Bff1nH53+zjKaOSLKLJSIiCQpqITvo5+efmM43r5jIq+tqmH/vm6ypakp2sUREBAW1JBhj+MycMfzh87MJR+J85Od/54HXNxOOxpJdNBGRQU1BLfuZMSqf52+fw7njCvn+X9cx7yeLeGF1tfquRUSSREEtBynISuNXn5rFr28+gzSfh1t+u5zrH3yHtdXNyS6aiMigo6CWQzrv1CL+cvu5fPfqyWysaWX+vW/y84WbiMVVuxYROVkU1HJYPq+HG2eP4uWvnM/FE4fwgxfW87EH3mZbXVuyiyYiMigoqKVX8jMD3Pfx6dxz/VQ27m7hsnve4L7XNlHT0pnsoomIDGgmFQcJzZw50y5dujTZxZBDqG7q4D+eXs2r62rwegwXji/mulkjuHB8ET6vPvuJiBwtY8wya+3Mnl7TWt9y1IbmpvPwTbPYXNvKH5fu4Mlllby8djfjh2Tz0E0zGZ6XkewiiogMGKpRy3GLxOK8uGYX33hqFWk+Lw99aianjwglu1giIv3G4WrUaqeU4+b3erhiyjCevvVsgn4P1z34Ni+s3pXsYomIDAgKaukzY4uzefrWcygvyeELv1vG3S9v0LrhIiLHSUEtfaooO43HPjebD582lLtf3sjs/3qFO55cyepKrR0uInIs1EctJ8zqyiZ++842nnmvks5InNOH53LV1FI+PGUoQ3KCyS6eiEjKOFwftYJaTrimjghPLNvJk8t28kF1M8bAmWPyuXpqKQuml5Lm8ya7iCIiSaWglpSxqaaVP6+s4rn3q6iobWNobpB/vmgc184cjl9zsEVkkFJQS8qx1vL3zXX8+KX1LN/eyIj8dG6/aBwLppVq0RQRGXQ0PUtSjjGGc8YW8uQXzuZ/b5pFKD3Avz6xkkvveYOX1uzSYzVFRBIU1JJUxhguLC/muS+ew/2fmE48bvncb5ZxzS/eZnFFnQJbRAY9NX1LSonG4vxx6U7ufnkDNS1hirLTmDU6j1mj85k1Op8JQ3Pwekyyiyki0qe01rf0Gz6vh4+fOZIF00p59r1K3qmoY8nWBv6yyq10lhnwMm1kHtNH5TFjVB5nlRUQ8KlhSEQGLtWopV+obOxgyZZ6lm1rYNm2BtbtaiZuobwkm//52FQmDstJdhFFRI6ZRn3LgNMajrJwfQ3f/tMHNLZ38eW5p/L588o0YlxE+iWN+pYBJyvNxxVThvHSl89j3qQSfvji+n0D0GLx1PvwKSJyrFSjlgHhT+9X8c1nV9PYHqEgM8BF5cXMm1TC2acUkJmmoRgikto0mEwGvCtPH8aF5cUsXF/D3z7YzQtrdvH4sp0YA2MKMpk4LIfJpbnMLivg9OG5GKOR4yLSP/SqRm2MuRS4B/ACv7LW3nXA618BPgtEgVrgZmvttsRrMWBV4tDt1tr5R3o/1ajleHVF47ybGHy2pqqJNVXNVDZ2ADB+SDY3nDGCBdOGk5vhT3JJRUSOczCZMcYLbAAuBnYCS4AbrLUfdDvmQmCxtbbdGPMF4AJr7XWJ11qttVlHU2AFtZwI9W1dvLB6F48t2c7KnU2k+TycWVZAfoaf7KCfnHQfpaEMLj+thFBGINnFFZFB5HiD+izgW9baSxLb3wCw1n7/EMdPA+611p6T2FZQS8pZU9XEY+/uYPn2Blo6ozR3RmjpjBKLWwJeD/MmDeG6WSM455RCPFpgRUROsOPtoy4FdnTb3gmceZjjPwP8tdt20BizFNcsfpe19plDFPJzwOcARo4c2YtiiRy7ScNy+c7Vufvts9byQXUzjy/dyTPvVfLnldUMzQ1yUXkxF5UXc/YphaQH9EhOETm5ehPUPVUneqyGG2NuBGYC53fbPdJaW2WMKQNeNcasstZuPuiE1j4IPAiuRt2Lcon0KWMMk4blMml+LndcVs7La3fz3HtVPL2ikt8t3r6vqXzqiBCTE4PThuYGNTBNRE6o3gT1TmBEt+3hQNWBBxlj5gL/AZxvrQ3v3W+trUr8W2GMWQhMAw4KapFUEvR7uWLKMK6YMoxwNMa7W+p5dV0Nb23aw70ba9k7VTs76CPg9RCzdt/87Vmj87liylDmThxCTlCD1UTk+PQmqJcA44wxY4BK4Hrg490PSPRLPwBcaq2t6bY/D2i31oaNMYXAOcAP+qrwIidDms/LueOKOHdcEQAdXTHW7mpmTWUTG3a3ErcWr8fg9RjC0Tivr6/l1XU1BLwezju1iI9ML2XuhCFak1xEjskRg9paGzXGfBF4ETc962Fr7RpjzJ3AUmvtc8APgSzg8UQz4N5pWBOAB4wxcdwqaHd1Hy0u0h+lB7xMH5nH9JF5Pb5urWXFjkaeX1nN8yureXntbgqzAnx0xnCunzWSUfkZtISjNHdEaO6MkBHwURpKV5CLSI+0MpnICRSLWxZtrOWxd7fz8toaYnGLMXDgn50xUJITZEReBjNG5/Hps0dTnBNMTqFF5KTTQzlEUkBNSyfPvVdFc2eUnKCPnHQ/OUEfreEYO+rb2dHQzva6dpZvb8Dn8fDRGcO55fwyRhVk7jtHPG6JW6uHj4gMMFpCVCQFFGcH+ey5ZUc8bltdGw8squCJpTv5w5LtTBqWS1s4SkN7F00dEfxeD2eMyee8cUWce2oh44dka+S5yACmGrVIiqpp7uTht7aypqqJUEaAULqfUIafls4ob27aw6aaVgAKMgOcUpTFqIIMRhdmMjwvHb/Xs29eZZrfw5lj9HASkVSmGrVIP1ScE+SOy8oP+XpVYwdvbtzDkq31bK1rY+GGWmqX7ezx2MyAm272sVkjmD4ypBq4SD+iGrXIANIajlLd2EEs8XdtLTS0de1baa29K0ZZUSaloXS8HoPPY/B5PMwYlcdVU4dpAJtIkmgwmYjQGo7y/Moq/ryympbOKPHEIi3tXTG27GnDY+CcsYUsmFbKtJF55GcGyAn69tW+W8NRKhs6qGrsICfdz7QRIa2DLtJHFNQicliba1t5dkUlT79XyY76jn37/V5DfmaAzkicpo7Ifj9TlJ3GvIlDuGRSCbNG5+P3ukVf1KwucvQU1CLSK3sXa9m6p436ti72tHZR3xYm4PNQGsqgNC+d0lCQnQ0dvLhmF6+tq6UjEtvvHHtXafPt/fJ6yA76mDEqj7PKCphdVsCI/Iwk/YYiqUlBLSInRGckxqINtWysaSUWt/u+IvE4sZglGrdE43H2tHTx7tZ66tu6ABiWG6SsKIsR+RmMKshgTGEmc8YWamS6DFoa9S0iJ0TQ72XepBLmTTrysfG4ZWNNK+9U1LF8ewNb69p5YXU1De2uST0j4OXSySVcM304s8sK1P8tkqAatYgkVXNnhA+qmnlmRSXPr6ymJRxlWG6Qs8cWMnVEiKkjQpSXZFPd1MniLfUsrqhj6bYG6lrDrsYeczX48UOy+eRZo7h6aqlq5tLvqOlbRPqFzkiMF9fs4k/vV7N8e8O+pnKfxxBNPEY0lOFn5qh8SkNB/F4PPq8Hj4GF62v5oLqZ7DQfH50xnCtPH8aEodlkBBTakvoU1CLS71hr2dnQwYodjaypaqI0lM6ZYwoYV5zVY7O4tZbl2xv5zdtb+cuqXXTF4hgDowsymTA0m5KcdCKxOF3ROF2xOGk+D+NLspk4NIfyoTnkBH3Ut3VRsaeNitpW9rR2UV6SzdQRIQqy0gD3QeKtTXt4cc0u3q6oY1xxNheOL+KC8cUaICfHRUEtIoNKXWuYpdsaWFvdnPhqoa7VjV7f+9UWju2rsYNbva2tK9bj+UbkpzO6IJPl2xpo64qRnebjzLICNuxuYXt9OwBlRZnMnTCEuROGMGNUHt7D9LE3d0ZYtKGWdL+XC8YXH/ZYGRwU1CIiB7DWUtsSZk0izHc3dTKyIJOyokxOKcwiL9PP2uoWVmxv4L0djVTUtjFjdB6XTCrhrLICAj4P1lq27Glj4fpaXltfwzsVdURilrwMPxeVD6G8JJtQhp+8jAChDD9rq5t56YPd+44DGJ6XzqfOGs3HZo4gN8O/r3wtnRE6I3EKMgMaWDcIKKhFRE6Cls4Iizbs4eW1u3l1Xc1Bi8QAlBVmcvHEIVw8cQh7Wrt4+K0tvLulnnS/lynDc6ltDbO7qXNf7T7g9TAsFGRYKJ3RhZmcfUoBc8YWEsoInOxfT04gBbWIyElmraUlHKWxLUJjRxcN7RFKQ+mMLc466Ng1VU088tZWNte2MiQnSElukJKcIGk+D9XNnVQ1dlLZ0M7GmlZaOqN4DEwZHmJ2WQEFmQGygj4y03wEfR4a2yPUtoapa+2isaOLvIwAw0JuoZqS3HR8HkNXoq8+EouTHfRTnJ1GUXYafj3nPGkU1CIiA0A0Fuf9nU0s2lDLoo21vL+jkfgh/heeGfCSm+6nvr2Lzki8V+cvyAwwPD+DsUVZjC3OYlxxFkG/l93Nnexu6aSmOUxO0MeC6cMZU5jZh7+ZKKhFRAageNzS1hWlLRyjNRyhoytOKMNPQVZg37Q0ay2N7REqGzvY1dSJxa3hHvB58Hk8tHRG2N0cpqalk93NYbbVtbGpppWalvBB75ed5qOtK0rcwqzReVw7YwQXjC8iErd0dEVp74oRi1ty0/2Jh7r4icYtqyobeaeinncq6li3q4WpI0J8qLyYi8qLD3piWzxuD9snvzezBtqa8gpqERE5Kk0dETbXttIVjVOSE6Q4J42MgI/dzZ08tbySx5ftoKK27bDn8BjweTx0xVyNvrwkm/El2Szd2kBlo3v4y4ShOXg90Ngeoak9Qks4ytjiLOaMLWTO2ELOLMuntiXMW5v28MbGPbxdUUc0ZhkWClKal0FpKJ3Th+dy2WlDyU33H644KU1BLSIifcrNW29g1c4m0gNe0gM+MvxePB4X8vVtERrbu+iKxpk2MsQZYwrIzwzs+9n1u1t4Za0bKe/3egil+8nN8JMR8LKqspl3t9TRGXFz4ffGVGkonTljC8kK+qhs6KCysYOdDe00tEcI+DxcPGEIC6aVUlaUyarKJt7b0cj7Oxqpauwkze8hzech6PcSyghwxug8zjqlgCnDQwf1zVtre6yxx+OWmpYwlY0dDAsFGZqb3mfXU0EtIiL9SjgaY9m2BhZX1FOUncacsYWMKsg4KECttazc2cTTKyp57v2q/ebGB/0eTivNZVRBJpFYnHAkTjgao7qpk3W7WgC3xvykYTl0RuI0dnTR2B6hNRwlM+AjJ+gjJ919eNjT2kV1U8e+aXXfvGIin5kzps9+XwW1iIgMeJFYnEUbatnTGua00hCnDsnCd4iR7PVtXSyuqOPtijrWVbeQFfTtq9VnpfloC8do7ozQ1BGhLRylMCvNjZ5PPOp14tBcSnKDPZ77WCioRUREUtjhglqT5kRERFKYglpERCSFKahFRERSmIJaREQkhSmoRUREUpiCWkREJIUpqEVERFKYglpERCSFKahFRERSmIJaREQkhSmoRUREUpiCWkREJIUpqEVERFKYglpERCSFKahFRERSmIJaREQkhSmoRUREUpiCWkREJIUZa22yy3AQY0wtsK0PT1kI7OnD8w1Wuo59Q9exb+g69g1dx75xvNdxlLW2qKcXUjKo+5oxZqm1dmayy9Hf6Tr2DV3HvqHr2Dd0HfvGibyOavoWERFJYQpqERGRFDZYgvrBZBdggNB17Bu6jn1D17Fv6Dr2jRN2HQdFH7WIiEh/NVhq1CIiIv3SgA5qY8ylxpj1xphNxpg7kl2e/sIYM8IY85oxZq0xZo0x5kuJ/fnGmL8ZYzYm/s1Ldln7A2OM1xizwhjz58T2GGPM4sR1/IMxJpDsMqY6Y0zIGPOEMWZd4r48S/fj0TPG/Evib3q1Meb3xpig7scjM8Y8bIypMcas7ravx/vPOD9N5M5KY8z0433/ARvUxhgvcB9wGTARuMEYMzG5peo3osBXrbUTgNnAbYlrdwfwirV2HPBKYluO7EvA2m7b/w38JHEdG4DPJKVU/cs9wAvW2nLgdNz11P14FIwxpcDtwExr7WTAC1yP7sfeeAS49IB9h7r/LgPGJb4+B9x/vG8+YIMaOAPYZK2tsNZ2AY8BVyW5TP2CtbbaWrs88X0L7n+Kpbjr92jisEeBq5NTwv7DGDMc+DDwq8S2AS4Cnkgcout4BMaYHOA84CEAa22XtbYR3Y/HwgekG2N8QAZQje7HI7LWLgLqD9h9qPvvKuDX1nkHCBljhh7P+w/koC4FdnTb3pnYJ0fBGDMamAYsBoZYa6vBhTlQnLyS9Rt3A18H4ontAqDRWhtNbOu+PLIyoBb430QXwq+MMZnofjwq1tpK4EfAdlxANwHL0P14rA51//V59gzkoDY97NMQ96NgjMkCngS+bK1tTnZ5+htjzBVAjbV2WffdPRyq+/LwfMB04H5r7TSgDTVzH7VEH+pVwBhgGJCJa6Y9kO7H49Pnf+MDOah3AiO6bQ8HqpJUln7HGOPHhfTvrLVPJXbv3tuEk/i3Jlnl6yfOAeYbY7biul4uwtWwQ4mmR9B92Rs7gZ3W2sWJ7Sdwwa378ejMBbZYa2uttRHgKeBsdD8eq0Pdf32ePQM5qJcA4xIjGgO4QRPPJblM/UKiH/UhYK219n+6vfQc8KnE958Cnj3ZZetPrLXfsNYOt9aOxt1/r1prPwG8BlyTOEzX8QistbuAHcaY8YldHwI+QPfj0doOzDbGZCT+xvdeR92Px+ZQ999zwD8lRn/PBpr2NpGUU5WyAAAA1klEQVQfqwG94Ikx5nJcDcYLPGyt/V6Si9QvGGPmAG8Aq/hH3+q/4/qp/wiMxP3RX2utPXCAhfTAGHMB8DVr7RXGmDJcDTsfWAHcaK0NJ7N8qc4YMxU3IC8AVACfxlU0dD8eBWPMt4HrcDM7VgCfxfWf6n48DGPM74ELcE/I2g38J/AMPdx/iQ9B9+JGibcDn7bWLj2u9x/IQS0iItLfDeSmbxERkX5PQS0iIpLCFNQiIiIpTEEtIiKSwhTUIiIiKUxBLSIiksIU1CIiIilMQS0iIpLC/j/Jw8mtNr1EuwAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Model-Inference&quot;&gt;Model Inference&lt;a class=&quot;anchor-link&quot; href=&quot;#Model-Inference&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Load the weights and test it with test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allcnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;best_weights.hdf5&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;categorical_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sgd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Accuracy: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Model: &amp;#34;sequential_9&amp;#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_46 (Conv2D)           (None, 32, 32, 96)        2688      
_________________________________________________________________
conv2d_47 (Conv2D)           (None, 32, 32, 96)        83040     
_________________________________________________________________
max_pooling2d_12 (MaxPooling (None, 16, 16, 96)        0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 16, 16, 96)        0         
_________________________________________________________________
conv2d_48 (Conv2D)           (None, 16, 16, 192)       166080    
_________________________________________________________________
conv2d_49 (Conv2D)           (None, 16, 16, 192)       331968    
_________________________________________________________________
max_pooling2d_13 (MaxPooling (None, 8, 8, 192)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 8, 8, 192)         0         
_________________________________________________________________
conv2d_50 (Conv2D)           (None, 8, 8, 192)         331968    
_________________________________________________________________
conv2d_51 (Conv2D)           (None, 8, 8, 192)         37056     
_________________________________________________________________
conv2d_52 (Conv2D)           (None, 8, 8, 10)          1930      
_________________________________________________________________
global_average_pooling2d_5 ( (None, 10)                0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                110       
=================================================================
Total params: 954,840
Trainable params: 954,840
Non-trainable params: 0
_________________________________________________________________
None
10000/10000 [==============================] - 1s 96us/sample - loss: 0.4512 - accuracy: 0.8530
Accuracy: 0.8529999852180481
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# make dictionary of class labels&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# zip the names and labels to make a dictionary of class labels&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;class_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;class_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;{0: &amp;#39;airplane&amp;#39;, 1: &amp;#39;automobile&amp;#39;, 2: &amp;#39;bird&amp;#39;, 3: &amp;#39;cat&amp;#39;, 4: &amp;#39;deer&amp;#39;, 5: &amp;#39;dog&amp;#39;, 6: &amp;#39;frog&amp;#39;, 7: &amp;#39;horse&amp;#39;, 8: &amp;#39;ship&amp;#39;, 9: &amp;#39;truck&amp;#39;}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Generate batch of 9 images to predict&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ground_truth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make predictions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;9/9 [==============================] - 0s 3ms/sample
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# use np.argmax)_ tp cpmvert class probabilities to class labels&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;class_result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;class_result&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([4, 5, 6, 3, 1, 1, 3, 6, 8], dtype=int64)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create a grid of 3x3 images&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots_adjust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hspace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Determine label for each prediction, set title&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; Actual: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;class_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ground_truth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_xaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_yaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
    &lt;span class=&quot;c1&quot;&gt;# Plot the image&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/cifar10_result.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/cifar10_result.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Ensembles and Pipelines in PySpark</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/11/02-Ensembles-and-Pipelines-in-PySpark.html" rel="alternate" type="text/html" title="Ensembles and Pipelines in PySpark" /><published>2020-08-11T00:00:00-05:00</published><updated>2020-08-11T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/11/02-Ensembles-and-Pipelines-in-PySpark</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/11/02-Ensembles-and-Pipelines-in-PySpark.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-11-02-Ensembles-and-Pipelines-in-PySpark.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pipeline&quot;&gt;Pipeline&lt;a class=&quot;anchor-link&quot; href=&quot;#Pipeline&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;A watertight model
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/watertight_model.png&quot; alt=&quot;watertight&quot; /&gt;&lt;ul&gt;
&lt;li&gt;If test data is included while training, the model will be no longer for objective (leakage)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Pipeline
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/pipeline_spark.png&quot; alt=&quot;pipeline&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Flight-duration-model---Pipeline-stages&quot;&gt;Flight duration model - Pipeline stages&lt;a class=&quot;anchor-link&quot; href=&quot;#Flight-duration-model---Pipeline-stages&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You're going to create the stages for the flights duration model pipeline. You will use these in the next exercise to build a pipeline and to create a regression model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;local[*]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;flights&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read data from CSV file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/flights-larger.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inferSchema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;nullValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;NA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get number of records&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;The data contain &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; records.&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# View the first five records&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Check column data types&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtypes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;The data contain 275000 records.
+---+---+---+-------+------+---+----+------+--------+-----+
|mon|dom|dow|carrier|flight|org|mile|depart|duration|delay|
+---+---+---+-------+------+---+----+------+--------+-----+
| 10| 10|  1|     OO|  5836|ORD| 157|  8.18|      51|   27|
|  1|  4|  1|     OO|  5866|ORD| 466|  15.5|     102| null|
| 11| 22|  1|     OO|  6016|ORD| 738|  7.17|     127|  -19|
|  2| 14|  5|     B6|   199|JFK|2248| 21.17|     365|   60|
|  5| 25|  3|     WN|  1675|SJC| 386| 12.92|      85|   22|
+---+---+---+-------+------+---+----+------+--------+-----+
only showing top 5 rows

root
 |-- mon: integer (nullable = true)
 |-- dom: integer (nullable = true)
 |-- dow: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- flight: integer (nullable = true)
 |-- org: string (nullable = true)
 |-- mile: integer (nullable = true)
 |-- depart: double (nullable = true)
 |-- duration: integer (nullable = true)
 |-- delay: integer (nullable = true)

None
[(&amp;#39;mon&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;dom&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;dow&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;carrier&amp;#39;, &amp;#39;string&amp;#39;), (&amp;#39;flight&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;org&amp;#39;, &amp;#39;string&amp;#39;), (&amp;#39;mile&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;depart&amp;#39;, &amp;#39;double&amp;#39;), (&amp;#39;duration&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;delay&amp;#39;, &amp;#39;int&amp;#39;)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.functions&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Convert &amp;#39;mile&amp;#39; to &amp;#39;km&amp;#39; and drop &amp;#39;mile&amp;#39; column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.60934&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mile&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.regression&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Convert categorical strings to index values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;indexer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# One-hot encode index values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dow&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;outputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dow_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Assemble predictors into a single column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dow_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# A linear regression object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Flight-duration-model:-Pipeline-model&quot;&gt;Flight duration model: Pipeline model&lt;a class=&quot;anchor-link&quot; href=&quot;#Flight-duration-model:-Pipeline-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You're now ready to put those stages together in a pipeline.&lt;/p&gt;
&lt;p&gt;You'll construct the pipeline and then train the pipeline on the training data. This will apply each of the individual stages in the pipeline to the training data in turn. None of the stages will be exposed to the testing data at all: there will be no leakage!&lt;/p&gt;
&lt;p&gt;Once the entire pipeline has been trained it will then be used to make predictions on the testing data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pipeline&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Construct a pipeline&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train the pipeline on the training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make predictions on the test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;SMS-spam-pipeline&quot;&gt;SMS spam pipeline&lt;a class=&quot;anchor-link&quot; href=&quot;#SMS-spam-pipeline&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You haven't looked at the SMS data for quite a while. Last time we did the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;split the text into tokens&lt;/li&gt;
&lt;li&gt;removed stop words&lt;/li&gt;
&lt;li&gt;applied the hashing trick&lt;/li&gt;
&lt;li&gt;converted the data from counts to IDF and&lt;/li&gt;
&lt;li&gt;trained a linear regression model.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Each of these steps was done independently. This seems like a great application for a pipeline!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.types&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Specify column names and types&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;label&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read data from CSV file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/sms.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nullValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;NA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+--------------------+-----+
| id|                text|label|
+---+--------------------+-----+
|  1|Sorry, I&amp;#39;ll call ...|    0|
|  2|Dont worry. I gue...|    0|
|  3|Call FREEPHONE 08...|    1|
|  4|Win a 1000 cash p...|    1|
|  5|Go until jurong p...|    0|
+---+--------------------+-----+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StopWordsRemover&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HashingTF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IDF&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.classification&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Break text into tokens at non-word characters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;words&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Remove stop words&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;remover&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StopWordsRemover&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOutputCol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;terms&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Apply the hashing trick and transform to TF-IDF&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hasher&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HashingTF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remover&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOutputCol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hash&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;idf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IDF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOutputCol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a logistic regression object and add everything to a pipeline&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;logistic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remover&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hasher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logistic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Cross-Validation&quot;&gt;Cross-Validation&lt;a class=&quot;anchor-link&quot; href=&quot;#Cross-Validation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/cv_spark.png&quot; alt=&quot;cv&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Cross-validating-simple-flight-duration-model&quot;&gt;Cross validating simple flight duration model&lt;a class=&quot;anchor-link&quot; href=&quot;#Cross-validating-simple-flight-duration-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You've already built a few models for predicting flight duration and evaluated them with a simple train/test split. However, cross-validation provides a much better way to evaluate model performance.&lt;/p&gt;
&lt;p&gt;In this exercise you're going to train a simple model for flight duration using cross-validation. Travel time is usually strongly correlated with distance, so using the &lt;code&gt;km&lt;/code&gt; column alone should give a decent model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+------+--------+-----+------+--------+
|mon|dom|dow|carrier|flight|org|depart|duration|delay|    km|features|
+---+---+---+-------+------+---+------+--------+-----+------+--------+
| 10| 10|  1|     OO|  5836|ORD|  8.18|      51|   27| 253.0| [253.0]|
|  1|  4|  1|     OO|  5866|ORD|  15.5|     102| null| 750.0| [750.0]|
| 11| 22|  1|     OO|  6016|ORD|  7.17|     127|  -19|1188.0|[1188.0]|
|  2| 14|  5|     B6|   199|JFK| 21.17|     365|   60|3618.0|[3618.0]|
|  5| 25|  3|     WN|  1675|SJC| 12.92|      85|   22| 621.0| [621.0]|
+---+---+---+-------+------+---+------+--------+-----+------+--------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.tuning&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ParamGridBuilder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CrossValidator&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.evaluation&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an empty parameter grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ParamGridBuilder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create objects for building and evaluating a regression model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a cross validator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CrossValidator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;estimatorParamMaps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                    &lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numFolds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train and test model on multiple folds of the training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Cross-validating-flight-duration-model-pipeline&quot;&gt;Cross validating flight duration model pipeline&lt;a class=&quot;anchor-link&quot; href=&quot;#Cross-validating-flight-duration-model-pipeline&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The cross-validated model that you just built was simple, using &lt;code&gt;km&lt;/code&gt; alone to predict &lt;code&gt;duration&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Another important predictor of flight duration is the origin airport. Flights generally take longer to get into the air from busy airports. Let's see if adding this predictor improves the model!&lt;/p&gt;
&lt;p&gt;In this exercise you'll add the &lt;code&gt;org&lt;/code&gt; field to the model. However, since &lt;code&gt;org&lt;/code&gt; is categorical, there's more work to be done before it can be included: it must first be transformed to an index and then one-hot encoded before being assembled with &lt;code&gt;km&lt;/code&gt; and used to build the regression model. We'll wrap these operations up in a pipeline.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create an empty paramter grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ParamGridBuilder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create regression model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an indexer for the org field&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;indexer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an one-hot encoder for the indexed org field&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Assemble the km and one-hot encoded fields&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a pipeline and cross-validator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CrossValidator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;estimatorParamMaps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Grid-Search&quot;&gt;Grid Search&lt;a class=&quot;anchor-link&quot; href=&quot;#Grid-Search&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Optimizing-flights-linear-regression&quot;&gt;Optimizing flights linear regression&lt;a class=&quot;anchor-link&quot; href=&quot;#Optimizing-flights-linear-regression&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Up until now you've been using the default hyper-parameters when building your models. In this exercise you'll use cross validation to choose an optimal (or close to optimal) set of model hyper-parameters.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create parameter grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ParamGridBuilder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add grids for two parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;10.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;\
               &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elasticNetParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Build the parameter grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of models to be tested: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create cross-validator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CrossValidator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;estimatorParamMaps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                    &lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numFolds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Number of models to be tested:  12
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Dissecting-the-best-flight-duration-model&quot;&gt;Dissecting the best flight duration model&lt;a class=&quot;anchor-link&quot; href=&quot;#Dissecting-the-best-flight-duration-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You just set up a &lt;code&gt;CrossValidator&lt;/code&gt; to find good parameters for the linear regression model predicting flight duration.&lt;/p&gt;
&lt;p&gt;Now you're going to take a closer look at the resulting model, split out the stages and use it to make predictions on the testing data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Drop the existed feature column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train the data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cvModel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get the best model from cross validation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;best_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cvModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bestModel&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Look at the stages in the best model&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get the parameters for the LinearRegression object in the best model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;best_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractParamMap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Generate predictions on test data using the best model then calculate RMSE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[StringIndexerModel: uid=StringIndexer_e6270b361418, handleInvalid=error, OneHotEncoderModel: uid=OneHotEncoder_f0cb230aef6c, dropLast=true, handleInvalid=error, VectorAssembler_7f7413ad3499, LinearRegressionModel: uid=LinearRegression_61f3d4b255f6, numFeatures=8]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;11.217337853713733&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;SMS-spam-optimized&quot;&gt;SMS spam optimized&lt;a class=&quot;anchor-link&quot; href=&quot;#SMS-spam-optimized&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The pipeline you built earlier for the SMS spam model used the default parameters for all of the elements in the pipeline. It's very unlikely that these parameters will give a particularly good model though.&lt;/p&gt;
&lt;p&gt;In this exercise you'll set up a parameter grid which can be used with cross validation to choose a good set of parameters for the SMS spam classifier.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create parameter grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ParamGridBuilder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add grid for hashing trick parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numFeatures&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16384&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;\
               &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add grid for logistic regression parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logistic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;10.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;\
               &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logistic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elasticNetParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Build parameter grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of models to be tested: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Number of models to be tested:  72
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Ensemble&quot;&gt;Ensemble&lt;a class=&quot;anchor-link&quot; href=&quot;#Ensemble&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/ensemble_spark.png&quot; alt=&quot;ensemble&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;collection of models&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Wisdom of the Crowd&lt;/strong&gt; - collective opinion of a group better than that of a single expert&lt;/li&gt;
&lt;li&gt;Random Forest&lt;ul&gt;
&lt;li&gt;an ensemble of Decision Tree&lt;/li&gt;
&lt;li&gt;Creating model diversity&lt;ul&gt;
&lt;li&gt;each tree trained on random subset of data&lt;/li&gt;
&lt;li&gt;random subset of features used for splitting at each node&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;No two trees in the forest should be the same&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Gradient-Boosted Trees&lt;ul&gt;
&lt;li&gt;Iterative boosting algorithm:&lt;ol&gt;
&lt;li&gt;Build a Decision Tree and add to ensemble&lt;/li&gt;
&lt;li&gt;Predict label for each training instance using ensemble&lt;/li&gt;
&lt;li&gt;Compare predictions with known labels&lt;/li&gt;
&lt;li&gt;Emphasize training instances with incorrect predictions&lt;/li&gt;
&lt;li&gt;return to 1.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Delayed-flights-with-Gradient-Boosted-Trees&quot;&gt;Delayed flights with Gradient-Boosted Trees&lt;a class=&quot;anchor-link&quot; href=&quot;#Delayed-flights-with-Gradient-Boosted-Trees&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You've previously built a classifier for flights likely to be delayed using a Decision Tree. In this exercise you'll compare a Decision Tree model to a Gradient-Boosted Trees model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.classification&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GBTClassifier&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.evaluation&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BinaryClassificationEvaluator&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mon&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mon&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+------+--------+-----------------+-----+
|mon|depart|duration|         features|label|
+---+------+--------+-----------------+-----+
| 10|  8.18|      51| [10.0,8.18,51.0]|    1|
| 11|  7.17|     127|[11.0,7.17,127.0]|    0|
|  2| 21.17|     365|[2.0,21.17,365.0]|    1|
|  5| 12.92|      85| [5.0,12.92,85.0]|    1|
|  3| 13.33|     182|[3.0,13.33,182.0]|    1|
+---+------+--------+-----------------+-----+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.classification&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DecisionTreeClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GBTClassifier&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.evaluation&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BinaryClassificationEvaluator&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pprint&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pprint&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create model objects and train on training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tree&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DecisionTreeClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gbt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GBTClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Compare AUC on test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BinaryClassificationEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gbt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Find the number of trees and the relative importance of features&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pprint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gbt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trees&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gbt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;featureImportances&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[DecisionTreeRegressionModel: uid=dtr_ec0910e25dea, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_fca176dc37a4, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_ff05809a5d0d, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_c0178826c7f2, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_e3d7c7cf801d, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_b28386703df3, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_236a1b0a44cc, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_5702ac9781e9, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_1294cc0afc51, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_9c3a2c2f669c, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_ba4aef54784c, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_760d589922ac, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_6d07166b635b, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_c807be867213, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_ef74f5e2c3b4, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_858147b5b20b, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_f0ff74220975, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_958292546340, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_e387146dd7b3, depth=5, numNodes=63, numFeatures=3,
 DecisionTreeRegressionModel: uid=dtr_1d883b4c0434, depth=5, numNodes=63, numFeatures=3]
(3,[0,1,2],[0.3996945565930914,0.3279675109854171,0.27233793242149146])
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Delayed-flights-with-a-Random-Forest&quot;&gt;Delayed flights with a Random Forest&lt;a class=&quot;anchor-link&quot; href=&quot;#Delayed-flights-with-a-Random-Forest&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In this exercise you'll bring together cross validation and ensemble methods. You'll be training a Random Forest classifier to predict delayed flights, using cross validation to choose the best values for model parameters.&lt;/p&gt;
&lt;p&gt;You'll find good values for the following parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;featureSubsetStrategy&lt;/code&gt; — the number of features to consider for splitting at each node and&lt;/li&gt;
&lt;li&gt;&lt;code&gt;maxDepth&lt;/code&gt; — the maximum number of splits along any branch.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.classification&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a random forest classifier&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;forest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a parameter grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ParamGridBuilder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; \
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;featureSubsetStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;all&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;onethird&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sqrt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;log2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; \
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxDepth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; \
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a binary classification evaluator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BinaryClassificationEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a cross-validator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CrossValidator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;estimatorParamMaps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                    &lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numFolds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Evaluating-Random-Forest&quot;&gt;Evaluating Random Forest&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluating-Random-Forest&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In this final exercise you'll be evaluating the results of cross-validation on a Random Forest model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cvModel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average AUC for each parameter combination in grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_auc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cvModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avgMetrics&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average AUC for the best model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;best_model_auc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg_auc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# What&amp;#39;s the optimal paramter value?&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;opt_max_depth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cvModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bestModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;explainParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;maxDepth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;opt_feat_substrat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cvModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bestModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;explainParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;featureSubsetStrategy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# AUC for best model on test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;best_auc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cvModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_auc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0.6844690961353807
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/watertight_model.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/watertight_model.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Regression in PySpark</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/2020/08/11/01-Regression-in-PySpark.html" rel="alternate" type="text/html" title="Regression in PySpark" /><published>2020-08-11T00:00:00-05:00</published><updated>2020-08-11T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/2020/08/11/01-Regression-in-PySpark</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/2020/08/11/01-Regression-in-PySpark.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-11-01-Regression-in-PySpark.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;One-Hot-Encoding&quot;&gt;One-Hot Encoding&lt;a class=&quot;anchor-link&quot; href=&quot;#One-Hot-Encoding&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Encoding-flight-origin&quot;&gt;Encoding flight origin&lt;a class=&quot;anchor-link&quot; href=&quot;#Encoding-flight-origin&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The &lt;code&gt;org&lt;/code&gt; column in the flights data is a categorical variable giving the airport from which a flight departs.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ORD — O'Hare International Airport (Chicago)&lt;/li&gt;
&lt;li&gt;SFO — San Francisco International Airport&lt;/li&gt;
&lt;li&gt;JFK — John F Kennedy International Airport (New York)&lt;/li&gt;
&lt;li&gt;LGA — La Guardia Airport (New York)&lt;/li&gt;
&lt;li&gt;SMF — Sacramento&lt;/li&gt;
&lt;li&gt;SJC — San Jose&lt;/li&gt;
&lt;li&gt;TUS — Tucson International Airport&lt;/li&gt;
&lt;li&gt;OGG — Kahului (Hawaii)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Obviously this is only a small subset of airports. Nevertheless, since this is a categorical variable, it needs to be one-hot encoded before it can be used in a regression model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;local[*]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;flights&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read data from CSV file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/flights-larger.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inferSchema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;nullValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;NA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get number of records&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;The data contain &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; records.&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# View the first five records&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Check column data types&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtypes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;The data contain 275000 records.
+---+---+---+-------+------+---+----+------+--------+-----+
|mon|dom|dow|carrier|flight|org|mile|depart|duration|delay|
+---+---+---+-------+------+---+----+------+--------+-----+
| 10| 10|  1|     OO|  5836|ORD| 157|  8.18|      51|   27|
|  1|  4|  1|     OO|  5866|ORD| 466|  15.5|     102| null|
| 11| 22|  1|     OO|  6016|ORD| 738|  7.17|     127|  -19|
|  2| 14|  5|     B6|   199|JFK|2248| 21.17|     365|   60|
|  5| 25|  3|     WN|  1675|SJC| 386| 12.92|      85|   22|
+---+---+---+-------+------+---+----+------+--------+-----+
only showing top 5 rows

root
 |-- mon: integer (nullable = true)
 |-- dom: integer (nullable = true)
 |-- dow: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- flight: integer (nullable = true)
 |-- org: string (nullable = true)
 |-- mile: integer (nullable = true)
 |-- depart: double (nullable = true)
 |-- duration: integer (nullable = true)
 |-- delay: integer (nullable = true)

None
[(&amp;#39;mon&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;dom&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;dow&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;carrier&amp;#39;, &amp;#39;string&amp;#39;), (&amp;#39;flight&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;org&amp;#39;, &amp;#39;string&amp;#39;), (&amp;#39;mile&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;depart&amp;#39;, &amp;#39;double&amp;#39;), (&amp;#39;duration&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;delay&amp;#39;, &amp;#39;int&amp;#39;)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+----+------+--------+-----+-------+
|mon|dom|dow|carrier|flight|org|mile|depart|duration|delay|org_idx|
+---+---+---+-------+------+---+----+------+--------+-----+-------+
| 10| 10|  1|     OO|  5836|ORD| 157|  8.18|      51|   27|    0.0|
|  1|  4|  1|     OO|  5866|ORD| 466|  15.5|     102| null|    0.0|
| 11| 22|  1|     OO|  6016|ORD| 738|  7.17|     127|  -19|    0.0|
|  2| 14|  5|     B6|   199|JFK|2248| 21.17|     365|   60|    2.0|
|  5| 25|  3|     WN|  1675|SJC| 386| 12.92|      85|   22|    5.0|
|  3| 28|  1|     B6|   377|LGA|1076| 13.33|     182|   70|    3.0|
|  5| 28|  6|     B6|   904|ORD| 740|  9.58|     130|   47|    0.0|
|  1| 19|  2|     UA|   820|SFO| 679| 12.75|     123|  135|    1.0|
|  8|  5|  5|     US|  2175|LGA| 214|  13.0|      71|  -10|    3.0|
|  5| 27|  5|     AA|  1240|ORD|1197| 14.42|     195|  -11|    0.0|
|  8| 20|  6|     B6|   119|JFK|1182| 14.67|     198|   20|    2.0|
|  2|  3|  1|     AA|  1881|JFK|1090| 15.92|     200|   -9|    2.0|
|  8| 26|  5|     B6|    35|JFK|1028| 20.58|     193|  102|    2.0|
|  4|  9|  5|     AA|   336|ORD| 733|  20.5|     125|   32|    0.0|
|  3|  8|  2|     UA|   678|ORD| 733| 10.95|     129|   55|    0.0|
|  8| 10|  3|     OH|  6347|LGA| 292| 11.75|     102|    8|    3.0|
|  8| 14|  0|     UA|   624|ORD| 612| 17.92|     109|   57|    0.0|
|  4|  8|  4|     OH|  5585|JFK| 301| 13.25|      88|   23|    2.0|
|  1| 14|  4|     UA|  1524|SFO| 414| 14.87|      91|   27|    1.0|
|  1|  2|  6|     AA|  1341|ORD|1846|   7.5|     275|   26|    0.0|
+---+---+---+-------+------+---+----+------+--------+-----+-------+
only showing top 20 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;&lt;code&gt;OneHotEncoderEstimator&lt;/code&gt; is replaced with &lt;code&gt;OneHotEncoder&lt;/code&gt; in 3.0.0
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an instance of the one hot encoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Apply the one hot encoder to the flights data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Check the results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distinct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+-------+-------------+
|org|org_idx|    org_dummy|
+---+-------+-------------+
|ORD|    0.0|(7,[0],[1.0])|
|SFO|    1.0|(7,[1],[1.0])|
|JFK|    2.0|(7,[2],[1.0])|
|LGA|    3.0|(7,[3],[1.0])|
|SMF|    4.0|(7,[4],[1.0])|
|SJC|    5.0|(7,[5],[1.0])|
|TUS|    6.0|(7,[6],[1.0])|
|OGG|    7.0|    (7,[],[])|
+---+-------+-------------+

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Regression&quot;&gt;Regression&lt;a class=&quot;anchor-link&quot; href=&quot;#Regression&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Flight-duration-model---Just-distance&quot;&gt;Flight duration model - Just distance&lt;a class=&quot;anchor-link&quot; href=&quot;#Flight-duration-model---Just-distance&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In this exercise you'll build a regression model to predict flight duration (the &lt;code&gt;duration&lt;/code&gt; column).&lt;/p&gt;
&lt;p&gt;For the moment you'll keep the model simple, including only the distance of the flight (the &lt;code&gt;km&lt;/code&gt; column) as a predictor.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+----+------+--------+-----+-------+-------------+
|mon|dom|dow|carrier|flight|org|mile|depart|duration|delay|org_idx|    org_dummy|
+---+---+---+-------+------+---+----+------+--------+-----+-------+-------------+
| 10| 10|  1|     OO|  5836|ORD| 157|  8.18|      51|   27|    0.0|(7,[0],[1.0])|
|  1|  4|  1|     OO|  5866|ORD| 466|  15.5|     102| null|    0.0|(7,[0],[1.0])|
| 11| 22|  1|     OO|  6016|ORD| 738|  7.17|     127|  -19|    0.0|(7,[0],[1.0])|
|  2| 14|  5|     B6|   199|JFK|2248| 21.17|     365|   60|    2.0|(7,[2],[1.0])|
|  5| 25|  3|     WN|  1675|SJC| 386| 12.92|      85|   22|    5.0|(7,[5],[1.0])|
+---+---+---+-------+------+---+----+------+--------+-----+-------+-------------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.functions&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Convert &amp;#39;mile&amp;#39; to &amp;#39;km&amp;#39; and drop &amp;#39;mile&amp;#39; column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.60934&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mile&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+
|mon|dom|dow|carrier|flight|org|depart|duration|delay|org_idx|    org_dummy|    km|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+
| 10| 10|  1|     OO|  5836|ORD|  8.18|      51|   27|    0.0|(7,[0],[1.0])| 253.0|
|  1|  4|  1|     OO|  5866|ORD|  15.5|     102| null|    0.0|(7,[0],[1.0])| 750.0|
| 11| 22|  1|     OO|  6016|ORD|  7.17|     127|  -19|    0.0|(7,[0],[1.0])|1188.0|
|  2| 14|  5|     B6|   199|JFK| 21.17|     365|   60|    2.0|(7,[2],[1.0])|3618.0|
|  5| 25|  3|     WN|  1675|SJC| 12.92|      85|   22|    5.0|(7,[5],[1.0])| 621.0|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an assembler object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Consolidate predictor columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+--------+
|mon|dom|dow|carrier|flight|org|depart|duration|delay|org_idx|    org_dummy|    km|features|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+--------+
| 10| 10|  1|     OO|  5836|ORD|  8.18|      51|   27|    0.0|(7,[0],[1.0])| 253.0| [253.0]|
|  1|  4|  1|     OO|  5866|ORD|  15.5|     102| null|    0.0|(7,[0],[1.0])| 750.0| [750.0]|
| 11| 22|  1|     OO|  6016|ORD|  7.17|     127|  -19|    0.0|(7,[0],[1.0])|1188.0|[1188.0]|
|  2| 14|  5|     B6|   199|JFK| 21.17|     365|   60|    2.0|(7,[2],[1.0])|3618.0|[3618.0]|
|  5| 25|  3|     WN|  1675|SJC| 12.92|      85|   22|    5.0|(7,[5],[1.0])| 621.0| [621.0]|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+--------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.regression&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.evaluation&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a regression object and train on training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;featuresCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create predictions for the test data and take a look at the predictions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate the RMSE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metricName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rmse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+--------+------------------+
|duration|prediction        |
+--------+------------------+
|420     |496.4735315834907 |
|379     |345.85941488647666|
|210     |222.65721887539473|
|164     |133.60633841501843|
|125     |133.60633841501843|
+--------+------------------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;17.27005980968751&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Interpreting-the-coefficients&quot;&gt;Interpreting the coefficients&lt;a class=&quot;anchor-link&quot; href=&quot;#Interpreting-the-coefficients&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The linear regression model for flight duration as a function of distance takes the form&lt;/p&gt;
&lt;p&gt;duration = $\alpha$ + $\beta$ × distance&lt;/p&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$\alpha$ — intercept (component of duration which does not depend on distance) and&lt;/li&gt;
&lt;li&gt;$\beta$ — coefficient (rate at which duration increases as a function of distance; also called the slope).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;By looking at the coefficients of your model you will be able to infer&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;how much of the average flight duration is actually spent on the ground and&lt;/li&gt;
&lt;li&gt;what the average speed is during a flight.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Intercept (average minutes on ground)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;inter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intercept&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Coefficients&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;coefs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average minutes per km&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;minutes_per_km&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minutes_per_km&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average speed in km per hour&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_speed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minutes_per_km&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg_speed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;44.25256380341634
[0.07572353780644245]
0.07572353780644245
792.3560063103033
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Flight-duration-model---Adding-origin-airport&quot;&gt;Flight duration model - Adding origin airport&lt;a class=&quot;anchor-link&quot; href=&quot;#Flight-duration-model---Adding-origin-airport&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Some airports are busier than others. Some airports are bigger than others too. Flights departing from large or busy airports are likely to spend more time taxiing or waiting for their takeoff slot. So it stands to reason that the duration of a flight might depend not only on the distance being covered but also the airport from which the flight departs.&lt;/p&gt;
&lt;p&gt;You are going to make the regression model a little more sophisticated by including the departure airport as a predictor.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create an assembler object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Consolidate predictor columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+--------------------+
|mon|dom|dow|carrier|flight|org|depart|duration|delay|org_idx|    org_dummy|    km|            features|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+--------------------+
| 10| 10|  1|     OO|  5836|ORD|  8.18|      51|   27|    0.0|(7,[0],[1.0])| 253.0|(8,[0,1],[253.0,1...|
|  1|  4|  1|     OO|  5866|ORD|  15.5|     102| null|    0.0|(7,[0],[1.0])| 750.0|(8,[0,1],[750.0,1...|
| 11| 22|  1|     OO|  6016|ORD|  7.17|     127|  -19|    0.0|(7,[0],[1.0])|1188.0|(8,[0,1],[1188.0,...|
|  2| 14|  5|     B6|   199|JFK| 21.17|     365|   60|    2.0|(7,[2],[1.0])|3618.0|(8,[0,3],[3618.0,...|
|  5| 25|  3|     WN|  1675|SJC| 12.92|      85|   22|    5.0|(7,[5],[1.0])| 621.0|(8,[0,6],[621.0,1...|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+--------------------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a regression object and train on training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;featuresCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create predictions for the test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate the RMSE on test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metricName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rmse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;11.068844362217451&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Interpreting-coefficients&quot;&gt;Interpreting coefficients&lt;a class=&quot;anchor-link&quot; href=&quot;#Interpreting-coefficients&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Remember that origin airport, &lt;code&gt;org&lt;/code&gt;, has eight possible values (ORD, SFO, JFK, LGA, SMF, SJC, TUS and OGG) which have been one-hot encoded to seven dummy variables in &lt;code&gt;org_dummy&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The values for &lt;code&gt;km&lt;/code&gt; and &lt;code&gt;org_dummy&lt;/code&gt; have been assembled into features, which has eight columns with sparse representation. Column indices in features are as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;0 — &lt;code&gt;km&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;1 — &lt;code&gt;ORD&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;2 — &lt;code&gt;SFO&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;3 — &lt;code&gt;JFK&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;4 — &lt;code&gt;LGA&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;5 — &lt;code&gt;SMF&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;6 — &lt;code&gt;SJC&lt;/code&gt; and&lt;/li&gt;
&lt;li&gt;7 — &lt;code&gt;TUS&lt;/code&gt;.
Note that &lt;code&gt;OGG&lt;/code&gt; does not appear in this list because it is the reference level for the origin airport category.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this exercise you'll be using the &lt;code&gt;intercept&lt;/code&gt; and &lt;code&gt;coefficients&lt;/code&gt; attributes to interpret the model.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;coefficients&lt;/code&gt; attribute is a list, where the first element indicates how flight duration changes with flight distance.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Average speed in km per hour&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_speed_hour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg_speed_hour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Averate minutes on ground at OGG&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;inter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intercept&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average minutes on ground at JFK&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_ground_jfk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg_ground_jfk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average minutes on ground at LGA&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_ground_lga&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg_ground_lga&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;807.3348263721097
16.056291454658716
68.7530254980533
62.839478468083115
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Bucketing-&amp;amp;-Engineering&quot;&gt;Bucketing &amp;amp; Engineering&lt;a class=&quot;anchor-link&quot; href=&quot;#Bucketing-&amp;amp;-Engineering&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Bucketing
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/bucketing.png&quot; alt=&quot;bucket&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Bucketing-departure-time&quot;&gt;Bucketing departure time&lt;a class=&quot;anchor-link&quot; href=&quot;#Bucketing-departure-time&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Time of day data are a challenge with regression models. They are also a great candidate for bucketing.&lt;/p&gt;
&lt;p&gt;In this lesson you will convert the flight departure times from numeric values between 0 (corresponding to &quot;00:00&quot;) and 24 (corresponding to &quot;24:00&quot;) to binned values. You'll then take those binned values and one-hot encode them.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Bucketizer&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create buckets at 3 hour intervals through the day&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buckets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Bucketizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;depart&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;depart_bucket&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Bucket the departure times&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bucketed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buckets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bucketed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;depart&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart_bucket&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a one-hot encoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;depart_bucket&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;depart_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# One-hot encode the bucketed departure times&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucketed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucketed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;depart&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart_bucket&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+------+-------------+
|depart|depart_bucket|
+------+-------------+
|  8.18|          2.0|
|  15.5|          5.0|
|  7.17|          2.0|
| 21.17|          7.0|
| 12.92|          4.0|
+------+-------------+
only showing top 5 rows

+------+-------------+-------------+
|depart|depart_bucket| depart_dummy|
+------+-------------+-------------+
|  8.18|          2.0|(7,[2],[1.0])|
|  15.5|          5.0|(7,[5],[1.0])|
|  7.17|          2.0|(7,[2],[1.0])|
| 21.17|          7.0|    (7,[],[])|
| 12.92|          4.0|(7,[4],[1.0])|
+------+-------------+-------------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Flight-duration-model---Adding-departure-time&quot;&gt;Flight duration model - Adding departure time&lt;a class=&quot;anchor-link&quot; href=&quot;#Flight-duration-model---Adding-departure-time&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In the previous exercise the departure time was bucketed and converted to dummy variables. Now you're going to include those dummy variables in a regression model for flight duration.&lt;/p&gt;
&lt;p&gt;The data are in &lt;code&gt;flights&lt;/code&gt;. The &lt;code&gt;km&lt;/code&gt;, &lt;code&gt;org_dummy&lt;/code&gt; and &lt;code&gt;depart_dummy&lt;/code&gt; columns have been assembled into &lt;code&gt;features&lt;/code&gt;, where &lt;code&gt;km&lt;/code&gt; is index 0, &lt;code&gt;org_dummy&lt;/code&gt; runs from index 1 to 7 and &lt;code&gt;depart_dummy&lt;/code&gt; from index 8 to 14.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+--------------------+
|mon|dom|dow|carrier|flight|org|depart|duration|delay|org_idx|    org_dummy|    km|depart_bucket| depart_dummy|            features|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+--------------------+
| 10| 10|  1|     OO|  5836|ORD|  8.18|      51|   27|    0.0|(7,[0],[1.0])| 253.0|          2.0|(7,[2],[1.0])|(15,[0,1,10],[253...|
|  1|  4|  1|     OO|  5866|ORD|  15.5|     102| null|    0.0|(7,[0],[1.0])| 750.0|          5.0|(7,[5],[1.0])|(15,[0,1,13],[750...|
| 11| 22|  1|     OO|  6016|ORD|  7.17|     127|  -19|    0.0|(7,[0],[1.0])|1188.0|          2.0|(7,[2],[1.0])|(15,[0,1,10],[118...|
|  2| 14|  5|     B6|   199|JFK| 21.17|     365|   60|    2.0|(7,[2],[1.0])|3618.0|          7.0|    (7,[],[])|(15,[0,3],[3618.0...|
|  5| 25|  3|     WN|  1675|SJC| 12.92|      85|   22|    5.0|(7,[5],[1.0])| 621.0|          4.0|(7,[4],[1.0])|(15,[0,6,12],[621...|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+--------------------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train with training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metricName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rmse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average minutes on ground at OGG for flights departing between 21:00 and 24:00&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_eve_ogg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intercept&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg_eve_ogg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average minutes on ground at OGG for flights departing between 00:00 and 03:00&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_night_ogg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intercept&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg_night_ogg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average minutes on ground at JFK for flights departing between 00:00 and 03:00&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_night_jfk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intercept&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg_night_jfk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;10.373606920439098
-4.299103533053989
47.724554377263395
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Regularization&quot;&gt;Regularization&lt;a class=&quot;anchor-link&quot; href=&quot;#Regularization&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Feature Selection
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/feature_selection.png&quot; alt=&quot;fs&quot; /&gt;&lt;/li&gt;
&lt;li&gt;Loss function&lt;ul&gt;
&lt;li&gt;Linear regression aims to minimize the MSE

$$ MSE = \frac{1}{N} \sum_{i=1}^{N}(y_i - \hat{y_i})^2 $$
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Loss function with regularization&lt;ul&gt;
&lt;li&gt;Add a regularization term which depends on coefficients

$$ MSE = \frac{1}{N} \sum_{i=1}^{N}(y_i - \hat{y_i})^2 + \lambda f(\beta) $$
&lt;/li&gt;
&lt;li&gt;Regularizer&lt;ul&gt;
&lt;li&gt;Lasso - absolute value of the coefficients&lt;/li&gt;
&lt;li&gt;Ridge - square of the coefficients&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Both will shrink the coefficients of unimportant predictors&lt;/li&gt;
&lt;li&gt;Strength of regularization determined by parameter $\lambda$:&lt;ul&gt;
&lt;li&gt;$\lambda = 0$ - no regularization (standard regression)&lt;/li&gt;
&lt;li&gt;$\lambda = \infty$ - complete regularization (all coefficients zero)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Flight-duration-model---More-features!&quot;&gt;Flight duration model - More features!&lt;a class=&quot;anchor-link&quot; href=&quot;#Flight-duration-model---More-features!&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Let's add more features to our model. This will not necessarily result in a better model. Adding some features might improve the model. Adding other features might make it worse.&lt;/p&gt;
&lt;p&gt;More features will always make the model more complicated and difficult to interpret.&lt;/p&gt;
&lt;p&gt;These are the features you'll include in the next model:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;km&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;org&lt;/code&gt; (origin airport, one-hot encoded, 8 levels)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;depart&lt;/code&gt; (departure time, binned in 3 hour intervals, one-hot encoded, 8 levels)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dow&lt;/code&gt; (departure day of week, one-hot encoded, 7 levels) and&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mon&lt;/code&gt; (departure month, one-hot encoded, 12 levels).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These have been assembled into the &lt;code&gt;features&lt;/code&gt; column, which is a sparse representation of 32 columns (remember one-hot encoding produces a number of columns which is one fewer than the number of levels).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dow&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dow_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mon&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mon_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onehot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+--------------------+-------------+---------------+
|mon|dom|dow|carrier|flight|org|depart|duration|delay|org_idx|    org_dummy|    km|depart_bucket| depart_dummy|            features|    dow_dummy|      mon_dummy|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+--------------------+-------------+---------------+
| 10| 10|  1|     OO|  5836|ORD|  8.18|      51|   27|    0.0|(7,[0],[1.0])| 253.0|          2.0|(7,[2],[1.0])|(15,[0,1,10],[253...|(6,[1],[1.0])|(11,[10],[1.0])|
|  1|  4|  1|     OO|  5866|ORD|  15.5|     102| null|    0.0|(7,[0],[1.0])| 750.0|          5.0|(7,[5],[1.0])|(15,[0,1,13],[750...|(6,[1],[1.0])| (11,[1],[1.0])|
| 11| 22|  1|     OO|  6016|ORD|  7.17|     127|  -19|    0.0|(7,[0],[1.0])|1188.0|          2.0|(7,[2],[1.0])|(15,[0,1,10],[118...|(6,[1],[1.0])|     (11,[],[])|
|  2| 14|  5|     B6|   199|JFK| 21.17|     365|   60|    2.0|(7,[2],[1.0])|3618.0|          7.0|    (7,[],[])|(15,[0,3],[3618.0...|(6,[5],[1.0])| (11,[2],[1.0])|
|  5| 25|  3|     WN|  1675|SJC| 12.92|      85|   22|    5.0|(7,[5],[1.0])| 621.0|          4.0|(7,[4],[1.0])|(15,[0,6,12],[621...|(6,[3],[1.0])| (11,[5],[1.0])|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+--------------------+-------------+---------------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;org_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dow_dummy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mon_dummy&amp;#39;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+-------------+---------------+--------------------+
|mon|dom|dow|carrier|flight|org|depart|duration|delay|org_idx|    org_dummy|    km|depart_bucket| depart_dummy|    dow_dummy|      mon_dummy|            features|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+-------------+---------------+--------------------+
| 10| 10|  1|     OO|  5836|ORD|  8.18|      51|   27|    0.0|(7,[0],[1.0])| 253.0|          2.0|(7,[2],[1.0])|(6,[1],[1.0])|(11,[10],[1.0])|(32,[0,1,10,16,31...|
|  1|  4|  1|     OO|  5866|ORD|  15.5|     102| null|    0.0|(7,[0],[1.0])| 750.0|          5.0|(7,[5],[1.0])|(6,[1],[1.0])| (11,[1],[1.0])|(32,[0,1,13,16,22...|
| 11| 22|  1|     OO|  6016|ORD|  7.17|     127|  -19|    0.0|(7,[0],[1.0])|1188.0|          2.0|(7,[2],[1.0])|(6,[1],[1.0])|     (11,[],[])|(32,[0,1,10,16],[...|
|  2| 14|  5|     B6|   199|JFK| 21.17|     365|   60|    2.0|(7,[2],[1.0])|3618.0|          7.0|    (7,[],[])|(6,[5],[1.0])| (11,[2],[1.0])|(32,[0,3,20,23],[...|
|  5| 25|  3|     WN|  1675|SJC| 12.92|      85|   22|    5.0|(7,[5],[1.0])| 621.0|          4.0|(7,[4],[1.0])|(6,[3],[1.0])| (11,[5],[1.0])|(32,[0,6,12,18,26...|
+---+---+---+-------+------+---+------+--------+-----+-------+-------------+------+-------------+-------------+-------------+---------------+--------------------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fit linear regressino model to training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make predictions on test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate the RMSE on test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rmse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metricName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rmse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;The test RMSE is&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rmse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Look at the model coefficients&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;The test RMSE is 10.819088448211174
[0.07439903800595218,27.088541106962648,20.013200394243466,52.01818052724308,46.01830850977673,15.12491382457755,17.232738296408332,17.325183703296005,-14.71676008382402,-0.07217427091906863,4.005627327038735,7.010732946075667,4.716908120668705,8.858558301158828,8.985587137355129,-0.061725588783170936,-0.13593336494158573,-0.13496036395705654,-0.1433810465959523,-0.0442906254733511,-0.112404653935452,-1.8896756270865185,-1.8943555316508267,-1.9673036696221473,-3.395290942653575,-4.020286290569159,-3.830521589483759,-3.9812556715824035,-4.012225573392499,-3.8464412463732764,-2.630301804480476,-0.41142966468087394]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Flight-duration-model---Regularization!&quot;&gt;Flight duration model - Regularization!&lt;a class=&quot;anchor-link&quot; href=&quot;#Flight-duration-model---Regularization!&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In the previous exercise you added more predictors to the flight duration model. The model performed well on testing data, but with so many coefficients it was difficult to interpret.&lt;/p&gt;
&lt;p&gt;In this exercise you'll use Lasso regression (regularized with a L1 penalty) to create a more parsimonious model. Many of the coefficients in the resulting model will be set to zero. This means that only a subset of the predictors actually contribute to the model. Despite the simpler model, it still produces a good RMSE on the testing data.&lt;/p&gt;
&lt;p&gt;You'll use a specific value for the regularization strength. Later you'll learn how to find the best value using cross validation.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Fit Lasso model (α = 1) to training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regParam&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elasticNetParam&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate the RMSE on testing data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rmse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegressionEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labelCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metricName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rmse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;The test RMSE is&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rmse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Look at the model coefficients&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Number of zero coefficients&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zero_coeff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Number of coefficients equal to 0:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zero_coeff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;The test RMSE is 11.755155956333065
[0.07355997996294984,5.410341029649853,0.0,29.289003982755304,22.26237552623214,-2.1151843901573755,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0987079734966165,1.3500916409600519,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]
Number of coefficients equal to 0: 25
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/bucketing.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/bucketing.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Classification in PySpark</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/03-Classification-in-PySpark.html" rel="alternate" type="text/html" title="Classification in PySpark" /><published>2020-08-10T00:00:00-05:00</published><updated>2020-08-10T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/03-Classification-in-PySpark</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/03-Classification-in-PySpark.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-10-03-Classification-in-PySpark.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Data-Preparation&quot;&gt;Data Preparation&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-Preparation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Removing-columns-and-rows&quot;&gt;Removing columns and rows&lt;a class=&quot;anchor-link&quot; href=&quot;#Removing-columns-and-rows&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You previously loaded airline flight data from a CSV file. You're going to develop a model which will predict whether or not a given flight will be delayed.&lt;/p&gt;
&lt;p&gt;In this exercise you need to trim those data down by:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;removing an uninformative column and&lt;/li&gt;
&lt;li&gt;removing rows which do not have information about whether or not a flight was delayed.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;local[*]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;flights&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read data from CSV file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/flights-larger.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inferSchema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;nullValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;NA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+------+---+----+------+--------+-----+
|mon|dom|dow|carrier|flight|org|mile|depart|duration|delay|
+---+---+---+-------+------+---+----+------+--------+-----+
| 10| 10|  1|     OO|  5836|ORD| 157|  8.18|      51|   27|
|  1|  4|  1|     OO|  5866|ORD| 466|  15.5|     102| null|
| 11| 22|  1|     OO|  6016|ORD| 738|  7.17|     127|  -19|
|  2| 14|  5|     B6|   199|JFK|2248| 21.17|     365|   60|
|  5| 25|  3|     WN|  1675|SJC| 386| 12.92|      85|   22|
+---+---+---+-------+------+---+----+------+--------+-----+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Remove the &amp;#39;flight&amp;#39; column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_drop_column&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;flight&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Number of records with missing &amp;#39;delay&amp;#39; values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_drop_column&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;delay IS NULL&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Remove records with missing &amp;#39;delay&amp;#39; values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_valid_delay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_drop_column&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;delay IS NOT NULL&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Remove records with missing values in any column and get the number of remaining rows&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_none_missing&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_valid_delay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_none_missing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;258289
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Column-manipulation&quot;&gt;Column manipulation&lt;a class=&quot;anchor-link&quot; href=&quot;#Column-manipulation&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The Federal Aviation Administration (FAA) considers a flight to be &quot;delayed&quot; when it arrives 15 minutes or more after its scheduled time.&lt;/p&gt;
&lt;p&gt;The next step of preparing the flight data has two parts:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;convert the units of distance, replacing the &lt;code&gt;mile&lt;/code&gt; column with a &lt;code&gt;kmcolumn&lt;/code&gt;; and&lt;/li&gt;
&lt;li&gt;create a Boolean column indicating whether or not a flight was delayed.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.functions&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Convert &amp;#39;mile&amp;#39; to &amp;#39;km&amp;#39; and drop &amp;#39;mile&amp;#39; column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_km&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_none_missing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_none_missing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.60934&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mile&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create &amp;#39;label&amp;#39; column indicating whether flight delayed (1) or not(0)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_km&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_km&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_km&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Check first five records&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_km&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+---+---+-------+---+------+--------+-----+------+-----+
|mon|dom|dow|carrier|org|depart|duration|delay|    km|label|
+---+---+---+-------+---+------+--------+-----+------+-----+
| 10| 10|  1|     OO|ORD|  8.18|      51|   27| 253.0|    1|
| 11| 22|  1|     OO|ORD|  7.17|     127|  -19|1188.0|    0|
|  2| 14|  5|     B6|JFK| 21.17|     365|   60|3618.0|    1|
|  5| 25|  3|     WN|SJC| 12.92|      85|   22| 621.0|    1|
|  3| 28|  1|     B6|LGA| 13.33|     182|   70|1732.0|    1|
+---+---+---+-------+---+------+--------+-----+------+-----+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Categorical-columns&quot;&gt;Categorical columns&lt;a class=&quot;anchor-link&quot; href=&quot;#Categorical-columns&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In the flights data there are two columns, &lt;code&gt;carrier&lt;/code&gt; and &lt;code&gt;org&lt;/code&gt;, which hold categorical data. You need to transform those columns into indexed numerical values.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an indexer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;indexer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Indexer identifies categories in the data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;indexer_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_km&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Indexer creates a new column with numeric index values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_indexed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexer_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_km&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Repeat the process for the other categorical feature&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_indexed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_indexed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_indexed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Assembling-columns&quot;&gt;Assembling columns&lt;a class=&quot;anchor-link&quot; href=&quot;#Assembling-columns&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The final stage of data preparation is to consolidate all of the predictor columns into a single column.&lt;/p&gt;
&lt;p&gt;At present our data has the following predictor columns:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;mon&lt;/code&gt;, &lt;code&gt;dom&lt;/code&gt; and &lt;code&gt;dow&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;carrier_idx&lt;/code&gt; (derived from &lt;code&gt;carrier&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;org_idx&lt;/code&gt; (derived from &lt;code&gt;org&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;km&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;depart&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;duration&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an assembler object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;mon&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dom&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dow&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;org_idx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;km&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Consolidate predictor columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_assembled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_indexed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Check the resulting column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_assembled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;delay&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;truncate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-----------------------------------------+-----+
|features                                 |delay|
+-----------------------------------------+-----+
|[10.0,10.0,1.0,2.0,0.0,253.0,8.18,51.0]  |27   |
|[11.0,22.0,1.0,2.0,0.0,1188.0,7.17,127.0]|-19  |
|[2.0,14.0,5.0,4.0,2.0,3618.0,21.17,365.0]|60   |
|[5.0,25.0,3.0,3.0,5.0,621.0,12.92,85.0]  |22   |
|[3.0,28.0,1.0,4.0,3.0,1732.0,13.33,182.0]|70   |
+-----------------------------------------+-----+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Decision-Tree&quot;&gt;Decision Tree&lt;a class=&quot;anchor-link&quot; href=&quot;#Decision-Tree&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Train/test-split&quot;&gt;Train/test split&lt;a class=&quot;anchor-link&quot; href=&quot;#Train/test-split&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;To objectively assess a Machine Learning model you need to be able to test it on an independent set of data. You can't use the same data that you used to train the model: of course the model will perform (relatively) well on those data!&lt;/p&gt;
&lt;p&gt;You will split the data into two components:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;training data (used to train the model) and&lt;/li&gt;
&lt;li&gt;testing data (used to test the model).&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Split into training and test sets in a 80:20 ratio&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_assembled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Check that training set has around 80% of records&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_ratio&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_assembled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_ratio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0.7996856234682855
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Build-a-Decision-Tree&quot;&gt;Build a Decision Tree&lt;a class=&quot;anchor-link&quot; href=&quot;#Build-a-Decision-Tree&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now that you've split the flights data into training and testing sets, you can use the training set to fit a Decision Tree model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.classification&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DecisionTreeClassifier&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a classifier object and fit to the training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tree&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DecisionTreeClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tree_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create predictions for the testing data and take a look at the predictions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tree_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;probability&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-----+----------+----------------------------------------+
|label|prediction|probability                             |
+-----+----------+----------------------------------------+
|1    |0.0       |[0.6282628262826283,0.37173717371737175]|
|1    |0.0       |[0.6282628262826283,0.37173717371737175]|
|0    |1.0       |[0.3195001440187889,0.6804998559812111] |
|1    |1.0       |[0.3195001440187889,0.6804998559812111] |
|0    |1.0       |[0.37094017094017095,0.629059829059829] |
+-----+----------+----------------------------------------+
only showing top 5 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Evaluate-the-Decision-Tree&quot;&gt;Evaluate the Decision Tree&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluate-the-Decision-Tree&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You can assess the quality of your model by evaluating how well it performs on the testing data. Because the model was not trained on these data, this represents an objective assessment of the model.&lt;/p&gt;
&lt;p&gt;A confusion matrix gives a useful breakdown of predictions versus known values. It has four cells which represent the counts of:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;True Negatives (TN) — model predicts negative outcome &amp;amp; known outcome is negative&lt;/li&gt;
&lt;li&gt;True Positives (TP) — model predicts positive outcome &amp;amp; known outcome is positive&lt;/li&gt;
&lt;li&gt;False Negatives (FN) — model predicts negative outcome but known outcome is positive&lt;/li&gt;
&lt;li&gt;False Positives (FP) — model predicts positive outcome but known outcome is negative.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create a confusion matrix&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate the elements of the confusion matrix&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction = 0 AND label = prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction = 1 AND label = prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;FN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction = 0 AND label = 1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;FP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction = 1 AND label = 0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Accuracy measures the proportion of correct predictions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-----+----------+-----+
|label|prediction|count|
+-----+----------+-----+
|    1|       0.0| 9472|
|    0|       0.0|16371|
|    1|       1.0|16643|
|    0|       1.0| 9253|
+-----+----------+-----+

0.6380873229092174
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Logistic-Regression&quot;&gt;Logistic Regression&lt;a class=&quot;anchor-link&quot; href=&quot;#Logistic-Regression&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Build-a-Logistic-Regression-model&quot;&gt;Build a Logistic Regression model&lt;a class=&quot;anchor-link&quot; href=&quot;#Build-a-Logistic-Regression-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You've already built a Decision Tree model using the flights data. Now you're going to create a Logistic Regression model on the same data.&lt;/p&gt;
&lt;p&gt;The objective is to predict whether a flight is likely to be delayed by at least 15 minutes (label 1) or not (label 0).&lt;/p&gt;
&lt;p&gt;Although you have a variety of predictors at your disposal, you'll only use the &lt;code&gt;mon&lt;/code&gt;, &lt;code&gt;depart&lt;/code&gt; and &lt;code&gt;duration&lt;/code&gt; columns for the moment. These are numerical features which can immediately be used for a Logistic Regression model. You'll need to do a little more work before you can include categorical features.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.classification&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Selecting numeric columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_train_num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;mon&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;depart&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;duration&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_test_num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;mon&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;depart&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;duration&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create classifier object and train on training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;logistic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_train_num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a predictions for the test data and show confusion matrix&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logistic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_test_num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;label&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;prediction&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-----+----------+-----+
|label|prediction|count|
+-----+----------+-----+
|    1|       0.0| 9455|
|    0|       0.0|14931|
|    1|       1.0|16660|
|    0|       1.0|10693|
+-----+----------+-----+

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Evaluate-the-Logistic-Regression-model&quot;&gt;Evaluate the Logistic Regression model&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluate-the-Logistic-Regression-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Accuracy is generally not a very reliable metric because it can be biased by the most common target class.&lt;/p&gt;
&lt;p&gt;There are two other useful metrics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;precision and&lt;/li&gt;
&lt;li&gt;recall.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Precision is the proportion of positive predictions which are correct. For all flights which are predicted to be delayed, what proportion is actually delayed?&lt;/p&gt;
&lt;p&gt;Recall is the proportion of positives outcomes which are correctly predicted. For all delayed flights, what proportion is correctly predicted by the model?&lt;/p&gt;
&lt;p&gt;The precision and recall are generally formulated in terms of the positive target class. But it's also possible to calculate weighted versions of these metrics which look at both target classes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Calculate the elements of the confusion matrix&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction = 0 AND label = prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction = 1 AND label = prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;FN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction = 0 AND label = 1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;FP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction = 1 AND label = 0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.evaluation&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MulticlassClassificationEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BinaryClassificationEvaluator&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate precision and recall&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;precision&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;recall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;precision = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;recall   = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precision&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Find weighted precision&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;multi_evaluator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MulticlassClassificationEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;weighted_precision&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;multi_evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metricName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;weightedPrecision&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Find AUC&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;binary_evaluator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BinaryClassificationEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;auc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;binary_evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;binary_evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metricName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;areaUnderROC&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;precision = 0.61
recall   = 0.64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weighted_precision&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;auc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0.6106605467579678
0.6504917093209514
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Turning-Text-into-Tables&quot;&gt;Turning Text into Tables&lt;a class=&quot;anchor-link&quot; href=&quot;#Turning-Text-into-Tables&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Punctuation,-numbers-and-tokens&quot;&gt;Punctuation, numbers and tokens&lt;a class=&quot;anchor-link&quot; href=&quot;#Punctuation,-numbers-and-tokens&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;At the end of the previous chapter you loaded a dataset of SMS messages which had been labeled as either &quot;spam&quot; (label 1) or &quot;ham&quot; (label 0). You're now going to use those data to build a classifier model.&lt;/p&gt;
&lt;p&gt;But first you'll need to prepare the SMS messages as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;remove punctuation and numbers&lt;/li&gt;
&lt;li&gt;tokenize (split into individual words)&lt;/li&gt;
&lt;li&gt;remove stop words&lt;/li&gt;
&lt;li&gt;apply the hashing trick&lt;/li&gt;
&lt;li&gt;convert to TF-IDF representation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this exercise you'll remove punctuation and numbers, then tokenize the messages.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.types&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Specify column names and types&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;label&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Load data from a delimited file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/sms.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.functions&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regexp_replace&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tokenizer&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Remove punctuation (REGEX provided) and numbers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regexp_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;[_():;,.!?&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;-]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regexp_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;[0-9]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Merge multiple spaces&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regexp_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; +&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Split the text into words&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;words&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;truncate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+----------------------------------+-----+------------------------------------------+
|id |text                              |label|words                                     |
+---+----------------------------------+-----+------------------------------------------+
|1  |Sorry I&amp;#39;ll call later in meeting  |0    |[sorry, i&amp;#39;ll, call, later, in, meeting]   |
|2  |Dont worry I guess he&amp;#39;s busy      |0    |[dont, worry, i, guess, he&amp;#39;s, busy]       |
|3  |Call FREEPHONE now                |1    |[call, freephone, now]                    |
|4  |Win a cash prize or a prize worth |1    |[win, a, cash, prize, or, a, prize, worth]|
+---+----------------------------------+-----+------------------------------------------+
only showing top 4 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Stop-words-and-hashing&quot;&gt;Stop words and hashing&lt;a class=&quot;anchor-link&quot; href=&quot;#Stop-words-and-hashing&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The next steps will be to remove stop words and then apply the hashing trick, converting the results into a TF-IDF.&lt;/p&gt;
&lt;p&gt;A quick reminder about these concepts:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The hashing trick provides a fast and space-efficient way to map a very large (possibly infinite) set of items (in this case, all words contained in the SMS messages) onto a smaller, finite number of values.&lt;/li&gt;
&lt;li&gt;The TF-IDF matrix reflects how important a word is to each document. It takes into account both the frequency of the word within each document but also the frequency of the word across all of the documents in the collection.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StopWordsRemover&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HashingTF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IDF&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;words&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Remove stop words.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StopWordsRemover&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;words&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;terms&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Apply the hashing trick&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HashingTF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;terms&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hash&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numFeatures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Convert hashed symbols to TF-IDF&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tf_idf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IDF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hash&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrangled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;tf_idf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;terms&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;truncate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+--------------------------------+----------------------------------------------------------------------------------------------------+
|terms                           |features                                                                                            |
+--------------------------------+----------------------------------------------------------------------------------------------------+
|[sorry, call, later, meeting]   |(1024,[138,384,577,996],[2.273418200008753,3.6288353225642043,3.5890949939146903,4.104259019279279])|
|[dont, worry, guess, busy]      |(1024,[215,233,276,329],[3.9913186080986836,3.3790235241678332,4.734227298217693,4.58299632849377]) |
|[call, freephone]               |(1024,[133,138],[5.367951058306837,2.273418200008753])                                              |
|[win, cash, prize, prize, worth]|(1024,[31,47,62,389],[3.6632029660684124,4.754846585420428,4.072170704727778,7.064594791043114])    |
+--------------------------------+----------------------------------------------------------------------------------------------------+
only showing top 4 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Training-a-spam-classifier&quot;&gt;Training a spam classifier&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-a-spam-classifier&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The SMS data have now been prepared for building a classifier. Specifically, this is what you have done:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;removed numbers and punctuation&lt;/li&gt;
&lt;li&gt;split the messages into words (or &quot;tokens&quot;)&lt;/li&gt;
&lt;li&gt;removed stop words&lt;/li&gt;
&lt;li&gt;applied the hashing trick and&lt;/li&gt;
&lt;li&gt;converted to a TF-IDF representation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Next you'll need to split the TF-IDF data into training and testing sets. Then you'll use the training data to fit a Logistic Regression model and finally evaluate the performance of that model on the testing data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf_idf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Split the data into training and test sets&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sms_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sms_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fit a Logistic Regression model to the training data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;logistic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regParam&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sms_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make predictions on the test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logistic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sms_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a confusion matrix, comparing predictions to known labels&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-----+----------+-----+
|label|prediction|count|
+-----+----------+-----+
|    1|       0.0|   39|
|    0|       0.0|  932|
|    1|       1.0|  121|
|    0|       1.0|    4|
+-----+----------+-----+

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary></entry><entry><title type="html">Machine Learning with PySpark - Introduction</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/02-Machine-Learning-with-PySpark-introduction.html" rel="alternate" type="text/html" title="Machine Learning with PySpark - Introduction" /><published>2020-08-10T00:00:00-05:00</published><updated>2020-08-10T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/02-Machine-Learning-with-PySpark-introduction</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/02-Machine-Learning-with-PySpark-introduction.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-10-02-Machine-Learning-with-PySpark-introduction.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Machine-Learning-&amp;amp;-Spark&quot;&gt;Machine Learning &amp;amp; Spark&lt;a class=&quot;anchor-link&quot; href=&quot;#Machine-Learning-&amp;amp;-Spark&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/data_distributed.png&quot; alt=&quot;dist&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spark&lt;ul&gt;
&lt;li&gt;Compute accross a distributed cluster.&lt;/li&gt;
&lt;li&gt;Data processed in memory&lt;/li&gt;
&lt;li&gt;Well documented high level API
&lt;img src=&quot;/chans_jupyter/images/copied_from_nb/image/spark_process.png&quot; alt=&quot;process&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Connecting-to-Spark&quot;&gt;Connecting to Spark&lt;a class=&quot;anchor-link&quot; href=&quot;#Connecting-to-Spark&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Creating-a-SparkSession&quot;&gt;Creating a SparkSession&lt;a class=&quot;anchor-link&quot; href=&quot;#Creating-a-SparkSession&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In this exercise, you'll spin up a local Spark cluster using all available cores. The cluster will be accessible via a SparkSession object.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;SparkSession&lt;/code&gt; class has a builder attribute, which is an instance of the &lt;code&gt;Builder&lt;/code&gt; class. The &lt;code&gt;Builder&lt;/code&gt; class exposes three important methods that let you:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;specify the location of the master node;&lt;/li&gt;
&lt;li&gt;name the application (optional); and&lt;/li&gt;
&lt;li&gt;retrieve an existing &lt;code&gt;SparkSession&lt;/code&gt; or, if there is none, create a new one.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;code&gt;SparkSession&lt;/code&gt; class has a &lt;a href=&quot;/chans_jupyter/images/copied_from_nb/version&quot;&gt;&lt;code&gt;version&lt;/code&gt;&lt;/a&gt; attribute which gives the version of Spark.&lt;/p&gt;
&lt;p&gt;Find out more about &lt;code&gt;SparkSession&lt;/code&gt; &lt;a href=&quot;https://spark.apache.org/docs/3.0.0/api/python/pyspark.sql.html#pyspark.sql.SparkSession&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Once you are finished with the cluster, it's a good idea to shut it down, which will free up its resources, making them available for other processes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create SparkSession object&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;local[*]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# What version of Spark?&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Terminate the cluster&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3.0.0
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Loading-Data&quot;&gt;Loading Data&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-Data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Loading-flights-data&quot;&gt;Loading flights data&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-flights-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In this exercise you're going to load some airline flight data from a CSV file. To ensure that the exercise runs quickly these data have been trimmed down to only 50 000 records. You can get a larger dataset in the same format &lt;a href=&quot;https://assets.datacamp.com/production/repositories/3918/datasets/e1c1a03124fb2199743429e9b7927df18da3eacf/flights-larger.csv&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Notes on CSV format:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;fields are separated by a comma (this is the default separator) and&lt;/li&gt;
&lt;li&gt;missing data are denoted by the string 'NA'.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Data dictionary:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;mon&lt;/code&gt; — month (integer between 1 and 12)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dom&lt;/code&gt; — day of month (integer between 1 and 31)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dow&lt;/code&gt; — day of week (integer; 1 = Monday and 7 = Sunday)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;org&lt;/code&gt; — origin airport (IATA code)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mile&lt;/code&gt; — distance (miles)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;carrier&lt;/code&gt; — carrier (IATA code)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;depart&lt;/code&gt; — departure time (decimal hour)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;duration&lt;/code&gt; — expected duration (minutes)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;delay&lt;/code&gt; — delay (minutes)&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;local[*]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;flights&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read data from CSV file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/flights-larger.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inferSchema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;nullValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;NA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get number of records&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;The data contain &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; records.&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# View the first five records&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Check column data types&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtypes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;The data contain 275000 records.
+---+---+---+-------+------+---+----+------+--------+-----+
|mon|dom|dow|carrier|flight|org|mile|depart|duration|delay|
+---+---+---+-------+------+---+----+------+--------+-----+
| 10| 10|  1|     OO|  5836|ORD| 157|  8.18|      51|   27|
|  1|  4|  1|     OO|  5866|ORD| 466|  15.5|     102| null|
| 11| 22|  1|     OO|  6016|ORD| 738|  7.17|     127|  -19|
|  2| 14|  5|     B6|   199|JFK|2248| 21.17|     365|   60|
|  5| 25|  3|     WN|  1675|SJC| 386| 12.92|      85|   22|
+---+---+---+-------+------+---+----+------+--------+-----+
only showing top 5 rows

root
 |-- mon: integer (nullable = true)
 |-- dom: integer (nullable = true)
 |-- dow: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- flight: integer (nullable = true)
 |-- org: string (nullable = true)
 |-- mile: integer (nullable = true)
 |-- depart: double (nullable = true)
 |-- duration: integer (nullable = true)
 |-- delay: integer (nullable = true)

None
[(&amp;#39;mon&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;dom&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;dow&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;carrier&amp;#39;, &amp;#39;string&amp;#39;), (&amp;#39;flight&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;org&amp;#39;, &amp;#39;string&amp;#39;), (&amp;#39;mile&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;depart&amp;#39;, &amp;#39;double&amp;#39;), (&amp;#39;duration&amp;#39;, &amp;#39;int&amp;#39;), (&amp;#39;delay&amp;#39;, &amp;#39;int&amp;#39;)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Loading-SMS-spam-data&quot;&gt;Loading SMS spam data&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-SMS-spam-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You've seen that it's possible to infer data types directly from the data. Sometimes it's convenient to have direct control over the column types. You do this by defining an explicit schema.&lt;/p&gt;
&lt;p&gt;The file &lt;code&gt;sms.csv&lt;/code&gt; contains a selection of SMS messages which have been classified as either 'spam' or 'ham'. These data have been adapted from the &lt;a href=&quot;https://archive.ics.uci.edu/ml/datasets/sms+spam+collection&quot;&gt;UCI Machine Learning Repository&lt;/a&gt;. There are a total of 5574 SMS, of which 747 have been labelled as spam.&lt;/p&gt;
&lt;p&gt;Notes on CSV format:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;no header record and&lt;/li&gt;
&lt;li&gt;fields are separated by a semicolon (this is not the default separator).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Data dictionary:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;id&lt;/code&gt; — record identifier&lt;/li&gt;
&lt;li&gt;&lt;code&gt;text&lt;/code&gt; — content of SMS message&lt;/li&gt;
&lt;li&gt;&lt;code&gt;label&lt;/code&gt; — spam or ham (integer; 0 = ham and 1 = spam)&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.types&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Specify column names and types&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;label&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Load data from a delimited file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/sms.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Print schema of DataFrame&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;root
 |-- id: integer (nullable = true)
 |-- text: string (nullable = true)
 |-- label: integer (nullable = true)

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/spark_process.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/spark_process.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Model tuning and selection in PySpark</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/01-Model-tuning-and-selection-in-PySpark.html" rel="alternate" type="text/html" title="Model tuning and selection in PySpark" /><published>2020-08-10T00:00:00-05:00</published><updated>2020-08-10T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/01-Model-tuning-and-selection-in-PySpark</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/10/01-Model-tuning-and-selection-in-PySpark.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-10-01-Model-tuning-and-selection-in-PySpark.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;What-is-logistic-regression?&quot;&gt;What is logistic regression?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-logistic-regression?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The model you'll be fitting in this chapter is called a logistic regression. This model is very similar to a linear regression, but instead of predicting a numeric variable, it predicts the probability (between 0 and 1) of an event.&lt;/p&gt;
&lt;p&gt;To use this as a classification algorithm, all you have to do is assign a cutoff point to these probabilities. If the predicted probability is above the cutoff point, you classify that observation as a 'yes' (in this case, the flight being late), if it's below, you classify it as a 'no'!&lt;/p&gt;
&lt;p&gt;You'll tune this model by testing different values for several hyperparameters. A hyperparameter is just a value in the model that's not estimated from the data, but rather is supplied by the user to maximize performance. For this course it's not necessary to understand the mathematics behind all of these values - what's important is that you'll try out a few different choices and pick the best one.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-the-modeler&quot;&gt;Create the modeler&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-modeler&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;Estimator&lt;/code&gt; you'll be using is a &lt;code&gt;LogisticRegression&lt;/code&gt; from the &lt;code&gt;pyspark.ml.classification&lt;/code&gt; submodule.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;flights&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.classification&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a LogisticRegression Estimator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Cross-validation&quot;&gt;Cross validation&lt;a class=&quot;anchor-link&quot; href=&quot;#Cross-validation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the next few exercises you'll be tuning your logistic regression model using a procedure called k-fold cross validation. This is a method of estimating the model's performance on unseen data (like your &lt;a href=&quot;/chans_jupyter/images/copied_from_nb/test&quot;&gt;&lt;code&gt;test&lt;/code&gt;&lt;/a&gt; DataFrame).&lt;/p&gt;
&lt;p&gt;It works by splitting the training data into a few different partitions. The exact number is up to you, but in this course you'll be using PySpark's default value of three. Once the data is split up, one of the partitions is set aside, and the model is fit to the others. Then the error is measured against the held out partition. This is repeated for each of the partitions, so that every block of data is held out and used as a test set exactly once. Then the error on each of the partitions is averaged. This is called the cross validation error of the model, and is a good estimate of the actual error on the held out data.&lt;/p&gt;
&lt;p&gt;You'll be using cross validation to choose the hyperparameters by creating a grid of the possible pairs of values for the two hyperparameters, &lt;code&gt;elasticNetParam&lt;/code&gt; and &lt;code&gt;regParam&lt;/code&gt;, and using the cross validation error to compare all the different models so you can choose the best one!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-the-evaluator&quot;&gt;Create the evaluator&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-evaluator&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The first thing you need when doing cross validation for model selection is a way to compare different models. Luckily, the &lt;code&gt;pyspark.ml.evaluation&lt;/code&gt; submodule has classes for evaluating different kinds of models. Your model is a binary classification model, so you'll be using the &lt;code&gt;BinaryClassificationEvaluator&lt;/code&gt; from the &lt;code&gt;pyspark.ml.evaluation&lt;/code&gt; module.&lt;/p&gt;
&lt;p&gt;This evaluator calculates the area under the ROC. This is a metric that combines the two kinds of errors a binary classifier can make (false positives and false negatives) into a simple number. You'll learn more about this towards the end of the chapter!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.evaluation&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;evals&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a BinaryClassificationEvaluator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BinaryClassificationEvaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metricName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;areaUnderROC&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Make-a-grid&quot;&gt;Make a grid&lt;a class=&quot;anchor-link&quot; href=&quot;#Make-a-grid&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Next, you need to create a grid of values to search over when looking for the optimal hyperparameters. The submodule &lt;code&gt;pyspark.ml.tuning&lt;/code&gt; includes a class called &lt;code&gt;ParamGridBuilder&lt;/code&gt; that does just that (maybe you're starting to notice a pattern here; PySpark has a submodule for just about everything!).&lt;/p&gt;
&lt;p&gt;You'll need to use the &lt;code&gt;.addGrid()&lt;/code&gt; and &lt;code&gt;.build()&lt;/code&gt; methods to create a grid that you can use for cross validation. The &lt;code&gt;.addGrid()&lt;/code&gt; method takes a model parameter (an attribute of the model &lt;code&gt;Estimator&lt;/code&gt;, &lt;code&gt;lr&lt;/code&gt;, that you created a few exercises ago) and a list of values that you want to try. The &lt;code&gt;.build()&lt;/code&gt; method takes no arguments, it just returns the grid that you'll use later.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.tuning&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tune&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the parameter grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tune&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ParamGridBuilder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add the hyperparameter&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;regParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elasticNetParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Build the grid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Make-the-validator&quot;&gt;Make the validator&lt;a class=&quot;anchor-link&quot; href=&quot;#Make-the-validator&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The submodule &lt;code&gt;pyspark.ml.tuning&lt;/code&gt; also has a class called &lt;code&gt;CrossValidator&lt;/code&gt; for performing cross validation. This &lt;code&gt;Estimator&lt;/code&gt; takes the modeler you want to fit, the grid of hyperparameters you created, and the evaluator you want to use to compare your models.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create the CrossValidator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tune&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CrossValidator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;estimatorParamMaps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Fit-the-model(s)&quot;&gt;Fit the model(s)&lt;a class=&quot;anchor-link&quot; href=&quot;#Fit-the-model(s)&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You're finally ready to fit the models and select the best one!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Building-Training/Test-set&quot;&gt;Building Training/Test set&lt;a class=&quot;anchor-link&quot; href=&quot;#Building-Training/Test-set&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pipeline&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;inferSchema&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;header&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;./dataset/flights_small.csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createOrReplaceTempView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;flights&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;inferSchema&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;header&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/planes.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createOrReplaceTempView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;planes&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Rename year column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumnRenamed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;plane_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Join the DataFrame&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tailnum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;leftouter&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Cast the columns to integers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;arr_delay&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr_delay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;air_time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;plane_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plane_year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the column plane_age&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;plane_age&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plane_year&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create is_late&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;is_late&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr_delay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Convert to an integer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_late&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Remove missing values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;arr_delay is not NULL and dep_delay is not NULL and &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;                               air_time is not NULL and plane_year is not NULL&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create StringIndexer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;carr_indexer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a OneHotEncoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;carr_encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_fact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a StringIndexer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dest_indexer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a OneHotEncoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dest_encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest_fact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make a VectorAssembler&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vec_assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;air_time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_fact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dest_fact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;plane_age&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make the pipeline&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_pipe&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dest_indexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest_encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;carr_indexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;carr_encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vec_assembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fit and transform the data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;piped_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_pipe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Split the data into training and test sets&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;piped_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Call lr.fit()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;best_lr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Print best_lr&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;LogisticRegressionModel: uid=LogisticRegression_9351d3c7e2ad, numClasses=2, numFeatures=81
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Evaluate-the-model&quot;&gt;Evaluate the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluate-the-model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;It's finally time to test your model on it! You can use the same evaluator you made to fit the model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Use the model to predict the test set&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Evaluate the predictions&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0.7031047941756943
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/spark.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/spark.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Getting started with machine learning pipelines in PySpark</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/09/02-Getting-started-with-machine-learning-pipelines-in-PySpark.html" rel="alternate" type="text/html" title="Getting started with machine learning pipelines in PySpark" /><published>2020-08-09T00:00:00-05:00</published><updated>2020-08-09T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/09/02-Getting-started-with-machine-learning-pipelines-in-PySpark</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/machine_learning/2020/08/09/02-Getting-started-with-machine-learning-pipelines-in-PySpark.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-09-02-Getting-started-with-machine-learning-pipelines-in-PySpark.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Machine-Learning-Pipelines&quot;&gt;Machine Learning Pipelines&lt;a class=&quot;anchor-link&quot; href=&quot;#Machine-Learning-Pipelines&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;At the core of the &lt;code&gt;pyspark.ml&lt;/code&gt; module are the &lt;code&gt;Transformer&lt;/code&gt; and &lt;code&gt;Estimator&lt;/code&gt; classes. Almost every other class in the module behaves similarly to these two basic classes.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Transformer&lt;/code&gt; classes have a &lt;code&gt;.transform()&lt;/code&gt; method that takes a DataFrame and returns a new DataFrame; usually the original one with a new column appended. For example, you might use the class &lt;code&gt;Bucketizer&lt;/code&gt; to create discrete bins from a continuous feature or the class PCA to reduce the dimensionality of your dataset using principal component analysis.&lt;/p&gt;
&lt;p&gt;Estimator classes all implement a &lt;code&gt;.fit()&lt;/code&gt; method. These methods also take a DataFrame, but instead of returning another DataFrame they return a model object. This can be something like a &lt;code&gt;StringIndexerModel&lt;/code&gt; for including categorical data saved as strings in your models, or a &lt;code&gt;RandomForestModel&lt;/code&gt; that uses the random forest algorithm for classification or regression.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Join-the-DataFrames&quot;&gt;Join the DataFrames&lt;a class=&quot;anchor-link&quot; href=&quot;#Join-the-DataFrames&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the next two chapters you'll be working to build a model that predicts whether or not a flight will be delayed based on the flights data we've been working with. This model will also include information about the plane that flew the route, so the first step is to join the two tables: &lt;code&gt;flights&lt;/code&gt; and &lt;code&gt;planes&lt;/code&gt;!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;flights&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read and create a temporary view&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Infer schema (note that for larger files you &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# may want to specify the schema)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;inferSchema&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;header&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;./dataset/flights_small.csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createOrReplaceTempView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;flights&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;inferSchema&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;header&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/planes.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createOrReplaceTempView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;planes&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Rename year column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumnRenamed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;plane_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Join the DataFrame&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;planes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tailnum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;leftouter&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Data-types&quot;&gt;Data types&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-types&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Good work! Before you get started modeling, it's important to know that Spark only handles numeric data. That means all of the columns in your DataFrame must be either integers or decimals (called 'doubles' in Spark).&lt;/p&gt;
&lt;p&gt;When we imported our data, we let Spark guess what kind of information each column held. Unfortunately, Spark doesn't always guess right and you can see that some of the columns in our DataFrame are strings containing numbers as opposed to actual numeric values.&lt;/p&gt;
&lt;p&gt;To remedy this, you can use the &lt;code&gt;.cast()&lt;/code&gt; method in combination with the &lt;code&gt;.withColumn()&lt;/code&gt; method. It's important to note that &lt;code&gt;.cast()&lt;/code&gt; works on columns, while &lt;code&gt;.withColumn()&lt;/code&gt; works on DataFrames.&lt;/p&gt;
&lt;p&gt;The only argument you need to pass to &lt;code&gt;.cast()&lt;/code&gt; is the kind of value you want to create, in string form. For example, to create integers, you'll pass the argument &lt;code&gt;&quot;integer&quot;&lt;/code&gt; and for decimal numbers you'll use &lt;code&gt;&quot;double&quot;&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;String-to-integer&quot;&gt;String to integer&lt;a class=&quot;anchor-link&quot; href=&quot;#String-to-integer&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now you'll use the &lt;code&gt;.cast()&lt;/code&gt; method you learned in the previous exercise to convert all the appropriate columns from your DataFrame model_data to integers!&lt;/p&gt;
&lt;p&gt;To convert the type of a column using the &lt;code&gt;.cast()&lt;/code&gt; method, you can write code like this:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataframe&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataframe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;col&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataframe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;new_type&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Cast the columns to integers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;arr_delay&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr_delay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;air_time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;plane_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plane_year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-a-new-column&quot;&gt;Create a new column&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-a-new-column&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the last exercise, you converted the column &lt;code&gt;plane_year&lt;/code&gt; to an integer. This column holds the year each plane was manufactured. However, your model will use the planes' age, which is slightly different from the year it was made!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create the column plane_age&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;plane_age&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plane_year&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Making-a-Boolean&quot;&gt;Making a Boolean&lt;a class=&quot;anchor-link&quot; href=&quot;#Making-a-Boolean&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Consider that you're modeling a yes or no question: is the flight late? However, your data contains the arrival delay in minutes for each flight. Thus, you'll need to create a boolean column which indicates whether the flight was late or not!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create is_late&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;is_late&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr_delay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Convert to an integer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_late&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;integer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Remove missing values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;arr_delay is not NULL and dep_delay is not NULL and &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;                               air_time is not NULL and plane_year is not NULL&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Strings-and-factors&quot;&gt;Strings and factors&lt;a class=&quot;anchor-link&quot; href=&quot;#Strings-and-factors&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As you know, Spark requires numeric data for modeling. So far this hasn't been an issue; even boolean columns can easily be converted to integers without any trouble. But you'll also be using the airline and the plane's destination as features in your model. These are coded as strings and there isn't any obvious way to convert them to a numeric data type.&lt;/p&gt;
&lt;p&gt;Fortunately, PySpark has functions for handling this built into the &lt;code&gt;pyspark.ml.features&lt;/code&gt; submodule. You can create what are called 'one-hot vectors' to represent the carrier and the destination of each flight. A one-hot vector is a way of representing a categorical feature where every observation has a vector in which all elements are zero except for at most one element, which has a value of one (1).&lt;/p&gt;
&lt;p&gt;Each element in the vector corresponds to a level of the feature, so it's possible to tell what the right level is by seeing which element of the vector is equal to one (1).&lt;/p&gt;
&lt;p&gt;The first step to encoding your categorical feature is to create a &lt;code&gt;StringIndexer&lt;/code&gt;. Members of this class are &lt;code&gt;Estimators&lt;/code&gt; that take a DataFrame with a column of strings and map each unique string to a number. Then, the &lt;code&gt;Estimator&lt;/code&gt; returns a &lt;code&gt;Transformer&lt;/code&gt; that takes a DataFrame, attaches the mapping to it as metadata, and returns a new DataFrame with a numeric column corresponding to the string column.&lt;/p&gt;
&lt;p&gt;The second step is to encode this numeric column as a one-hot vector using a &lt;code&gt;OneHotEncoder&lt;/code&gt;. This works exactly the same way as the &lt;code&gt;StringIndexer&lt;/code&gt; by creating an &lt;code&gt;Estimator&lt;/code&gt; and then a &lt;code&gt;Transformer&lt;/code&gt;. The end result is a column that encodes your categorical feature as a vector that's suitable for machine learning routines!&lt;/p&gt;
&lt;p&gt;This may seem complicated, but don't worry! All you have to remember is that you need to create a &lt;code&gt;StringIndexer&lt;/code&gt; and a &lt;code&gt;OneHotEncoder&lt;/code&gt;, and the Pipeline will take care of the rest.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Carrier&quot;&gt;Carrier&lt;a class=&quot;anchor-link&quot; href=&quot;#Carrier&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this exercise you'll create a &lt;code&gt;StringIndexer&lt;/code&gt; and a &lt;code&gt;OneHotEncoder&lt;/code&gt; to code the &lt;code&gt;carrier&lt;/code&gt; column. To do this, you'll call the class constructors with the arguments &lt;code&gt;inputCol&lt;/code&gt; and &lt;code&gt;outputCol&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;inputCol&lt;/code&gt; is the name of the column you want to index or encode, and the &lt;code&gt;outputCol&lt;/code&gt; is the name of the new column that the &lt;code&gt;Transformer&lt;/code&gt; should create.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create StringIndexer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;carr_indexer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a OneHotEncoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;carr_encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_fact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Destination&quot;&gt;Destination&lt;a class=&quot;anchor-link&quot; href=&quot;#Destination&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now you'll encode the &lt;code&gt;dest&lt;/code&gt; column just like you did in the previous exercise.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create a StringIndexer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dest_indexer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringIndexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a OneHotEncoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dest_encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OneHotEncoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest_fact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Assemble-a-vector&quot;&gt;Assemble a vector&lt;a class=&quot;anchor-link&quot; href=&quot;#Assemble-a-vector&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The last step in the &lt;code&gt;Pipeline&lt;/code&gt; is to combine all of the columns containing our features into a single column. This has to be done before modeling can take place because every Spark modeling routine expects the data to be in this form. You can do this by storing each of the values from a column as an entry in a vector. Then, from the model's point of view, every observation is a vector that contains all of the information about it and a label that tells the modeler what value that observation corresponds to.&lt;/p&gt;
&lt;p&gt;Because of this, the &lt;code&gt;pyspark.ml.feature&lt;/code&gt; submodule contains a class called &lt;code&gt;VectorAssembler&lt;/code&gt;. This &lt;code&gt;Transformer&lt;/code&gt; takes all of the columns you specify and combines them into a new vector column.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml.feature&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make a VectorAssembler&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vec_assembler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VectorAssembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputCols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;air_time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;carrier_fact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dest_fact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;plane_age&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                &lt;span class=&quot;n&quot;&gt;outputCol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-the-pipeline&quot;&gt;Create the pipeline&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-pipeline&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You're finally ready to create a Pipeline!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.ml&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pipeline&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make the pipeline&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_pipe&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dest_indexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest_encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;carr_indexer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;carr_encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vec_assembler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Test-vs-Train&quot;&gt;Test vs Train&lt;a class=&quot;anchor-link&quot; href=&quot;#Test-vs-Train&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;After you've cleaned your data and gotten it ready for modeling, one of the most important steps is to split the data into a test set and a train set. After that, don't touch your test data until you think you have a good model! As you're building models and forming hypotheses, you can test them on your training data to get an idea of their performance.&lt;/p&gt;
&lt;p&gt;Once you've got your favorite model, you can see how well it predicts the new data in your test set. This never-before-seen data will give you a much more realistic idea of your model's performance in the real world when you're trying to predict or classify new data.&lt;/p&gt;
&lt;p&gt;In Spark it's important to make sure you split the data after all the transformations. This is because operations like &lt;code&gt;StringIndexer&lt;/code&gt; don't always produce the same index even when given the same list of strings.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Transform-the-data&quot;&gt;Transform the data&lt;a class=&quot;anchor-link&quot; href=&quot;#Transform-the-data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Hooray, now you're finally ready to pass your data through the &lt;code&gt;Pipeline&lt;/code&gt; you created!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Fit and transform the data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;piped_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights_pipe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Split-the-data&quot;&gt;Split the data&lt;a class=&quot;anchor-link&quot; href=&quot;#Split-the-data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that you've done all your manipulations, the last step before modeling is to split the data!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Split the data into training and test sets&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;piped_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randomSplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-------+----+-----+---+--------+---------+--------+---------+-------+------+------+----+--------+--------+----+------+----------+--------------------+----------------+--------+-------+-----+-----+---------+---------+-------+-----+----------+---------------+-------------+--------------+--------------------+
|tailnum|year|month|day|dep_time|dep_delay|arr_time|arr_delay|carrier|flight|origin|dest|air_time|distance|hour|minute|plane_year|                type|    manufacturer|   model|engines|seats|speed|   engine|plane_age|is_late|label|dest_index|      dest_fact|carrier_index|  carrier_fact|            features|
+-------+----+-----+---+--------+---------+--------+---------+-------+------+------+----+--------+--------+----+------+----------+--------------------+----------------+--------+-------+-----+-----+---------+---------+-------+-----+----------+---------------+-------------+--------------+--------------------+
| N102UW|2014|    5|  7|    1311|        6|    2115|        2|     US|  1971|   SEA| CLT|     274|    2279|  13|    11|      1998|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       16|   true|    1|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N102UW|2014|   11|  9|    2220|       -5|     555|      -11|     US|  1930|   PDX| CLT|     257|    2282|  22|    20|      1998|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       16|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N105UW|2014|    3| 13|    1325|        5|    2123|       13|     US|  1805|   SEA| CLT|     261|    2279|  13|    25|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|   true|    1|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N107US|2014|    4|  2|    1316|       -4|    2114|        4|     US|  1805|   SEA| CLT|     267|    2279|  13|    16|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|   true|    1|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N107US|2014|    5| 15|    1058|       -2|    1845|      -23|     US|  2092|   SEA| CLT|     264|    2279|  10|    58|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N107US|2014|    9| 14|     509|       -6|     751|       -8|     US|   480|   SEA| PHX|     143|    1107|   5|     9|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|       4.0| (68,[4],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,16,80]...|
| N110UW|2014|    7| 16|     101|       16|     901|       15|     US|  1917|   SEA| PHL|     288|    2378|   1|     1|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|   true|    1|      32.0|(68,[32],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,44,80]...|
| N111US|2014|    3| 14|    1319|       -1|    2101|       -9|     US|  1805|   SEA| CLT|     256|    2279|  13|    19|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N111US|2014|    4| 29|    2216|        1|     620|       10|     US|  1930|   PDX| CLT|     271|    2282|  22|    16|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|   true|    1|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N112US|2014|    2|  1|     833|       -2|    1612|      -27|     US|   788|   SEA| PHL|     260|    2378|   8|    33|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|      32.0|(68,[32],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,44,80]...|
| N112US|2014|    6| 30|    1101|        1|    1851|       -7|     US|  2092|   SEA| CLT|     269|    2279|  11|     1|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N112US|2014|    7| 19|      43|       -2|     845|       -1|     US|  2051|   SEA| PHL|     281|    2378|   0|    43|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|      32.0|(68,[32],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,44,80]...|
| N117UW|2014|    6| 28|    2209|       -6|     605|        4|     US|  1930|   PDX| CLT|     282|    2282|  22|     9|      2000|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       14|   true|    1|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N1201P|2014|    7| 28|    1054|       -1|    1836|       -3|     DL|   716|   PDX| ATL|     239|    2172|  10|    54|      1998|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       16|  false|    0|      12.0|(68,[12],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,24,80]...|
| N1201P|2014|    9| 23|    1651|      370|      31|      371|     DL|  1702|   PDX| ATL|     249|    2172|  16|    51|      1998|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       16|   true|    1|      12.0|(68,[12],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,24,80]...|
| N121DE|2014|    9|  1|    2317|        2|     605|      -22|     DL|   910|   SEA| DTW|     205|    1927|  23|    17|      1987|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       27|  false|    0|      25.0|(68,[25],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,37,80]...|
| N121UW|2014|   11|  6|    2226|        1|     552|      -14|     US|  1930|   PDX| CLT|     246|    2282|  22|    26|      2000|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       14|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N12221|2014|    8| 30|    1142|       -1|    1744|      -17|     UA|  1246|   SEA| IAH|     218|    1874|  11|    42|      1998|Fixed wing multi ...|          BOEING| 737-824|      2|  149|   NA|Turbo-fan|       16|  false|    0|      14.0|(68,[14],[1.0])|          4.0|(10,[4],[1.0])|(81,[0,1,6,26,80]...|
| N12225|2014|   11| 24|     707|       -3|     916|      -16|     UA|  1732|   SEA| SFO|      89|     679|   7|     7|      1998|Fixed wing multi ...|          BOEING| 737-824|      2|  149|   NA|Turbo-fan|       16|  false|    0|       0.0| (68,[0],[1.0])|          4.0|(10,[4],[1.0])|(81,[0,1,6,12,80]...|
| N12238|2014|    9| 22|    2326|       -4|     505|      -13|     UA|  1538|   PDX| ORD|     203|    1739|  23|    26|      1999|Fixed wing multi ...|          BOEING| 737-824|      2|  149|   NA|Turbo-fan|       15|  false|    0|      11.0|(68,[11],[1.0])|          4.0|(10,[4],[1.0])|(81,[0,1,6,23,80]...|
+-------+----+-----+---+--------+---------+--------+---------+-------+------+------+----+--------+--------+----+------+----------+--------------------+----------------+--------+-------+-----+-----+---------+---------+-------+-----+----------+---------------+-------------+--------------+--------------------+
only showing top 20 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-------+----+-----+---+--------+---------+--------+---------+-------+------+------+----+--------+--------+----+------+----------+--------------------+----------------+--------+-------+-----+-----+---------+---------+-------+-----+----------+---------------+-------------+--------------+--------------------+
|tailnum|year|month|day|dep_time|dep_delay|arr_time|arr_delay|carrier|flight|origin|dest|air_time|distance|hour|minute|plane_year|                type|    manufacturer|   model|engines|seats|speed|   engine|plane_age|is_late|label|dest_index|      dest_fact|carrier_index|  carrier_fact|            features|
+-------+----+-----+---+--------+---------+--------+---------+-------+------+------+----+--------+--------+----+------+----------+--------------------+----------------+--------+-------+-----+-----+---------+---------+-------+-----+----------+---------------+-------------+--------------+--------------------+
| N108UW|2014|    6| 17|    1107|        7|    1906|        8|     US|  2092|   SEA| CLT|     273|    2279|  11|     7|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|   true|    1|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N109UW|2014|    4| 20|    2209|       -6|     548|      -22|     US|  1930|   PDX| CLT|     266|    2282|  22|     9|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N109UW|2014|    5|  2|    2214|       -1|     546|      -24|     US|  1930|   PDX| CLT|     255|    2282|  22|    14|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N110UW|2014|    5| 24|    2220|        5|     602|        1|     US|  1930|   PDX| CLT|     263|    2282|  22|    20|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|   true|    1|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N112US|2014|    1| 30|     835|        0|    1630|       -9|     US|  1935|   SEA| PHL|     276|    2378|   8|    35|      1999|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       15|  false|    0|      32.0|(68,[32],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,44,80]...|
| N117UW|2014|    8| 25|     833|       -2|    1643|       -1|     US|   798|   SEA| PHL|     290|    2378|   8|    33|      2000|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       14|  false|    0|      32.0|(68,[32],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,44,80]...|
| N119US|2014|   10|  2|    2208|       -7|     548|      -12|     US|  1930|   PDX| CLT|     260|    2282|  22|     8|      2000|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       14|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N121DE|2014|    8| 13|    2311|       -4|     611|      -15|     DL|  1823|   SEA| DTW|     216|    1927|  23|    11|      1987|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       27|  false|    0|      25.0|(68,[25],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,37,80]...|
| N12221|2014|   12| 30|    1554|       49|    1807|       54|     UA|  1717|   SEA| SFO|      99|     679|  15|    54|      1998|Fixed wing multi ...|          BOEING| 737-824|      2|  149|   NA|Turbo-fan|       16|   true|    1|       0.0| (68,[0],[1.0])|          4.0|(10,[4],[1.0])|(81,[0,1,6,12,80]...|
| N12238|2014|    6| 20|     734|       19|    1056|       11|     UA|  1660|   PDX| DEN|     123|     991|   7|    34|      1999|Fixed wing multi ...|          BOEING| 737-824|      2|  149|   NA|Turbo-fan|       15|   true|    1|       2.0| (68,[2],[1.0])|          4.0|(10,[4],[1.0])|(81,[0,1,6,14,80]...|
| N122US|2014|    5| 19|    1057|       -3|    1847|      -21|     US|  2092|   SEA| CLT|     260|    2279|  10|    57|      2000|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       14|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N123UW|2014|    2| 27|    1313|       -7|    2049|      -21|     US|  1805|   SEA| CLT|     258|    2279|  13|    13|      2000|Fixed wing multi ...|AIRBUS INDUSTRIE|A320-214|      2|  182|   NA|Turbo-fan|       14|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N124DE|2014|    6| 27|    1135|        5|    1641|       -1|     DL|   588|   SEA| MSP|     168|    1399|  11|    35|      1987|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       27|  false|    0|      13.0|(68,[13],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,25,80]...|
| N125DL|2014|    6|  7|      42|       -3|     556|        5|     DL|  2440|   SEA| MSP|     173|    1399|   0|    42|      1988|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       26|   true|    1|      13.0|(68,[13],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,25,80]...|
| N125DL|2014|    7| 21|     859|       -1|    1641|       -6|     DL|   108|   SEA| ATL|     250|    2182|   8|    59|      1988|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       26|  false|    0|      12.0|(68,[12],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,24,80]...|
| N125DL|2014|    9| 30|     731|        1|    1521|        5|     DL|  1808|   SEA| ATL|     251|    2182|   7|    31|      1988|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       26|   true|    1|      12.0|(68,[12],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,24,80]...|
| N126UW|2014|    5|  4|    1301|       -4|    2031|      -42|     US|  1952|   SEA| CLT|     241|    2279|  13|     1|      2009|Fixed wing multi ...|          AIRBUS|A320-214|      2|  182|   NA|Turbo-fan|        5|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N126UW|2014|    5|  7|    1053|       -7|    1852|      -16|     US|  2092|   SEA| CLT|     273|    2279|  10|    53|      2009|Fixed wing multi ...|          AIRBUS|A320-214|      2|  182|   NA|Turbo-fan|        5|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
| N127DL|2014|    7| 19|    1314|       -4|    1824|       -6|     DL|   198|   SEA| MSP|     165|    1399|  13|    14|      1988|Fixed wing multi ...|          BOEING| 767-332|      2|  330|   NA|Turbo-fan|       26|  false|    0|      13.0|(68,[13],[1.0])|          3.0|(10,[3],[1.0])|(81,[0,1,5,25,80]...|
| N127UW|2014|    3|  6|    2219|       -6|     603|       -1|     US|  1930|   PDX| CLT|     268|    2282|  22|    19|      2010|Fixed wing multi ...|          AIRBUS|A320-214|      2|  182|   NA|Turbo-fan|        4|  false|    0|      33.0|(68,[33],[1.0])|          5.0|(10,[5],[1.0])|(81,[0,1,7,45,80]...|
+-------+----+-----+---+--------+---------+--------+---------+-------+------+------+----+--------+--------+----+------+----------+--------------------+----------------+--------+-------+-----+-----+---------+---------+-------+-----+----------+---------------+-------------+--------------+--------------------+
only showing top 20 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/spark.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/spark.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Manipulating data in PySpark</title><link href="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/2020/08/09/01-Manipulating-data-in-PySpark.html" rel="alternate" type="text/html" title="Manipulating data in PySpark" /><published>2020-08-09T00:00:00-05:00</published><updated>2020-08-09T00:00:00-05:00</updated><id>https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/2020/08/09/01-Manipulating-data-in-PySpark</id><content type="html" xml:base="https://goodboychan.github.io/chans_jupyter/python/datacamp/pyspark/2020/08/09/01-Manipulating-data-in-PySpark.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-09-01-Manipulating-data-in-PySpark.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Creating-columns&quot;&gt;Creating columns&lt;a class=&quot;anchor-link&quot; href=&quot;#Creating-columns&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this chapter, you'll learn how to use the methods defined by Spark's &lt;code&gt;DataFrame&lt;/code&gt; class to perform common data operations.&lt;/p&gt;
&lt;p&gt;Let's look at performing column-wise operations. In Spark you can do this using the &lt;code&gt;.withColumn()&lt;/code&gt; method, which takes two arguments. First, a string with the name of your new column, and second the new column itself.&lt;/p&gt;
&lt;p&gt;The new column must be an object of class &lt;code&gt;Column&lt;/code&gt;. Creating one of these is as easy as extracting a column from your DataFrame using &lt;code&gt;df.colName&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Updating a Spark DataFrame is somewhat different than working in pandas because the Spark DataFrame is immutable. This means that it can't be changed, and so columns can't be updated in place.&lt;/p&gt;
&lt;p&gt;Thus, all these methods return a new DataFrame. To overwrite the original DataFrame you must reassign the returned DataFrame using the method like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;df = df.withColumn(&quot;newCol&quot;, df.oldCol + 1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The above code creates a DataFrame with the same columns as df plus a new column, &lt;code&gt;newCol&lt;/code&gt;, where every entry is equal to the corresponding entry from &lt;code&gt;oldCol&lt;/code&gt;, plus one.&lt;/p&gt;
&lt;p&gt;To overwrite an existing column, just pass the name of the column as the first argument!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;flights&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Path to data set&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;csv_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./dataset/flights_small.csv&amp;quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read and create a temporary view&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Infer schema (note that for larger files you &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# may want to specify the schema)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;inferSchema&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;header&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createOrReplaceTempView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;flights&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Print the tables in the catalog&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;catalog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listTables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[Table(name=&amp;#39;flights&amp;#39;, database=None, description=None, tableType=&amp;#39;TEMPORARY&amp;#39;, isTemporary=True)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create the DataFrame flights&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;flights&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Show the head&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add duration_hrs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration_hrs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+
|year|month|day|dep_time|dep_delay|arr_time|arr_delay|carrier|tailnum|flight|origin|dest|air_time|distance|hour|minute|
+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+
|2014|   12|  8|     658|       -7|     935|       -5|     VX| N846VA|  1780|   SEA| LAX|     132|     954|   6|    58|
|2014|    1| 22|    1040|        5|    1505|        5|     AS| N559AS|   851|   SEA| HNL|     360|    2677|  10|    40|
|2014|    3|  9|    1443|       -2|    1652|        2|     VX| N847VA|   755|   SEA| SFO|     111|     679|  14|    43|
|2014|    4|  9|    1705|       45|    1839|       34|     WN| N360SW|   344|   PDX| SJC|      83|     569|  17|     5|
|2014|    3|  9|     754|       -1|    1015|        1|     AS| N612AS|   522|   SEA| BUR|     127|     937|   7|    54|
|2014|    1| 15|    1037|        7|    1352|        2|     WN| N646SW|    48|   PDX| DEN|     121|     991|  10|    37|
|2014|    7|  2|     847|       42|    1041|       51|     WN| N422WN|  1520|   PDX| OAK|      90|     543|   8|    47|
|2014|    5| 12|    1655|       -5|    1842|      -18|     VX| N361VA|   755|   SEA| SFO|      98|     679|  16|    55|
|2014|    4| 19|    1236|       -4|    1508|       -7|     AS| N309AS|   490|   SEA| SAN|     135|    1050|  12|    36|
|2014|   11| 19|    1812|       -3|    2352|       -4|     AS| N564AS|    26|   SEA| ORD|     198|    1721|  18|    12|
|2014|   11|  8|    1653|       -2|    1924|       -1|     AS| N323AS|   448|   SEA| LAX|     130|     954|  16|    53|
|2014|    8|  3|    1120|        0|    1415|        2|     AS| N305AS|   656|   SEA| PHX|     154|    1107|  11|    20|
|2014|   10| 30|     811|       21|    1038|       29|     AS| N433AS|   608|   SEA| LAS|     127|     867|   8|    11|
|2014|   11| 12|    2346|       -4|     217|      -28|     AS| N765AS|   121|   SEA| ANC|     183|    1448|  23|    46|
|2014|   10| 31|    1314|       89|    1544|      111|     AS| N713AS|   306|   SEA| SFO|     129|     679|  13|    14|
|2014|    1| 29|    2009|        3|    2159|        9|     UA| N27205|  1458|   PDX| SFO|      90|     550|  20|     9|
|2014|   12| 17|    2015|       50|    2150|       41|     AS| N626AS|   368|   SEA| SMF|      76|     605|  20|    15|
|2014|    8| 11|    1017|       -3|    1613|       -7|     WN| N8634A|   827|   SEA| MDW|     216|    1733|  10|    17|
|2014|    1| 13|    2156|       -9|     607|      -15|     AS| N597AS|    24|   SEA| BOS|     290|    2496|  21|    56|
|2014|    6|  5|    1733|      -12|    1945|      -10|     OO| N215AG|  3488|   PDX| BUR|     111|     817|  17|    33|
+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+
only showing top 20 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;SQL-in-a-nutshell&quot;&gt;SQL in a nutshell&lt;a class=&quot;anchor-link&quot; href=&quot;#SQL-in-a-nutshell&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As you move forward, it will help to have a basic understanding of SQL.&lt;/p&gt;
&lt;p&gt;A SQL query returns a table derived from one or more tables contained in a database.&lt;/p&gt;
&lt;p&gt;Every SQL query is made up of commands that tell the database what you want to do with the data. The two commands that every query has to contain are &lt;code&gt;SELECT&lt;/code&gt; and &lt;code&gt;FROM&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;SELECT&lt;/code&gt; command is followed by the columns you want in the resulting table.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;FROM&lt;/code&gt; command is followed by the name of the table that contains those columns. The minimal SQL query is:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;*&lt;/code&gt; selects all columns, so this returns the entire table named &lt;code&gt;my_table&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Similar to .withColumn(), you can do column-wise computations within a SELECT statement. For example,&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;returns a table with the origin, destination, and duration in hours for each flight.&lt;/p&gt;
&lt;p&gt;Another commonly used command is &lt;code&gt;WHERE&lt;/code&gt;. This command filters the rows of the table based on some logical condition you specify. The resulting table contains the rows where your condition is true. For example, if you had a table of students and grades you could do:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;students&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grade&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to select all the columns and the rows containing information about students who got As.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;So to extract the table of tail numbers and destimations for flights that lasted more than 10 hours is&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tail_num&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;SQL-in-a-nutshell-(2)&quot;&gt;SQL in a nutshell (2)&lt;a class=&quot;anchor-link&quot; href=&quot;#SQL-in-a-nutshell-(2)&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another common database task is aggregation. That is, reducing your data by breaking it into chunks and summarizing each chunk.&lt;/p&gt;
&lt;p&gt;This is done in SQL using the &lt;code&gt;GROUP BY&lt;/code&gt; command. This command breaks your data into groups and applies a function from your &lt;code&gt;SELECT&lt;/code&gt; statement to each group.&lt;/p&gt;
&lt;p&gt;For example, if you wanted to count the number of flights from each of two origin destinations, you could use the query&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;GROUP BY origin&lt;/code&gt; tells SQL that you want the output to have a row for each unique value of the &lt;code&gt;origin&lt;/code&gt; column. The &lt;code&gt;SELECT&lt;/code&gt; statement selects the values you want to populate each of the columns. Here, we want to &lt;code&gt;COUNT()&lt;/code&gt; every row in each of the groups.&lt;/p&gt;
&lt;p&gt;It's possible to &lt;code&gt;GROUP BY&lt;/code&gt; more than one column. When you do this, the resulting table has a row for every combination of the unique values in each column. The following query counts the number of flights from SEA and PDX to every destination airport:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The output will have a row for every combination of the values in &lt;code&gt;origin&lt;/code&gt; and &lt;code&gt;dest&lt;/code&gt; (i.e. a row listing each origin and destination that a flight flew to). There will also be a column with the &lt;code&gt;COUNT()&lt;/code&gt; of all the rows in each group.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Filtering-Data&quot;&gt;Filtering Data&lt;a class=&quot;anchor-link&quot; href=&quot;#Filtering-Data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that you have a bit of SQL know-how under your belt, it's easier to talk about the analogous operations using Spark DataFrames.&lt;/p&gt;
&lt;p&gt;Let's take a look at the &lt;code&gt;.filter()&lt;/code&gt; method. As you might suspect, this is the Spark counterpart of SQL's WHERE clause. The &lt;code&gt;.filter()&lt;/code&gt; method takes either an expression that would follow the &lt;code&gt;WHERE&lt;/code&gt; clause of a SQL expression as a string, or a Spark Column of boolean (True/False) values.&lt;/p&gt;
&lt;p&gt;For example, the following two expressions will produce the same output:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;air_time &amp;gt; 120&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;120&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that in the first case, we pass a string to &lt;code&gt;.filter()&lt;/code&gt;. In SQL, we would write this filtering task as &lt;code&gt;SELECT * FROM flights WHERE air_time &amp;gt; 120&lt;/code&gt;. Spark's &lt;code&gt;.filter()&lt;/code&gt; can accept any expression that could go in the &lt;code&gt;WHERE&lt;/code&gt; clause of a SQL query (in this case, &lt;code&gt;&quot;air_time &amp;gt; 120&quot;&lt;/code&gt;), as long as it is passed as a string. Notice that in this case, we do not reference the name of the table in the string -- as we wouldn't in the SQL request.&lt;/p&gt;
&lt;p&gt;In the second case, we actually pass a column of boolean values to &lt;code&gt;.filter()&lt;/code&gt;. Remember that &lt;code&gt;flights.air_time &amp;gt; 120&lt;/code&gt; returns a column of boolean values that has &lt;code&gt;True&lt;/code&gt; in place of those records in &lt;code&gt;flights.air_time&lt;/code&gt; that are over 120, and &lt;code&gt;False&lt;/code&gt; otherwise.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Filter flights by passing a string&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;long_flights1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;distance &amp;gt; 1000&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Filter flights by passing a column of boolean values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;long_flights2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Print the data to check they&amp;#39;re equal&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;long_flights1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;long_flights2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+------------------+
|year|month|day|dep_time|dep_delay|arr_time|arr_delay|carrier|tailnum|flight|origin|dest|air_time|distance|hour|minute|      duration_hrs|
+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+------------------+
|2014|    1| 22|    1040|        5|    1505|        5|     AS| N559AS|   851|   SEA| HNL|     360|    2677|  10|    40|               6.0|
|2014|    4| 19|    1236|       -4|    1508|       -7|     AS| N309AS|   490|   SEA| SAN|     135|    1050|  12|    36|              2.25|
|2014|   11| 19|    1812|       -3|    2352|       -4|     AS| N564AS|    26|   SEA| ORD|     198|    1721|  18|    12|               3.3|
|2014|    8|  3|    1120|        0|    1415|        2|     AS| N305AS|   656|   SEA| PHX|     154|    1107|  11|    20| 2.566666666666667|
|2014|   11| 12|    2346|       -4|     217|      -28|     AS| N765AS|   121|   SEA| ANC|     183|    1448|  23|    46|              3.05|
|2014|    8| 11|    1017|       -3|    1613|       -7|     WN| N8634A|   827|   SEA| MDW|     216|    1733|  10|    17|               3.6|
|2014|    1| 13|    2156|       -9|     607|      -15|     AS| N597AS|    24|   SEA| BOS|     290|    2496|  21|    56| 4.833333333333333|
|2014|    9| 26|     610|       -5|    1523|       65|     US| N127UW|   616|   SEA| PHL|     293|    2378|   6|    10| 4.883333333333334|
|2014|   12|  4|     954|       -6|    1348|      -17|     HA| N395HA|    29|   SEA| OGG|     333|    2640|   9|    54|              5.55|
|2014|    6|  4|    1115|        0|    1346|       -3|     AS| N461AS|   488|   SEA| SAN|     133|    1050|  11|    15| 2.216666666666667|
|2014|    6| 26|    2054|       -1|    2318|       -6|     B6| N590JB|   907|   SEA| ANC|     179|    1448|  20|    54|2.9833333333333334|
|2014|    6|  7|    1823|       -7|    2112|      -28|     AS| N512AS|   815|   SEA| LIH|     335|    2701|  18|    23| 5.583333333333333|
|2014|    4| 30|     801|        1|    1757|       90|     AS| N407AS|    18|   SEA| MCO|     342|    2554|   8|     1|               5.7|
|2014|   11| 29|     905|      155|    1655|      170|     DL| N824DN|  1598|   SEA| ATL|     229|    2182|   9|     5| 3.816666666666667|
|2014|    6|  2|    2222|        7|      55|       15|     AS| N402AS|    99|   SEA| ANC|     190|    1448|  22|    22|3.1666666666666665|
|2014|   11| 15|    1034|       -6|    1414|      -26|     AS| N589AS|   794|   SEA| ABQ|     139|    1180|  10|    34| 2.316666666666667|
|2014|   10| 20|    1328|       -1|    1949|        4|     UA| N68805|  1212|   SEA| IAH|     228|    1874|  13|    28|               3.8|
|2014|   12| 16|    1500|        0|    1906|       19|     US| N662AW|   500|   SEA| PHX|     151|    1107|  15|     0|2.5166666666666666|
|2014|   11| 19|    1319|       -6|    1821|      -14|     DL| N309US|  2164|   PDX| MSP|     169|    1426|  13|    19| 2.816666666666667|
|2014|    5| 21|     515|        0|     757|        0|     US| N172US|   593|   SEA| PHX|     143|    1107|   5|    15|2.3833333333333333|
+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+------------------+
only showing top 20 rows

+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+------------------+
|year|month|day|dep_time|dep_delay|arr_time|arr_delay|carrier|tailnum|flight|origin|dest|air_time|distance|hour|minute|      duration_hrs|
+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+------------------+
|2014|    1| 22|    1040|        5|    1505|        5|     AS| N559AS|   851|   SEA| HNL|     360|    2677|  10|    40|               6.0|
|2014|    4| 19|    1236|       -4|    1508|       -7|     AS| N309AS|   490|   SEA| SAN|     135|    1050|  12|    36|              2.25|
|2014|   11| 19|    1812|       -3|    2352|       -4|     AS| N564AS|    26|   SEA| ORD|     198|    1721|  18|    12|               3.3|
|2014|    8|  3|    1120|        0|    1415|        2|     AS| N305AS|   656|   SEA| PHX|     154|    1107|  11|    20| 2.566666666666667|
|2014|   11| 12|    2346|       -4|     217|      -28|     AS| N765AS|   121|   SEA| ANC|     183|    1448|  23|    46|              3.05|
|2014|    8| 11|    1017|       -3|    1613|       -7|     WN| N8634A|   827|   SEA| MDW|     216|    1733|  10|    17|               3.6|
|2014|    1| 13|    2156|       -9|     607|      -15|     AS| N597AS|    24|   SEA| BOS|     290|    2496|  21|    56| 4.833333333333333|
|2014|    9| 26|     610|       -5|    1523|       65|     US| N127UW|   616|   SEA| PHL|     293|    2378|   6|    10| 4.883333333333334|
|2014|   12|  4|     954|       -6|    1348|      -17|     HA| N395HA|    29|   SEA| OGG|     333|    2640|   9|    54|              5.55|
|2014|    6|  4|    1115|        0|    1346|       -3|     AS| N461AS|   488|   SEA| SAN|     133|    1050|  11|    15| 2.216666666666667|
|2014|    6| 26|    2054|       -1|    2318|       -6|     B6| N590JB|   907|   SEA| ANC|     179|    1448|  20|    54|2.9833333333333334|
|2014|    6|  7|    1823|       -7|    2112|      -28|     AS| N512AS|   815|   SEA| LIH|     335|    2701|  18|    23| 5.583333333333333|
|2014|    4| 30|     801|        1|    1757|       90|     AS| N407AS|    18|   SEA| MCO|     342|    2554|   8|     1|               5.7|
|2014|   11| 29|     905|      155|    1655|      170|     DL| N824DN|  1598|   SEA| ATL|     229|    2182|   9|     5| 3.816666666666667|
|2014|    6|  2|    2222|        7|      55|       15|     AS| N402AS|    99|   SEA| ANC|     190|    1448|  22|    22|3.1666666666666665|
|2014|   11| 15|    1034|       -6|    1414|      -26|     AS| N589AS|   794|   SEA| ABQ|     139|    1180|  10|    34| 2.316666666666667|
|2014|   10| 20|    1328|       -1|    1949|        4|     UA| N68805|  1212|   SEA| IAH|     228|    1874|  13|    28|               3.8|
|2014|   12| 16|    1500|        0|    1906|       19|     US| N662AW|   500|   SEA| PHX|     151|    1107|  15|     0|2.5166666666666666|
|2014|   11| 19|    1319|       -6|    1821|      -14|     DL| N309US|  2164|   PDX| MSP|     169|    1426|  13|    19| 2.816666666666667|
|2014|    5| 21|     515|        0|     757|        0|     US| N172US|   593|   SEA| PHX|     143|    1107|   5|    15|2.3833333333333333|
+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+----+--------+--------+----+------+------------------+
only showing top 20 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Selecting&quot;&gt;Selecting&lt;a class=&quot;anchor-link&quot; href=&quot;#Selecting&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The Spark variant of SQL's &lt;code&gt;SELECT&lt;/code&gt; is the &lt;code&gt;.select()&lt;/code&gt; method. This method takes multiple arguments - one for each column you want to select. These arguments can either be the column name as a string (one for each column) or a column object (using the df.colName syntax). When you pass a column object, you can perform operations like addition or subtraction on the column to change the data contained in it, much like inside &lt;code&gt;.withColumn()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The difference between &lt;code&gt;.select()&lt;/code&gt; and &lt;code&gt;.withColumn()&lt;/code&gt; methods is that &lt;code&gt;.select()&lt;/code&gt; returns only the columns you specify, while &lt;code&gt;.withColumn()&lt;/code&gt; returns all the columns of the DataFrame in addition to the one you defined. It's often a good idea to drop columns you don't need at the beginning of an operation so that you're not dragging around extra data as you're wrangling. In this case, you would use &lt;code&gt;.select()&lt;/code&gt; and not &lt;code&gt;.withColumn()&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Select the first set of columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;selected1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;tailnum&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;origin&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;dest&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Select the second set of columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;carrier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define first filter&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;filterA&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;SEA&amp;quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define second filter&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;filterB&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;PDX&amp;quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Filter the data, first by filterA then by filterB&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;selected2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filterA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filterB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Selecting-II&quot;&gt;Selecting II&lt;a class=&quot;anchor-link&quot; href=&quot;#Selecting-II&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Similar to SQL, you can also use the &lt;code&gt;.select()&lt;/code&gt; method to perform column-wise operations. When you're selecting a column using the &lt;code&gt;df.colName&lt;/code&gt; notation, you can perform any column operation and the &lt;code&gt;.select()&lt;/code&gt; method will return the transformed column. For example,&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;returns a column of flight durations in hours instead of minutes. You can also use the &lt;code&gt;.alias()&lt;/code&gt; method to rename a column you're selecting. So if you wanted to &lt;code&gt;.select()&lt;/code&gt; the column &lt;code&gt;duration_hrs&lt;/code&gt; (which isn't in your DataFrame) you could do&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;duration_hrs&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The equivalent Spark DataFrame method &lt;code&gt;.selectExpr()&lt;/code&gt; takes SQL expressions as a string:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selectExpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;air_time/60 as duration_hrs&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with the SQL as keyword being equivalent to the &lt;code&gt;.alias()&lt;/code&gt; method. To select multiple columns, you can pass multiple strings.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define avg_speed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;avg_speed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;avg_speed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Select the correct columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;speed1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;origin&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;dest&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;tailnum&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;avg_speed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the same table using a SQL expression&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;speed2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selectExpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;origin&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;dest&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;tailnum&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;distance / (air_time/60) as avg_speed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Aggregating&quot;&gt;Aggregating&lt;a class=&quot;anchor-link&quot; href=&quot;#Aggregating&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;All of the common aggregation methods, like &lt;code&gt;.min()&lt;/code&gt;, &lt;code&gt;.max()&lt;/code&gt;, and &lt;code&gt;.count()&lt;/code&gt; are &lt;code&gt;GroupedData&lt;/code&gt; methods. These are created by calling the &lt;code&gt;.groupBy()&lt;/code&gt; DataFrame method. You'll learn exactly what that means in a few exercises. For now, all you have to do to use these functions is call that method on your DataFrame. For example, to find the minimum value of a column, &lt;code&gt;col&lt;/code&gt;, in a DataFrame, &lt;code&gt;df&lt;/code&gt;, you could do&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;col&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This creates a &lt;code&gt;GroupedData&lt;/code&gt; object (so you can use the .min() method), then finds the minimum value in &lt;code&gt;col&lt;/code&gt;, and returns it as a DataFrame.&lt;/p&gt;
&lt;p&gt;Now you're ready to do some aggregating of your own!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;It requires to type cast in air_time from string to interger
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;root
 |-- year: integer (nullable = true)
 |-- month: integer (nullable = true)
 |-- day: integer (nullable = true)
 |-- dep_time: string (nullable = true)
 |-- dep_delay: string (nullable = true)
 |-- arr_time: string (nullable = true)
 |-- arr_delay: string (nullable = true)
 |-- carrier: string (nullable = true)
 |-- tailnum: string (nullable = true)
 |-- flight: integer (nullable = true)
 |-- origin: string (nullable = true)
 |-- dest: string (nullable = true)
 |-- air_time: string (nullable = true)
 |-- distance: integer (nullable = true)
 |-- hour: string (nullable = true)
 |-- minute: string (nullable = true)
 |-- duration_hrs: double (nullable = true)

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.types&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;air_time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;air_time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;dep_delay&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;dep_delay&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Find the shortest flight from PDX in terms of distance&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;PDX&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;distance&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Find the longest flight from SEA in terms of air time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;SEA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;air_time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-------------+
|min(distance)|
+-------------+
|          106|
+-------------+

+-------------+
|max(air_time)|
+-------------+
|          409|
+-------------+

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Aggregating-II&quot;&gt;Aggregating II&lt;a class=&quot;anchor-link&quot; href=&quot;#Aggregating-II&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;To get you familiar with more of the built in aggregation methods, here's a few more exercises involving the &lt;code&gt;flights&lt;/code&gt; table!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Average duration of Delta flights&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;carrier&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;DL&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;origin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;SEA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;air_time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Total hours in the air&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration_hrs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;air_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;duration_hrs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+------------------+
|     avg(air_time)|
+------------------+
|188.20689655172413|
+------------------+

+------------------+
| sum(duration_hrs)|
+------------------+
|25289.600000000126|
+------------------+

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Grouping-and-Aggregating-I&quot;&gt;Grouping and Aggregating I&lt;a class=&quot;anchor-link&quot; href=&quot;#Grouping-and-Aggregating-I&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Part of what makes aggregating so powerful is the addition of groups. PySpark has a whole class devoted to grouped data frames: &lt;code&gt;pyspark.sql.GroupedData&lt;/code&gt;, which you saw in the last two exercises.&lt;/p&gt;
&lt;p&gt;You've learned how to create a grouped DataFrame by calling the &lt;code&gt;.groupBy()&lt;/code&gt; method on a DataFrame with no arguments.&lt;/p&gt;
&lt;p&gt;Now you'll see that when you pass the name of one or more columns in your DataFrame to the &lt;code&gt;.groupBy()&lt;/code&gt; method, the aggregation methods behave like when you use a &lt;code&gt;GROUP BY&lt;/code&gt; statement in a SQL query!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Group by tailnum&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;by_plane&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tailnum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Number of flights each plane made&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;by_plane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Group by origin&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;by_origin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;origin&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average duration of flights from PDX and SEA&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;by_origin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;air_time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-------+-----+
|tailnum|count|
+-------+-----+
| N442AS|   38|
| N102UW|    2|
| N36472|    4|
| N38451|    4|
| N73283|    4|
| N513UA|    2|
| N954WN|    5|
| N388DA|    3|
| N567AA|    1|
| N516UA|    2|
| N927DN|    1|
| N8322X|    1|
| N466SW|    1|
|  N6700|    1|
| N607AS|   45|
| N622SW|    4|
| N584AS|   31|
| N914WN|    4|
| N654AW|    2|
| N336NW|    1|
+-------+-----+
only showing top 20 rows

+------+------------------+
|origin|     avg(air_time)|
+------+------------------+
|   SEA| 160.4361496051259|
|   PDX|137.11543248288737|
+------+------------------+

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Grouping-and-Aggregating-II&quot;&gt;Grouping and Aggregating II&lt;a class=&quot;anchor-link&quot; href=&quot;#Grouping-and-Aggregating-II&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In addition to the &lt;code&gt;GroupedData&lt;/code&gt; methods you've already seen, there is also the &lt;code&gt;.agg()&lt;/code&gt; method. This method lets you pass an aggregate column expression that uses any of the aggregate functions from the &lt;code&gt;pyspark.sql.functions&lt;/code&gt; submodule.&lt;/p&gt;
&lt;p&gt;This submodule contains many useful functions for computing things like standard deviations. All the aggregation functions in this submodule take the name of a column in a &lt;code&gt;GroupedData&lt;/code&gt; table.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.functions&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;F&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Group by month and est&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;by_month_dest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dest&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Average departure delay by month and destination&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;by_month_dest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dep_delay&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Standard deviation of departure delay&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;by_month_dest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dep_delay&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+-----+----+-------------------+
|month|dest|     avg(dep_delay)|
+-----+----+-------------------+
|    4| PHX| 1.6833333333333333|
|    1| RDM|             -1.625|
|    5| ONT| 3.5555555555555554|
|    7| OMA|               -6.5|
|    8| MDW|               7.45|
|    6| DEN|  5.418181818181818|
|    5| IAD|               -4.0|
|   12| COS|               -1.0|
|   11| ANC|  7.529411764705882|
|    5| AUS|              -0.75|
|    5| COS| 11.666666666666666|
|    2| PSP|                0.6|
|    4| ORD|0.14285714285714285|
|   10| DFW| 18.176470588235293|
|   10| DCA|               -1.5|
|    8| JNU|             18.125|
|   11| KOA|               -1.0|
|   10| OMA|-0.6666666666666666|
|    6| ONT|              9.625|
|    3| MSP|                3.2|
+-----+----+-------------------+
only showing top 20 rows

+-----+----+----------------------+
|month|dest|stddev_samp(dep_delay)|
+-----+----+----------------------+
|    4| PHX|    15.003380033491737|
|    1| RDM|     8.830749846821778|
|    5| ONT|    18.895178691342874|
|    7| OMA|    2.1213203435596424|
|    8| MDW|    14.467659032985843|
|    6| DEN|    13.536905534420026|
|    5| IAD|    3.8078865529319543|
|   12| COS|    1.4142135623730951|
|   11| ANC|    18.604716401245316|
|    5| AUS|     4.031128874149275|
|    5| COS|     33.38163167571851|
|    2| PSP|     4.878524367060187|
|    4| ORD|    11.593882803741764|
|   10| DFW|     45.53019017606675|
|   10| DCA|    0.7071067811865476|
|    8| JNU|     40.79368823727514|
|   11| KOA|    1.8708286933869707|
|   10| OMA|    5.8594652770823155|
|    6| ONT|     25.98316762829351|
|    3| MSP|    21.556779370817555|
+-----+----+----------------------+
only showing top 20 rows

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Joining&quot;&gt;Joining&lt;a class=&quot;anchor-link&quot; href=&quot;#Joining&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another very common data operation is the join. Joins are a whole topic unto themselves, so in this course we'll just look at simple joins.&lt;/p&gt;
&lt;p&gt;A join will combine two different tables along a column that they share. This column is called the key. Examples of keys here include the &lt;code&gt;tailnum&lt;/code&gt; and &lt;code&gt;carrier&lt;/code&gt; columns from the &lt;code&gt;flights&lt;/code&gt; table.&lt;/p&gt;
&lt;p&gt;For example, suppose that you want to know more information about the plane that flew a flight than just the tail number. This information isn't in the &lt;code&gt;flights&lt;/code&gt; table because the same plane flies many different flights over the course of two years, so including this information in every row would result in a lot of duplication. To avoid this, you'd have a second table that has only one row for each plane and whose columns list all the information about the plane, including its tail number. You could call this table &lt;code&gt;planes&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;When you join the &lt;code&gt;flights&lt;/code&gt; table to this table of airplane information, you're adding all the columns from the &lt;code&gt;planes&lt;/code&gt; table to the &lt;code&gt;flights&lt;/code&gt; table. To fill these columns with information, you'll look at the tail number from the &lt;code&gt;flights&lt;/code&gt; table and find the matching one in the &lt;code&gt;planes&lt;/code&gt; table, and then use that row to fill out all the new columns.&lt;/p&gt;
&lt;p&gt;Now you'll have a much bigger table than before, but now every row has all information about the plane that flew that flight!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Joining-II&quot;&gt;Joining II&lt;a class=&quot;anchor-link&quot; href=&quot;#Joining-II&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In PySpark, joins are performed using the DataFrame method &lt;code&gt;.join()&lt;/code&gt;. This method takes three arguments. The first is the second DataFrame that you want to join with the first one. The second argument, &lt;code&gt;on&lt;/code&gt;, is the name of the key column(s) as a string. The names of the key column(s) must be the same in each table. The third argument, &lt;code&gt;how&lt;/code&gt;, specifies the kind of join to perform. In this course we'll always use the value &lt;code&gt;how=&quot;leftouter&quot;&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;airports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;inferSchema&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;header&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./dataset/airports.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;airports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createOrReplaceTempView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;airports&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Examine the data&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;airports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# rename the faa column&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;airports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;airports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumnRenamed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;faa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dest&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Joint the DataFrames&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights_with_airports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;airports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dest&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;leftouter&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Examine the new DataFrame&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flights_with_airports&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;+---+--------------------+----------------+-----------------+----+---+---+
|faa|                name|             lat|              lon| alt| tz|dst|
+---+--------------------+----------------+-----------------+----+---+---+
|04G|   Lansdowne Airport|      41.1304722|      -80.6195833|1044| -5|  A|
|06A|Moton Field Munic...|      32.4605722|      -85.6800278| 264| -5|  A|
|06C| Schaumburg Regional|      41.9893408|      -88.1012428| 801| -6|  A|
|06N|     Randall Airport|       41.431912|      -74.3915611| 523| -5|  A|
|09J|Jekyll Island Air...|      31.0744722|      -81.4277778|  11| -4|  A|
|0A9|Elizabethton Muni...|      36.3712222|      -82.1734167|1593| -4|  A|
|0G6|Williams County A...|      41.4673056|      -84.5067778| 730| -5|  A|
|0G7|Finger Lakes Regi...|      42.8835647|      -76.7812318| 492| -5|  A|
|0P2|Shoestring Aviati...|      39.7948244|      -76.6471914|1000| -5|  U|
|0S9|Jefferson County ...|      48.0538086|     -122.8106436| 108| -8|  A|
|0W3|Harford County Ai...|      39.5668378|      -76.2024028| 409| -5|  A|
|10C|  Galt Field Airport|      42.4028889|      -88.3751111| 875| -6|  U|
|17G|Port Bucyrus-Craw...|      40.7815556|      -82.9748056|1003| -5|  A|
|19A|Jackson County Ai...|      34.1758638|      -83.5615972| 951| -4|  U|
|1A3|Martin Campbell F...|      35.0158056|      -84.3468333|1789| -4|  A|
|1B9| Mansfield Municipal|      42.0001331|      -71.1967714| 122| -5|  A|
|1C9|Frazier Lake Airpark|54.0133333333333|-124.768333333333| 152| -8|  A|
|1CS|Clow Internationa...|      41.6959744|      -88.1292306| 670| -6|  U|
|1G3|  Kent State Airport|      41.1513889|      -81.4151111|1134| -4|  A|
|1OH|     Fortman Airport|      40.5553253|      -84.3866186| 885| -5|  U|
+---+--------------------+----------------+-----------------+----+---+---+
only showing top 20 rows

None
+----+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+--------+--------+----+------+------------------+--------------------+---------+-----------+----+---+---+
|dest|year|month|day|dep_time|dep_delay|arr_time|arr_delay|carrier|tailnum|flight|origin|air_time|distance|hour|minute|      duration_hrs|                name|      lat|        lon| alt| tz|dst|
+----+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+--------+--------+----+------+------------------+--------------------+---------+-----------+----+---+---+
| LAX|2014|   12|  8|     658|       -7|     935|       -5|     VX| N846VA|  1780|   SEA|     132|     954|   6|    58|               2.2|    Los Angeles Intl|33.942536|-118.408075| 126| -8|  A|
| HNL|2014|    1| 22|    1040|        5|    1505|        5|     AS| N559AS|   851|   SEA|     360|    2677|  10|    40|               6.0|       Honolulu Intl|21.318681|-157.922428|  13|-10|  N|
| SFO|2014|    3|  9|    1443|       -2|    1652|        2|     VX| N847VA|   755|   SEA|     111|     679|  14|    43|              1.85|  San Francisco Intl|37.618972|-122.374889|  13| -8|  A|
| SJC|2014|    4|  9|    1705|       45|    1839|       34|     WN| N360SW|   344|   PDX|      83|     569|  17|     5|1.3833333333333333|Norman Y Mineta S...|  37.3626|-121.929022|  62| -8|  A|
| BUR|2014|    3|  9|     754|       -1|    1015|        1|     AS| N612AS|   522|   SEA|     127|     937|   7|    54|2.1166666666666667|            Bob Hope|34.200667|-118.358667| 778| -8|  A|
| DEN|2014|    1| 15|    1037|        7|    1352|        2|     WN| N646SW|    48|   PDX|     121|     991|  10|    37|2.0166666666666666|         Denver Intl|39.861656|-104.673178|5431| -7|  A|
| OAK|2014|    7|  2|     847|       42|    1041|       51|     WN| N422WN|  1520|   PDX|      90|     543|   8|    47|               1.5|Metropolitan Oakl...|37.721278|-122.220722|   9| -8|  A|
| SFO|2014|    5| 12|    1655|       -5|    1842|      -18|     VX| N361VA|   755|   SEA|      98|     679|  16|    55|1.6333333333333333|  San Francisco Intl|37.618972|-122.374889|  13| -8|  A|
| SAN|2014|    4| 19|    1236|       -4|    1508|       -7|     AS| N309AS|   490|   SEA|     135|    1050|  12|    36|              2.25|      San Diego Intl|32.733556|-117.189667|  17| -8|  A|
| ORD|2014|   11| 19|    1812|       -3|    2352|       -4|     AS| N564AS|    26|   SEA|     198|    1721|  18|    12|               3.3|  Chicago Ohare Intl|41.978603| -87.904842| 668| -6|  A|
| LAX|2014|   11|  8|    1653|       -2|    1924|       -1|     AS| N323AS|   448|   SEA|     130|     954|  16|    53|2.1666666666666665|    Los Angeles Intl|33.942536|-118.408075| 126| -8|  A|
| PHX|2014|    8|  3|    1120|        0|    1415|        2|     AS| N305AS|   656|   SEA|     154|    1107|  11|    20| 2.566666666666667|Phoenix Sky Harbo...|33.434278|-112.011583|1135| -7|  N|
| LAS|2014|   10| 30|     811|       21|    1038|       29|     AS| N433AS|   608|   SEA|     127|     867|   8|    11|2.1166666666666667|      Mc Carran Intl|36.080056| -115.15225|2141| -8|  A|
| ANC|2014|   11| 12|    2346|       -4|     217|      -28|     AS| N765AS|   121|   SEA|     183|    1448|  23|    46|              3.05|Ted Stevens Ancho...|61.174361|-149.996361| 152| -9|  A|
| SFO|2014|   10| 31|    1314|       89|    1544|      111|     AS| N713AS|   306|   SEA|     129|     679|  13|    14|              2.15|  San Francisco Intl|37.618972|-122.374889|  13| -8|  A|
| SFO|2014|    1| 29|    2009|        3|    2159|        9|     UA| N27205|  1458|   PDX|      90|     550|  20|     9|               1.5|  San Francisco Intl|37.618972|-122.374889|  13| -8|  A|
| SMF|2014|   12| 17|    2015|       50|    2150|       41|     AS| N626AS|   368|   SEA|      76|     605|  20|    15|1.2666666666666666|     Sacramento Intl|38.695417|-121.590778|  27| -8|  A|
| MDW|2014|    8| 11|    1017|       -3|    1613|       -7|     WN| N8634A|   827|   SEA|     216|    1733|  10|    17|               3.6| Chicago Midway Intl|41.785972| -87.752417| 620| -6|  A|
| BOS|2014|    1| 13|    2156|       -9|     607|      -15|     AS| N597AS|    24|   SEA|     290|    2496|  21|    56| 4.833333333333333|General Edward La...|42.364347| -71.005181|  19| -5|  A|
| BUR|2014|    6|  5|    1733|      -12|    1945|      -10|     OO| N215AG|  3488|   PDX|     111|     817|  17|    33|              1.85|            Bob Hope|34.200667|-118.358667| 778| -8|  A|
+----+----+-----+---+--------+---------+--------+---------+-------+-------+------+------+--------+--------+----+------+------------------+--------------------+---------+-----------+----+---+---+
only showing top 20 rows

None
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Chanseok Kang</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://goodboychan.github.io/chans_jupyter/images/spark.png" /><media:content medium="image" url="https://goodboychan.github.io/chans_jupyter/images/spark.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>