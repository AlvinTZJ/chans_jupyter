<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Building deep learning models with keras | Chan`s Jupyter</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Building deep learning models with keras" />
<meta name="author" content="Chanseok Kang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this chapter, you’ll use the Keras library to build deep learning models for both regression and classification. You’ll learn about the Specify-Compile-Fit workflow that you can use to make predictions, and by the end of the chapter, you’ll have all the tools necessary to build deep neural networks. This is the Summary of lecture “Introduction to Deep Learning in Python”, via datacamp." />
<meta property="og:description" content="In this chapter, you’ll use the Keras library to build deep learning models for both regression and classification. You’ll learn about the Specify-Compile-Fit workflow that you can use to make predictions, and by the end of the chapter, you’ll have all the tools necessary to build deep neural networks. This is the Summary of lecture “Introduction to Deep Learning in Python”, via datacamp." />
<link rel="canonical" href="https://goodboychan.github.io/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html" />
<meta property="og:url" content="https://goodboychan.github.io/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html" />
<meta property="og:site_name" content="Chan`s Jupyter" />
<meta property="og:image" content="https://goodboychan.github.io/chans_jupyter/images/gd.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-21T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Chanseok Kang"},"description":"In this chapter, you’ll use the Keras library to build deep learning models for both regression and classification. You’ll learn about the Specify-Compile-Fit workflow that you can use to make predictions, and by the end of the chapter, you’ll have all the tools necessary to build deep neural networks. This is the Summary of lecture “Introduction to Deep Learning in Python”, via datacamp.","@type":"BlogPosting","headline":"Building deep learning models with keras","dateModified":"2020-07-21T00:00:00-05:00","datePublished":"2020-07-21T00:00:00-05:00","image":"https://goodboychan.github.io/chans_jupyter/images/gd.png","url":"https://goodboychan.github.io/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://goodboychan.github.io/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/chans_jupyter/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://goodboychan.github.io/chans_jupyter/feed.xml" title="Chan`s Jupyter" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-33905785-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/chans_jupyter/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Building deep learning models with keras | Chan`s Jupyter</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Building deep learning models with keras" />
<meta name="author" content="Chanseok Kang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this chapter, you’ll use the Keras library to build deep learning models for both regression and classification. You’ll learn about the Specify-Compile-Fit workflow that you can use to make predictions, and by the end of the chapter, you’ll have all the tools necessary to build deep neural networks. This is the Summary of lecture “Introduction to Deep Learning in Python”, via datacamp." />
<meta property="og:description" content="In this chapter, you’ll use the Keras library to build deep learning models for both regression and classification. You’ll learn about the Specify-Compile-Fit workflow that you can use to make predictions, and by the end of the chapter, you’ll have all the tools necessary to build deep neural networks. This is the Summary of lecture “Introduction to Deep Learning in Python”, via datacamp." />
<link rel="canonical" href="https://goodboychan.github.io/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html" />
<meta property="og:url" content="https://goodboychan.github.io/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html" />
<meta property="og:site_name" content="Chan`s Jupyter" />
<meta property="og:image" content="https://goodboychan.github.io/chans_jupyter/images/gd.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-21T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Chanseok Kang"},"description":"In this chapter, you’ll use the Keras library to build deep learning models for both regression and classification. You’ll learn about the Specify-Compile-Fit workflow that you can use to make predictions, and by the end of the chapter, you’ll have all the tools necessary to build deep neural networks. This is the Summary of lecture “Introduction to Deep Learning in Python”, via datacamp.","@type":"BlogPosting","headline":"Building deep learning models with keras","dateModified":"2020-07-21T00:00:00-05:00","datePublished":"2020-07-21T00:00:00-05:00","image":"https://goodboychan.github.io/chans_jupyter/images/gd.png","url":"https://goodboychan.github.io/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://goodboychan.github.io/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://goodboychan.github.io/chans_jupyter/feed.xml" title="Chan`s Jupyter" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-33905785-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/chans_jupyter/">Chan`s Jupyter</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/chans_jupyter/about/">About Me</a><a class="page-link" href="/chans_jupyter/search/">Search</a><a class="page-link" href="/chans_jupyter/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Building deep learning models with keras</h1><p class="page-description">In this chapter, you'll use the Keras library to build deep learning models for both regression and classification. You'll learn about the Specify-Compile-Fit workflow that you can use to make predictions, and by the end of the chapter, you'll have all the tools necessary to build deep neural networks. This is the Summary of lecture "Introduction to Deep Learning in Python", via datacamp.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-07-21T00:00:00-05:00" itemprop="datePublished">
        Jul 21, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Chanseok Kang</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      13 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/chans_jupyter/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/chans_jupyter/categories/#Datacamp">Datacamp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/chans_jupyter/categories/#Deep_Learning">Deep_Learning</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/goodboychan/chans_jupyter/tree/master/_notebooks/2020-07-21-03-Building-deep-learning-models-with-keras.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/chans_jupyter/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/goodboychan/chans_jupyter/master?filepath=_notebooks%2F2020-07-21-03-Building-deep-learning-models-with-keras.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/chans_jupyter/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/goodboychan/chans_jupyter/blob/master/_notebooks/2020-07-21-03-Building-deep-learning-models-with-keras.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/chans_jupyter/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#Creating-a-keras-model">Creating a keras model </a></li>
<li class="toc-entry toc-h3"><a href="#Understanding-your-data">Understanding your data </a></li>
<li class="toc-entry toc-h3"><a href="#Specifying-a-model">Specifying a model </a></li>
<li class="toc-entry toc-h2"><a href="#Compiling-and-fitting-a-model">Compiling and fitting a model </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Compiling-the-model">Compiling the model </a></li>
<li class="toc-entry toc-h3"><a href="#Fitting-the-model">Fitting the model </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Classification-models">Classification models </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Understanding-your-classification-data">Understanding your classification data </a></li>
<li class="toc-entry toc-h3"><a href="#Last-steps-in-classification-models">Last steps in classification models </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Using-models">Using models </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Making-predictions">Making predictions </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-21-03-Building-deep-learning-models-with-keras.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Creating-a-keras-model">
<a class="anchor" href="#Creating-a-keras-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating a keras model<a class="anchor-link" href="#Creating-a-keras-model"> </a>
</h3>
<ul>
<li>Model building steps<ul>
<li>Specify Architecture</li>
<li>Compile</li>
<li>Fit</li>
<li>Predict
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg>
    <strong>Note: </strong>In the lecture, keras framework was used. But in this page, keras with tensorflow (<code>tf.keras</code>) will be used.
</div>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Understanding-your-data">
<a class="anchor" href="#Understanding-your-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Understanding your data<a class="anchor-link" href="#Understanding-your-data"> </a>
</h3>
<p>You will soon start building models in Keras to predict wages based on various professional and demographic factors. Before you start building a model, it's good to understand your data by performing some exploratory analysis.</p>
<p>The data is pre-loaded into a pandas DataFrame called <code>df</code>. Use the <code>.head()</code> and <code>.describe()</code> methods.</p>
<p>The target variable you'll be predicting is <code>wage_per_hour</code>. Some of the predictor variables are binary indicators, where a value of 1 represents True, and 0 represents False.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/hourly_wages.csv'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wage_per_hour</th>
      <th>union</th>
      <th>education_yrs</th>
      <th>experience_yrs</th>
      <th>age</th>
      <th>female</th>
      <th>marr</th>
      <th>south</th>
      <th>manufacturing</th>
      <th>construction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.10</td>
      <td>0</td>
      <td>8</td>
      <td>21</td>
      <td>35</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.95</td>
      <td>0</td>
      <td>9</td>
      <td>42</td>
      <td>57</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.67</td>
      <td>0</td>
      <td>12</td>
      <td>1</td>
      <td>19</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.00</td>
      <td>0</td>
      <td>12</td>
      <td>4</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.50</td>
      <td>0</td>
      <td>12</td>
      <td>17</td>
      <td>35</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wage_per_hour</th>
      <th>union</th>
      <th>education_yrs</th>
      <th>experience_yrs</th>
      <th>age</th>
      <th>female</th>
      <th>marr</th>
      <th>south</th>
      <th>manufacturing</th>
      <th>construction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>534.000000</td>
      <td>534.000000</td>
      <td>534.000000</td>
      <td>534.000000</td>
      <td>534.000000</td>
      <td>534.000000</td>
      <td>534.000000</td>
      <td>534.000000</td>
      <td>534.000000</td>
      <td>534.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>9.024064</td>
      <td>0.179775</td>
      <td>13.018727</td>
      <td>17.822097</td>
      <td>36.833333</td>
      <td>0.458801</td>
      <td>0.655431</td>
      <td>0.292135</td>
      <td>0.185393</td>
      <td>0.044944</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.139097</td>
      <td>0.384360</td>
      <td>2.615373</td>
      <td>12.379710</td>
      <td>11.726573</td>
      <td>0.498767</td>
      <td>0.475673</td>
      <td>0.455170</td>
      <td>0.388981</td>
      <td>0.207375</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>18.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.250000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>8.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>7.780000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>15.000000</td>
      <td>35.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>11.250000</td>
      <td>0.000000</td>
      <td>15.000000</td>
      <td>26.000000</td>
      <td>44.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>44.500000</td>
      <td>1.000000</td>
      <td>18.000000</td>
      <td>55.000000</td>
      <td>64.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Specifying-a-model">
<a class="anchor" href="#Specifying-a-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Specifying a model<a class="anchor-link" href="#Specifying-a-model"> </a>
</h3>
<p>Now you'll get to work with your first model in Keras, and will immediately be able to run more complex neural network models on larger datasets compared to the first two chapters.</p>
<p>To start, you'll take the skeleton of a neural network and add a hidden layer and an output layer. You'll then fit that model and see Keras do the optimization so your model continually gets better.</p>
<p>As a start, you'll predict workers wages based on characteristics like their industry, education and level of experience. You can find the dataset in a pandas dataframe called <code>df</code>. For convenience, everything in <code>df</code> except for the target has been converted to a NumPy matrix called <code>predictors</code>. The target, <code>wage_per_hour</code>, is available as a NumPy matrix called <code>target</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">predictors</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save the number of columns in predictors: n_cols</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="n">predictors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Set up the model: model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># Add the first layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span><span class="p">,</span> <span class="p">)))</span>

<span class="c1"># Add the second layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>

<span class="c1"># Add the output layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InternalError</span>                             Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-9-e620cf709903&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> 
<span class="ansi-green-intense-fg ansi-bold">      7</span> <span class="ansi-red-fg"># Add the first layer</span>
<span class="ansi-green-fg">----&gt; 8</span><span class="ansi-red-fg"> </span>model<span class="ansi-blue-fg">.</span>add<span class="ansi-blue-fg">(</span>tf<span class="ansi-blue-fg">.</span>keras<span class="ansi-blue-fg">.</span>layers<span class="ansi-blue-fg">.</span>Dense<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">50</span><span class="ansi-blue-fg">,</span> activation<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'relu'</span><span class="ansi-blue-fg">,</span> input_shape<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span>n_cols<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> 
<span class="ansi-green-intense-fg ansi-bold">     10</span> <span class="ansi-red-fg"># Add the second layer</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/training/tracking/base.py</span> in <span class="ansi-cyan-fg">_method_wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    454</span>     self<span class="ansi-blue-fg">.</span>_self_setattr_tracking <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>  <span class="ansi-red-fg"># pylint: disable=protected-access</span>
<span class="ansi-green-intense-fg ansi-bold">    455</span>     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 456</span><span class="ansi-red-fg">       </span>result <span class="ansi-blue-fg">=</span> method<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    457</span>     <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    458</span>       self<span class="ansi-blue-fg">.</span>_self_setattr_tracking <span class="ansi-blue-fg">=</span> previous_value  <span class="ansi-red-fg"># pylint: disable=protected-access</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py</span> in <span class="ansi-cyan-fg">add</span><span class="ansi-blue-fg">(self, layer)</span>
<span class="ansi-green-intense-fg ansi-bold">    196</span>           <span class="ansi-red-fg"># and create the node connecting the current layer</span>
<span class="ansi-green-intense-fg ansi-bold">    197</span>           <span class="ansi-red-fg"># to the input layer we just created.</span>
<span class="ansi-green-fg">--&gt; 198</span><span class="ansi-red-fg">           </span>layer<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    199</span>           set_inputs <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span>
<span class="ansi-green-intense-fg ansi-bold">    200</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    895</span>           <span class="ansi-red-fg"># Build layer if applicable (if the `build` method has been</span>
<span class="ansi-green-intense-fg ansi-bold">    896</span>           <span class="ansi-red-fg"># overridden).</span>
<span class="ansi-green-fg">--&gt; 897</span><span class="ansi-red-fg">           </span>self<span class="ansi-blue-fg">.</span>_maybe_build<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    898</span>           cast_inputs <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_maybe_cast_inputs<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    899</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py</span> in <span class="ansi-cyan-fg">_maybe_build</span><span class="ansi-blue-fg">(self, inputs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2414</span>         <span class="ansi-red-fg"># operations.</span>
<span class="ansi-green-intense-fg ansi-bold">   2415</span>         <span class="ansi-green-fg">with</span> tf_utils<span class="ansi-blue-fg">.</span>maybe_init_scope<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2416</span><span class="ansi-red-fg">           </span>self<span class="ansi-blue-fg">.</span>build<span class="ansi-blue-fg">(</span>input_shapes<span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># pylint:disable=not-callable</span>
<span class="ansi-green-intense-fg ansi-bold">   2417</span>       <span class="ansi-red-fg"># We must set also ensure that the layer is marked as built, and the build</span>
<span class="ansi-green-intense-fg ansi-bold">   2418</span>       <span class="ansi-red-fg"># shape is stored since user defined build functions may not be calling</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/layers/core.py</span> in <span class="ansi-cyan-fg">build</span><span class="ansi-blue-fg">(self, input_shape)</span>
<span class="ansi-green-intense-fg ansi-bold">   1163</span>         constraint<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>kernel_constraint<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1164</span>         dtype<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>dtype<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1165</span><span class="ansi-red-fg">         trainable=True)
</span><span class="ansi-green-intense-fg ansi-bold">   1166</span>     <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>use_bias<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1167</span>       self.bias = self.add_weight(

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py</span> in <span class="ansi-cyan-fg">add_weight</span><span class="ansi-blue-fg">(self, name, shape, dtype, initializer, regularizer, trainable, constraint, partitioner, use_resource, synchronization, aggregation, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>         synchronization<span class="ansi-blue-fg">=</span>synchronization<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    576</span>         aggregation<span class="ansi-blue-fg">=</span>aggregation<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 577</span><span class="ansi-red-fg">         caching_device=caching_device)
</span><span class="ansi-green-intense-fg ansi-bold">    578</span>     <span class="ansi-green-fg">if</span> regularizer <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    579</span>       <span class="ansi-red-fg"># TODO(fchollet): in the future, this should be handled at the</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/training/tracking/base.py</span> in <span class="ansi-cyan-fg">_add_variable_with_custom_getter</span><span class="ansi-blue-fg">(self, name, shape, dtype, initializer, getter, overwrite, **kwargs_for_getter)</span>
<span class="ansi-green-intense-fg ansi-bold">    741</span>         dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    742</span>         initializer<span class="ansi-blue-fg">=</span>initializer<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 743</span><span class="ansi-red-fg">         **kwargs_for_getter)
</span><span class="ansi-green-intense-fg ansi-bold">    744</span> 
<span class="ansi-green-intense-fg ansi-bold">    745</span>     <span class="ansi-red-fg"># If we set an initializer and the variable processed it, tracking will not</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer_utils.py</span> in <span class="ansi-cyan-fg">make_variable</span><span class="ansi-blue-fg">(name, shape, dtype, initializer, trainable, caching_device, validate_shape, constraint, use_resource, collections, synchronization, aggregation, partitioner)</span>
<span class="ansi-green-intense-fg ansi-bold">    139</span>       synchronization<span class="ansi-blue-fg">=</span>synchronization<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    140</span>       aggregation<span class="ansi-blue-fg">=</span>aggregation<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 141</span><span class="ansi-red-fg">       shape=variable_shape if variable_shape else None)
</span><span class="ansi-green-intense-fg ansi-bold">    142</span> 
<span class="ansi-green-intense-fg ansi-bold">    143</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/variables.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(cls, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    257</span>   <span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    258</span>     <span class="ansi-green-fg">if</span> cls <span class="ansi-green-fg">is</span> VariableV1<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 259</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">.</span>_variable_v1_call<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    260</span>     <span class="ansi-green-fg">elif</span> cls <span class="ansi-green-fg">is</span> Variable<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    261</span>       <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">.</span>_variable_v2_call<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/variables.py</span> in <span class="ansi-cyan-fg">_variable_v1_call</span><span class="ansi-blue-fg">(cls, initial_value, trainable, collections, validate_shape, caching_device, name, variable_def, dtype, expected_shape, import_scope, constraint, use_resource, synchronization, aggregation, shape)</span>
<span class="ansi-green-intense-fg ansi-bold">    218</span>         synchronization<span class="ansi-blue-fg">=</span>synchronization<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    219</span>         aggregation<span class="ansi-blue-fg">=</span>aggregation<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 220</span><span class="ansi-red-fg">         shape=shape)
</span><span class="ansi-green-intense-fg ansi-bold">    221</span> 
<span class="ansi-green-intense-fg ansi-bold">    222</span>   def _variable_v2_call(cls,

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/variables.py</span> in <span class="ansi-cyan-fg">&lt;lambda&gt;</span><span class="ansi-blue-fg">(**kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    196</span>                         shape=None):
<span class="ansi-green-intense-fg ansi-bold">    197</span>     <span class="ansi-blue-fg">"""Call on Variable class. Useful to force the signature."""</span>
<span class="ansi-green-fg">--&gt; 198</span><span class="ansi-red-fg">     </span>previous_getter <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">lambda</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">:</span> default_variable_creator<span class="ansi-blue-fg">(</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    199</span>     <span class="ansi-green-fg">for</span> _<span class="ansi-blue-fg">,</span> getter <span class="ansi-green-fg">in</span> ops<span class="ansi-blue-fg">.</span>get_default_graph<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>_variable_creator_stack<span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># pylint: disable=protected-access</span>
<span class="ansi-green-intense-fg ansi-bold">    200</span>       previous_getter <span class="ansi-blue-fg">=</span> _make_getter<span class="ansi-blue-fg">(</span>getter<span class="ansi-blue-fg">,</span> previous_getter<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/variable_scope.py</span> in <span class="ansi-cyan-fg">default_variable_creator</span><span class="ansi-blue-fg">(next_creator, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2596</span>         synchronization<span class="ansi-blue-fg">=</span>synchronization<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   2597</span>         aggregation<span class="ansi-blue-fg">=</span>aggregation<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 2598</span><span class="ansi-red-fg">         shape=shape)
</span><span class="ansi-green-intense-fg ansi-bold">   2599</span>   <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2600</span>     return variables.RefVariable(

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/variables.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(cls, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    261</span>       <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">.</span>_variable_v2_call<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 263</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">return</span> super<span class="ansi-blue-fg">(</span>VariableMetaclass<span class="ansi-blue-fg">,</span> cls<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__call__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    264</span> 
<span class="ansi-green-intense-fg ansi-bold">    265</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, initial_value, trainable, collections, validate_shape, caching_device, name, dtype, variable_def, import_scope, constraint, distribute_strategy, synchronization, aggregation, shape)</span>
<span class="ansi-green-intense-fg ansi-bold">   1432</span>           aggregation<span class="ansi-blue-fg">=</span>aggregation<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1433</span>           shape<span class="ansi-blue-fg">=</span>shape<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 1434</span><span class="ansi-red-fg">           distribute_strategy=distribute_strategy)
</span><span class="ansi-green-intense-fg ansi-bold">   1435</span> 
<span class="ansi-green-intense-fg ansi-bold">   1436</span>   def _init_from_args(self,

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py</span> in <span class="ansi-cyan-fg">_init_from_args</span><span class="ansi-blue-fg">(self, initial_value, trainable, collections, caching_device, name, dtype, constraint, synchronization, aggregation, distribute_strategy, shape)</span>
<span class="ansi-green-intense-fg ansi-bold">   1565</span>           <span class="ansi-green-fg">with</span> ops<span class="ansi-blue-fg">.</span>name_scope<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"Initializer"</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> device_context_manager<span class="ansi-blue-fg">(</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1566</span>             initial_value = ops.convert_to_tensor(
<span class="ansi-green-fg">-&gt; 1567</span><span class="ansi-red-fg">                 </span>initial_value<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> init_from_fn <span class="ansi-green-fg">else</span> initial_value<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1568</span>                 name="initial_value", dtype=dtype)
<span class="ansi-green-intense-fg ansi-bold">   1569</span>           <span class="ansi-green-fg">if</span> shape <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer_utils.py</span> in <span class="ansi-cyan-fg">&lt;lambda&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    119</span>         (type(init_ops.Initializer), type(init_ops_v2.Initializer))):
<span class="ansi-green-intense-fg ansi-bold">    120</span>       initializer <span class="ansi-blue-fg">=</span> initializer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 121</span><span class="ansi-red-fg">     </span>init_val <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">lambda</span><span class="ansi-blue-fg">:</span> initializer<span class="ansi-blue-fg">(</span>shape<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    122</span>     variable_dtype <span class="ansi-blue-fg">=</span> dtype<span class="ansi-blue-fg">.</span>base_dtype
<span class="ansi-green-intense-fg ansi-bold">    123</span>   <span class="ansi-green-fg">if</span> use_resource <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/init_ops_v2.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, shape, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">    556</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    557</span>       limit <span class="ansi-blue-fg">=</span> math<span class="ansi-blue-fg">.</span>sqrt<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">3.0</span> <span class="ansi-blue-fg">*</span> scale<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 558</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_random_generator<span class="ansi-blue-fg">.</span>random_uniform<span class="ansi-blue-fg">(</span>shape<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">-</span>limit<span class="ansi-blue-fg">,</span> limit<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    559</span> 
<span class="ansi-green-intense-fg ansi-bold">    560</span>   <span class="ansi-green-fg">def</span> get_config<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/init_ops_v2.py</span> in <span class="ansi-cyan-fg">random_uniform</span><span class="ansi-blue-fg">(self, shape, minval, maxval, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">   1066</span>       op <span class="ansi-blue-fg">=</span> random_ops<span class="ansi-blue-fg">.</span>random_uniform
<span class="ansi-green-intense-fg ansi-bold">   1067</span>     return op(
<span class="ansi-green-fg">-&gt; 1068</span><span class="ansi-red-fg">         shape=shape, minval=minval, maxval=maxval, dtype=dtype, seed=self.seed)
</span><span class="ansi-green-intense-fg ansi-bold">   1069</span> 
<span class="ansi-green-intense-fg ansi-bold">   1070</span>   <span class="ansi-green-fg">def</span> truncated_normal<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> shape<span class="ansi-blue-fg">,</span> mean<span class="ansi-blue-fg">,</span> stddev<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/random_ops.py</span> in <span class="ansi-cyan-fg">random_uniform</span><span class="ansi-blue-fg">(shape, minval, maxval, dtype, seed, name)</span>
<span class="ansi-green-intense-fg ansi-bold">    280</span>     maxval <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span>
<span class="ansi-green-intense-fg ansi-bold">    281</span>   <span class="ansi-green-fg">with</span> ops<span class="ansi-blue-fg">.</span>name_scope<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"random_uniform"</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">[</span>shape<span class="ansi-blue-fg">,</span> minval<span class="ansi-blue-fg">,</span> maxval<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> name<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 282</span><span class="ansi-red-fg">     </span>shape <span class="ansi-blue-fg">=</span> tensor_util<span class="ansi-blue-fg">.</span>shape_tensor<span class="ansi-blue-fg">(</span>shape<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    283</span>     <span class="ansi-red-fg"># In case of [0,1) floating results, minval and maxval is unused. We do an</span>
<span class="ansi-green-intense-fg ansi-bold">    284</span>     <span class="ansi-red-fg"># `is` comparison here since this is cheaper than isinstance or  __eq__.</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/tensor_util.py</span> in <span class="ansi-cyan-fg">shape_tensor</span><span class="ansi-blue-fg">(shape)</span>
<span class="ansi-green-intense-fg ansi-bold">   1013</span>       <span class="ansi-red-fg"># not convertible to Tensors because of mixed content.</span>
<span class="ansi-green-intense-fg ansi-bold">   1014</span>       shape <span class="ansi-blue-fg">=</span> tuple<span class="ansi-blue-fg">(</span>map<span class="ansi-blue-fg">(</span>tensor_shape<span class="ansi-blue-fg">.</span>dimension_value<span class="ansi-blue-fg">,</span> shape<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1015</span><span class="ansi-red-fg">   </span><span class="ansi-green-fg">return</span> ops<span class="ansi-blue-fg">.</span>convert_to_tensor<span class="ansi-blue-fg">(</span>shape<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">"shape"</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1016</span> 
<span class="ansi-green-intense-fg ansi-bold">   1017</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/ops.py</span> in <span class="ansi-cyan-fg">convert_to_tensor</span><span class="ansi-blue-fg">(value, dtype, name, as_ref, preferred_dtype, dtype_hint, ctx, accepted_result_types)</span>
<span class="ansi-green-intense-fg ansi-bold">   1339</span> 
<span class="ansi-green-intense-fg ansi-bold">   1340</span>     <span class="ansi-green-fg">if</span> ret <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1341</span><span class="ansi-red-fg">       </span>ret <span class="ansi-blue-fg">=</span> conversion_func<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">=</span>name<span class="ansi-blue-fg">,</span> as_ref<span class="ansi-blue-fg">=</span>as_ref<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1342</span> 
<span class="ansi-green-intense-fg ansi-bold">   1343</span>     <span class="ansi-green-fg">if</span> ret <span class="ansi-green-fg">is</span> NotImplemented<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/constant_op.py</span> in <span class="ansi-cyan-fg">_constant_tensor_conversion_function</span><span class="ansi-blue-fg">(v, dtype, name, as_ref)</span>
<span class="ansi-green-intense-fg ansi-bold">    319</span>                                          as_ref=False):
<span class="ansi-green-intense-fg ansi-bold">    320</span>   _ <span class="ansi-blue-fg">=</span> as_ref
<span class="ansi-green-fg">--&gt; 321</span><span class="ansi-red-fg">   </span><span class="ansi-green-fg">return</span> constant<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>dtype<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">=</span>name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    322</span> 
<span class="ansi-green-intense-fg ansi-bold">    323</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/constant_op.py</span> in <span class="ansi-cyan-fg">constant</span><span class="ansi-blue-fg">(value, dtype, shape, name)</span>
<span class="ansi-green-intense-fg ansi-bold">    260</span>   """
<span class="ansi-green-intense-fg ansi-bold">    261</span>   return _constant_impl(value, dtype, shape, name, verify_shape=False,
<span class="ansi-green-fg">--&gt; 262</span><span class="ansi-red-fg">                         allow_broadcast=True)
</span><span class="ansi-green-intense-fg ansi-bold">    263</span> 
<span class="ansi-green-intense-fg ansi-bold">    264</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/constant_op.py</span> in <span class="ansi-cyan-fg">_constant_impl</span><span class="ansi-blue-fg">(value, dtype, shape, name, verify_shape, allow_broadcast)</span>
<span class="ansi-green-intense-fg ansi-bold">    268</span>   ctx <span class="ansi-blue-fg">=</span> context<span class="ansi-blue-fg">.</span>context<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    269</span>   <span class="ansi-green-fg">if</span> ctx<span class="ansi-blue-fg">.</span>executing_eagerly<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 270</span><span class="ansi-red-fg">     </span>t <span class="ansi-blue-fg">=</span> convert_to_eager_tensor<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">,</span> ctx<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span>     <span class="ansi-green-fg">if</span> shape <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    272</span>       <span class="ansi-green-fg">return</span> t

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/constant_op.py</span> in <span class="ansi-cyan-fg">convert_to_eager_tensor</span><span class="ansi-blue-fg">(value, ctx, dtype)</span>
<span class="ansi-green-intense-fg ansi-bold">     93</span>     <span class="ansi-green-fg">except</span> AttributeError<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     94</span>       dtype <span class="ansi-blue-fg">=</span> dtypes<span class="ansi-blue-fg">.</span>as_dtype<span class="ansi-blue-fg">(</span>dtype<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>as_datatype_enum
<span class="ansi-green-fg">---&gt; 95</span><span class="ansi-red-fg">   </span>ctx<span class="ansi-blue-fg">.</span>ensure_initialized<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     96</span>   <span class="ansi-green-fg">return</span> ops<span class="ansi-blue-fg">.</span>EagerTensor<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">,</span> ctx<span class="ansi-blue-fg">.</span>device_name<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     97</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/eager/context.py</span> in <span class="ansi-cyan-fg">ensure_initialized</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    513</span>           pywrap_tfe.TFE_ContextOptionsSetLazyRemoteInputsCopy(
<span class="ansi-green-intense-fg ansi-bold">    514</span>               opts, self._lazy_remote_inputs_copy)
<span class="ansi-green-fg">--&gt; 515</span><span class="ansi-red-fg">         </span>context_handle <span class="ansi-blue-fg">=</span> pywrap_tfe<span class="ansi-blue-fg">.</span>TFE_NewContext<span class="ansi-blue-fg">(</span>opts<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    516</span>       <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    517</span>         pywrap_tfe<span class="ansi-blue-fg">.</span>TFE_DeleteContextOptions<span class="ansi-blue-fg">(</span>opts<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">InternalError</span>: CUDA runtime implicit initialization on GPU:0 failed. Status: out of memory</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compiling-and-fitting-a-model">
<a class="anchor" href="#Compiling-and-fitting-a-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compiling and fitting a model<a class="anchor-link" href="#Compiling-and-fitting-a-model"> </a>
</h2>
<ul>
<li>Why you need to compile your model<ul>
<li>Specify the optimizer<ul>
<li>Many options and mathematically complex</li>
<li>"Adam" is usually a good choice</li>
</ul>
</li>
<li>Loss function<ul>
<li>"mean_squared_error"</li>
</ul>
</li>
</ul>
</li>
<li>Fitting a model<ul>
<li>Applying backpropagation and gradient descent with your data to update the weights</li>
<li>Scaling data before fitting can ease optimization</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Compiling-the-model">
<a class="anchor" href="#Compiling-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compiling the model<a class="anchor-link" href="#Compiling-the-model"> </a>
</h3>
<p>You're now going to compile the model you specified earlier. To compile the model, you need to specify the optimizer and loss function to use. You can read more about 'adam' optimizer as well as other keras optimizers <a href="https://keras.io/optimizers/#adam">here</a>, and if you are really curious to learn more, you can read the <a href="https://arxiv.org/abs/1412.6980v8">original paper</a> that introduced the Adam optimizer.</p>
<p>In this exercise, you'll use the Adam optimizer and the mean squared error loss function. Go for it!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compile the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'mean_squared_error'</span><span class="p">)</span>

<span class="c1"># Verify that model contains information from compiling</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Loss function: "</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">loss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fitting-the-model">
<a class="anchor" href="#Fitting-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fitting the model<a class="anchor-link" href="#Fitting-the-model"> </a>
</h3>
<p>You're at the most fun part. You'll now fit the model. Recall that the data to be used as predictive features is loaded in a NumPy matrix called <code>predictors</code> and the data to be predicted is stored in a NumPy matrix called <code>target</code>. Your model is pre-written and it has been compiled with the code from the previous exercise.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Fit the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-8-6facaba700d9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># Fit the model</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>model<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span>predictors<span class="ansi-blue-fg">,</span> target<span class="ansi-blue-fg">,</span> epochs<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">10</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py</span> in <span class="ansi-cyan-fg">_method_wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     64</span>   <span class="ansi-green-fg">def</span> _method_wrapper<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     65</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> self<span class="ansi-blue-fg">.</span>_in_multi_worker_mode<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># pylint: disable=protected-access</span>
<span class="ansi-green-fg">---&gt; 66</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">return</span> method<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     67</span> 
<span class="ansi-green-intense-fg ansi-bold">     68</span>     <span class="ansi-red-fg"># Running inside `run_distribute_coordinator` already.</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)</span>
<span class="ansi-green-intense-fg ansi-bold">    786</span>     <span class="ansi-red-fg"># Legacy graph support is contained in `training_v1.Model`.</span>
<span class="ansi-green-intense-fg ansi-bold">    787</span>     version_utils<span class="ansi-blue-fg">.</span>disallow_legacy_graph<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Model'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'fit'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 788</span><span class="ansi-red-fg">     </span>self<span class="ansi-blue-fg">.</span>_assert_compile_was_called<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    789</span>     self<span class="ansi-blue-fg">.</span>_check_call_args<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'fit'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    790</span> 

<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py</span> in <span class="ansi-cyan-fg">_assert_compile_was_called</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1633</span>     <span class="ansi-red-fg"># (i.e. whether the model is built and its inputs/outputs are set).</span>
<span class="ansi-green-intense-fg ansi-bold">   1634</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> self<span class="ansi-blue-fg">.</span>_is_compiled<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1635</span><span class="ansi-red-fg">       raise RuntimeError('You must compile your model before '
</span><span class="ansi-green-intense-fg ansi-bold">   1636</span>                          <span class="ansi-blue-fg">'training/testing. '</span>
<span class="ansi-green-intense-fg ansi-bold">   1637</span>                          'Use `model.compile(optimizer, loss)`.')

<span class="ansi-red-fg">RuntimeError</span>: You must compile your model before training/testing. Use `model.compile(optimizer, loss)`.</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classification-models">
<a class="anchor" href="#Classification-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Classification models<a class="anchor-link" href="#Classification-models"> </a>
</h2>
<ul>
<li>Classification<ul>
<li>
<code>categorical_crossentropy</code> loss function</li>
<li>Similar to log loss: Lower is better</li>
<li>Add <code>metrics=['accuracy']</code> to compile step for easy-to-understand diagnostics</li>
<li>Output layers has separate node for each possible outcome, and uses <code>softmax</code> activation</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Understanding-your-classification-data">
<a class="anchor" href="#Understanding-your-classification-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Understanding your classification data<a class="anchor-link" href="#Understanding-your-classification-data"> </a>
</h3>
<p>Now you will start modeling with a new dataset for a classification problem. This data includes information about passengers on the Titanic. You will use predictors such as <code>age</code>, <code>fare</code> and where each passenger embarked from to predict who will survive. This data is from <a href="https://www.kaggle.com/c/titanic">a tutorial on data science competitions</a>. Look <a href="https://www.kaggle.com/c/titanic/data">here</a> for descriptions of the features.</p>
<p>It's smart to review the maximum and minimum values of each variable to ensure the data isn't misformatted or corrupted. What was the maximum age of passengers on the Titanic?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/titanic_all_numeric.csv'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>male</th>
      <th>age_was_missing</th>
      <th>embarked_from_cherbourg</th>
      <th>embarked_from_queenstown</th>
      <th>embarked_from_southampton</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>1</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>0</td>
      <td>False</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>0</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>0</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>1</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>male</th>
      <th>embarked_from_cherbourg</th>
      <th>embarked_from_queenstown</th>
      <th>embarked_from_southampton</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
      <td>0.647587</td>
      <td>0.188552</td>
      <td>0.086420</td>
      <td>0.722783</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>13.002015</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
      <td>0.477990</td>
      <td>0.391372</td>
      <td>0.281141</td>
      <td>0.447876</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>22.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>29.699118</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>35.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Last-steps-in-classification-models">
<a class="anchor" href="#Last-steps-in-classification-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Last steps in classification models<a class="anchor-link" href="#Last-steps-in-classification-models"> </a>
</h3>
<p>You'll now create a classification model using the titanic dataset, which has been pre-loaded into a DataFrame called <code>df</code>. You'll take information about the passengers and predict which ones survived.</p>
<p>The predictive variables are stored in a NumPy array <code>predictors</code>. The target to predict is in <code>df.survived</code>, though you'll have to manipulate it for keras. The number of predictive features is stored in <code>n_cols</code>.</p>
<p>Here, you'll use the <code>'sgd'</code> optimizer, which stands for <a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent">Stochastic Gradient Descent</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictors</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">survived</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="n">predictors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>

<span class="c1"># Convert the target to categorical: target</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

<span class="c1"># Set up the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># Add the first layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span><span class="p">,</span> <span class="p">)))</span>

<span class="c1"># Add the second layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>

<span class="c1"># Compile the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'sgd'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'categorical_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>

<span class="c1"># Fit the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/10
28/28 [==============================] - 0s 1ms/step - loss: 2.2037 - accuracy: 0.5657
Epoch 2/10
28/28 [==============================] - 0s 1ms/step - loss: 0.8390 - accuracy: 0.6397
Epoch 3/10
28/28 [==============================] - 0s 1ms/step - loss: 0.6464 - accuracy: 0.6970
Epoch 4/10
28/28 [==============================] - 0s 1ms/step - loss: 0.6442 - accuracy: 0.6700
Epoch 5/10
28/28 [==============================] - 0s 991us/step - loss: 0.6039 - accuracy: 0.6756
Epoch 6/10
28/28 [==============================] - 0s 1ms/step - loss: 0.6400 - accuracy: 0.6734
Epoch 7/10
28/28 [==============================] - 0s 938us/step - loss: 0.6172 - accuracy: 0.6857
Epoch 8/10
28/28 [==============================] - 0s 948us/step - loss: 0.6029 - accuracy: 0.6678
Epoch 9/10
28/28 [==============================] - 0s 1ms/step - loss: 0.5876 - accuracy: 0.6947
Epoch 10/10
28/28 [==============================] - 0s 1ms/step - loss: 0.6019 - accuracy: 0.6857
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-models">
<a class="anchor" href="#Using-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using models<a class="anchor-link" href="#Using-models"> </a>
</h2>
<ul>
<li>Using models<ul>
<li>Save</li>
<li>Load</li>
<li>Make predictions</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Making-predictions">
<a class="anchor" href="#Making-predictions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Making predictions<a class="anchor-link" href="#Making-predictions"> </a>
</h3>
<p>The trained network from your previous coding exercise is now stored as <code>model</code>. New data to make predictions is stored in a NumPy array as <code>pred_data</code>. Use model to make predictions on your new data.</p>
<p>In this exercise, your predictions will be probabilities, which is the most common way for data scientists to communicate their predictions to colleagues.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/titanic_pred.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate predictions: predictions</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pred_data</span><span class="p">)</span>

<span class="c1"># Calculate predicted probability of survival: predicted_prob_true</span>
<span class="n">predicted_prob_true</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Print predicted_prob_true</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predicted_prob_true</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.2356429  0.39493337 0.6467542  0.42498595 0.20185494 0.18059665
 0.05319645 0.31779495 0.19566485 0.62657815 0.2195809  0.3040561
 0.19997828 0.4384156  0.18682653 0.0891349  0.2706037  0.4632163
 0.09688736 0.4081759  0.71763843 0.22008593 0.05668418 0.2793161
 0.43083528 0.1989634  0.5924268  0.50566006 0.20718242 0.639316
 0.45346487 0.449966   0.19112092 0.24450536 0.29686052 0.68916667
 0.27271482 0.19271837 0.58069086 0.4625478  0.27261385 0.38078234
 0.503581   0.15186326 0.31187332 0.11424559 0.3898142  0.16097589
 0.4598129  0.6694054  0.4117966  0.01720754 0.45439368 0.5699323
 0.33318868 0.33452493 0.74020785 0.27610594 0.3996111  0.19112092
 0.16608104 0.33679894 0.3251821  0.42942157 0.33116353 0.19407079
 0.34665847 0.60158664 0.20779149 0.41543555 0.21967332 0.506885
 0.16617134 0.10057687 0.4316318  0.37128657 0.29803413 0.28172562
 0.19116542 0.68557    0.46373078 0.16809006 0.31520534 0.2583089
 0.21838322 0.33369294 0.30046916 0.5663493  0.38062432 0.500692
 0.19068179]
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="goodboychan/chans_jupyter"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/chans_jupyter/python/datacamp/deep_learning/2020/07/21/03-Building-deep-learning-models-with-keras.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/chans_jupyter/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/chans_jupyter/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/chans_jupyter/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/goodboychan" title="goodboychan"><svg class="svg-icon grey"><use xlink:href="/chans_jupyter/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/chanseokk" title="chanseokk"><svg class="svg-icon grey"><use xlink:href="/chans_jupyter/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/chans_jupyter/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
